    R 3     =0; R          =R +        ;   n=10 ;:::;1;       S 3 =R ;
      10 +1           n−1      n    n2                          10      0                                    Линейные разностные уравнения n-го порядка. Теория разност-
следуетиспользовать,чтобысуммарнаявычислительнаяпогрешностьбыла                                          ных уравнений является важным математическим аппаратом численных
меньше?                                                                                                  методов. В частности, разностные уравнения возникают при численном ре-
    Следуетвоспользоватьсявторымспособом(полученныезначениясовпа-                                        шении дифференциальных уравнений.
дают только в 14-и знаках). При вычислении первым способом происходит
потеря точности в результате сложения чисел Sn−1 и 1=n2, существенно                                     Определение 1.1 Пустьнеизвестнаяфункцияy,заданныефункцииa ,f
отличающихся по величине.                                                                                                                                                                    i
                                                                                       являютсяфункциямиодногоцелочисленногоаргументаk.Тогда уравнение
Пример1.4. Можнолинепосредственнымивычислениямипроверить,что
ряд P∞ 1 расходится? Нет.                                                                                      a0(k)y(k)+a1(k)y(k+1)+ ::: +an(k)y(k+n) =f(k) ⇔ Ly =f;
 j=1 j
Задача 1.1. Известно, что ex = 1 + x + x2 + :::. Найти e1, e−15, e−20.
                                  2!                                                   при a0(k);an(k) 6= 0 называется линейным разностным уравнением n-го
Объяснить результат и улучшить алгоритм: e−x = 1=ex.                                                     порядка. Уравнение Ly = 0 называется однородным.
Пример 1.5. Метод Крамера решения систем линейных алгебраических
уравнений с невырожденной матрицей n × n позволяет найти точное ре-                                          Для однозначного построения решения y(k) обычно достаточно задать
шение, вычислив (n+1) определитель матриц размерности n×n. Оценим                                        значения y(k ) в некоторых n точках.
                                                                                                      i
Раздел 1.                                                                           11                   12                              Лекция 1. Погрешность. Разностные уравнения
                   k
Пример 1.6. Найти S(k) = P(i2 + i + 1). Это приводит к уравнению                                             Доказательство.Действительно,разностьпроизвольногорешенияy(k)
                  i=1                                                                  неоднородного уравнения и некоторого частного решения неоднородного
S(k)−S(k−1)=k2+k+1,S(1)=3.                                                                               уравнения y1(k) является решением однородного уравнения и, как следует
Пример 1.7. Найти y(k) из условий                                                                        изтеоремы1,можетбытьпредставленоввидесуммылинейнонезависимых
                                                                                                                                                      n
   a(k)y(k −1)−c(k)y(k)+b(k)y(k+1) = f(k);                0 < k < N;                              частных решений однородной задачи: y(k)−y1(k) = P ciy(i)(k) =: y0(k).
                                                                                                                                                     i=1
   y(0) = y0; y(N) = yN;                                                                              Линейныеуравненияn-гопорядкаспостояннымикоэффициен-
если a(k);b(k);c(k);f(k);      0 < k < N заданы.                                                         тами. Для многих важных приложений класс рассматриваемых линейных
Теорема 1.1 Пусть y(1), :::, y(n)  произвольные линейно независимые                                     уравнений можно сузить.
решения однородного разностного уравнения n-го порядка Ly = 0. Тогда                                     Определение 1.2 Линейное уравнение
общее решение данного уравнения может быть записано в виде
                        n                                                                                a0y(k)+a1y(k+1)+ ··· +any(k+n)=f(k)
              y0(k) = Xciy(i)(k):                                                      где ai (i = 0;1; ::: ;n)  постоянные коэффициенты и a0 6= 0, an 6= 0, на-
                       i=1
    Доказательство. Перепишем исходное уравнение в виде                                                  зывается линейным разностным уравнением n-го порядка с постоянными
                                                                                       коэффициентами.
                       n−1
        y(k +n) = −X ai(k)y(k+i):                                                          Есливэтомуравненииположитьy(k+i) =yk+i иf(k)=fk,тоуравнение
                       i=0 an(k)                                                       примет вид
Отсюдаследует,чтоеслиизвестныy(k ); :::; y(k +n−1),тоискомаяфунк-                                                                a0yk +a1yk+1 + ··· +anyk+n = fk:
                          0           0
ция y(k) однозначно восстанавливается для k ≥ k + n. Аналогично, из                                      Для однозначного определения решения требуется задать n условий, на-
                                           0
равенства                                                                                                пример, yi = bi; i = 0; ::: ;n − 1: Имеется глубокая аналогия между рас-
                      n
           y(k) = −X ai(k)y(k+i)                                                       смотренным разностным уравнением и обыкновенным дифференциальным
                          a0(k)                                                        уравнением с постоянными коэффициентами
                     i=1
следует, что y(k) однозначно восстанавливается для k ≤ k . Таким обра-                                                                      ′                 (n)       ˜
                                                    0                                                       a˜0y(x) + a˜1y (x) + ··· + a˜ny    (x) = f(x)
зом, если два решения совпадают в n последовательных точках, то они
                 (i)    	n
тождественно равны. Пусть           y   (k) i=1  некоторая линейно независи-                            как в постановках задач, так и в методах их решения.
мая система частных решений, и y(k)  произвольное решение однород-                                          Будем искать решение однородного разностного уравнения в виде yk =

ного уравнения. Тогда n-мерные вектора y(i)(k) n                при 0 ≤ k ≤ n − 1                        µk. После подстановки этого выражения в разностное уравнение и сокра-
     n                                    i=1                                                                                                                  n
образуют базис в R . Следовательно, при 0 ≤ k ≤ n −1 мы можем выра-                                      щения на µk получим характеристическое уравнение p(µ) = P ajµj = 0:
        n                                  n
зить y(k) = Xciy(i)(k). А так как y(x) и Xciy(i)(k) являются решениями                                                                                                          j=0
       i=1                                i=1                                                     Утверждение 1.1 Пусть µ ; ::: ;µ  различные корни характеристи-
                                            n                                                                            1         r
                                          X (i)                                        ческого уравнения, а σ ; ::: ;σ  их кратности. Тогда общее решение од-
Ly =0, совпадающими при 0 ≤ k ≤ n−1, то y(k) ≡                  ciy   (k) для всех k.                                               1        r
                                           i=1                                         нородного разностного уравнения представляется в виде
         0                                                                                                        k          k               σ −1 k
Теорема 1.2 Пусть y (k)  общее решение линейного однородного урав-                                                      yk = c11µ +c12kµ + ··· +c1σ k 1            µ + ··· +
нения Ly = 0, а y1(k)  частное решение неоднородного уравнения Ly = f.                                                             1          1             1        1
                                                                                                                    k          k                σ −1 k
Тогда общее решение уравнения Ly = f можно представить в виде суммы                                                            +cr1µ +cr2kµ + ··· +crσ k r            µ ;
                                                                                                                    r          r             r        r
              y(k) = y0(k)+y1(k):                                                      где c   произвольные постоянные.
                                                                                             ij
          Раздел 1.                                                                  13                 14                    Лекция 2. Частные решения и собственные функции
  Такимобразом,каждомукорнюµкратностиσсоответствуетнаборчаст-                                где s = 0, если αe±iβ не являются корнями характеристического уравне-
          ных решений вида                                                                              ния, и s равно кратности корня в противном случае; n = max(m1;m2)
          k    k       σ−1 k                                                                               ˜
         µ ;kµ ; ::: ;k    µ :                                             степень многочленов Qn(k) и Qn(k).
          Пример 1.8. Найти общее решение уравнения                                                                                                              ˜
                                                                              Чтобы найти коэффициенты многочленов Qn(k) и Qn(k), надо подста-
       by    −cy +ay        =0:                                            витьвыражение(1)внеоднородноеуравнениеиприравнятькоэффициенты
         k+1     k      k−1                                                при подобных членах.
          Найдем корни характеристического уравнения bµ2 −cµ+a = 0 :                                    Пример 2.1. Найти вид частного решения уравнения
               √                                                                                                        π
    µ1;2 = c±    D; D=c2−4ab                                                                            yk+2 +yk = cos 2k:
              2b
          и рассмотрим три случая для дискриминанта (в последующих формулах                             Найдем корни характеристического уравнения µ = ±i. Так как (α;β) =
          C ;C произвольные постоянные).                                                               (1;π=2) является корнем кратности 1, следовательно, s = 1, и решение
 1  2                                             k       k                                                   1           π          π
  а) D > 0;   µ 6= µ  вещественные: y = C µ +C µ ;                                          ищется в виде: yk = k c1cos 2k +c2sin 2k :
        1     2                    k    1 1     2 2
  б) D < 0;   µ1;2 = ρe±iϕ  комплексно сопряженные. Здесь                                      Фундаментальное решение. Рассмотрим метод построения частного
        p                                                                 решения с произвольной правой частью.
          |D|
 arctg              c=b > 0;
      r           

          c p                                                             Определение 2.1 Фундаментальным решением G называется решение
  ρ =    a;   ϕ=                 |D|                                                                                                               k
   π−arctg           c=b < 0;                                              разностного уравнения
  b        
              c

 π
 2                  c = 0:                                                                     a0yk +a1yk+1 + ··· +anyk+n = fk
          Тогдаµk =ρk(coskϕ±isinkϕ):Следовательно,y = ρk(C coskϕ+C sinkϕ):                                                                   0; k 6= n
1;2                                        k        1          2                      с правой частью f = δ0, где δn =
          Это форма записи действительного решения, для комплексного можно ис-                                             k    k       k      1;  k = n:
          пользовать предыдущий вид, т.е. y = C µk +C µk.
                 k     1 1    2 2
  в) D = 0;   µ =µ =µкратные:y =C µk+C kµk:                                                 Пример 2.2. Построим ограниченное фундаментальное решение уравне-
        1     2                  k     1       2
                                                                           ния первого порядка
                                                                                                        ay +by       =δ0:
Лекция2.Частноерешениенеоднородногоурав-                                                                                     k     k+1     k
                                                                           Для этого найдем общее решение по известной схеме: yk = y0 + y1, y0 =
                                                                                                                                            k    k   k
    нения.Фундаментальноерешение.Задачина                                                    C−ak. Для определения y1 имеем три группы уравнений:
                                                                                 b                       k
    собственные значения
                                                                                    
                                                                                                                                         a k
                                                                                                                              1
                                                                                     ay +by        =0 при k≤−1; т.е.y =c              −     ;
                                                                                     k         k+1                            k    −
          Как и в случае дифференциальных уравнений, частное решение разност-                                     ay0+by1 =1          при k=0;                     b
                                                                                                                                           k
                                                                                                                                        a
          ного уравнения для правой части специального вида может быть найдено                                                                             1
          методом неопределенных коэффициентов.                                                                   ayk+byk+1 =0 при k≥1;               т.е.yk = c+ −b     :
          Утверждение 2.1 Пусть                                                                         Дляk≤−1возьмемc−=0.Тогдавсеуравненияпервойгруппывыполнены
                                                                           и y0 = 0. Из второго уравнения следует, что y1 = 1=b. Отсюда и из третьей
      k                 ˜
          f =α P (k)cosβk+P (k) sinβk ;                                               группы уравнений имеем c       = −1=a. Таким образом, получаем частное
k         m1              m2                                                                            +
    ˜                                                                                 решение неоднородного уравнения
          где P   (k), P  (k)  многочлены степениm и m соответственно.Тогда
    m1      m2                               1    2
          частное решение может быть найдено в виде                                                                              1   ( 0;           k ≤ 0;
                                                                                                   y =       1    a k
1    s  k                 ˜                                                                       k      − − ; k≥1:
          yk = k α    Qn(k) cosβk+Qn(k) sinβk ;                    (1)                                                  a    b
 Раздел 1.                                                                                15                     16                        Лекция 2. Частные решения и собственные функции
                                                                                                                      ∞                                ∞
 Послеприбавлениякнемуобщегорешенияоднородногоуравнениянаходим                                                                         X n               n            X n
                                                                                                                 =          aG +bG            fn =         δ fn =fk:
 выражение для общего решения:                                                                                                                    k       k+1                  k
                                                                                                                   n=−∞                             n=−∞
              
                        a k
              
               C −b ;                   k ≤ 0;                                                Случай|a=b| < 1рассматриваетсяаналогичнымобразом.Теоремадоказана.
        yk =           1 ak                                                                   Отметим, что изложенная техника применима для построения фунда-
               C−a −b ; k≥1:                                                                  ментального решения для уравнения n-го порядка.
                                                         0                                         Задачи на собственные значения. В некоторых важных для при-
 Обозначим построенное фундаментальное решение через G . Его ограни-
                                                         k                                     ложений случаях задачу нахождения собственных векторов и собственных
 ченность выражается в виде зависимости постоянной C от величины |a=b|:                                          чисел заданной матрицы удается решить методами разностных уравнений.
              C =0;        при |a=b| < 1;                                                      Пример 2.3. Найдем все λ, для которых разностная задача
              ∀ C;         при |a=b| = 1;
              C =1=a; при|a=b|>1:                                                                                yk+1 −yk−1 = −λyk;          y0 = yN = 0; h = 1=N
                                       n                                                                              2h
 Теорема 2.1 Пусть |a=b| 6= 1, |fk| ≤ F, а G  ограниченное фундамен-
                                       k
 тальное решение уравнения ayk +byk+1 = δn: Тогда ряд                                                            имеет нетривиальные решения.
                                      k
                           ∞                                                                       Перепишем разностное уравнение следующим образом
                    1     X n
                   y =          G fn
                    k             k                                                                                          y     +2hλy −y            =0;
                         n=−∞                                                                                                  k+1          k     k−1
 абсолютно сходится и является частным решением уравнения                                                        и найдем характеристическое уравнение mu2 + 2hλµ − 1 = 0: Его корни:
                                                                                                                √       2 2                                            k          k
                                                                                               µ    = −hλ± 1+h λ . Если µ = µ = µ, то y = C µ +kC µ . И из
                  ayk +byk+1 = fk:                                                              1;2                                    1      2             k       1          2
                                                                                               краевых условий следует, что C = C = 0. Если µ 6= µ , то общее решение
     Доказательство. Рассмотрим случай |a=b| > 1. Из предыдущего при-                                                                                  1      2               1     2
                                                                                               разностного уравнения имеет вид
 мера следует, что C = 1, т.е.
           a                                                                                                                     y =C µk+C µk;
                                                                                                                                   k      1 1      2 2
               (
                   1 −a k−n; k−n≤0;
          n                                                                                    а константы C и C определяются из системы
        G =        a     b                                                                                      1      2
          k
                   0;               k−n≥1:                                                                              C +C =0; C µN+C µN =0:
 Следовательно,                                                                                                                             1      2          1 1       2 2
               1      X 1 ak−n
             yk =             (− )       fn;                                                   Отсюда получаем, что C = −C и C (µN −µN) = 0, т.е. нетривиальное
                             a    b                                                                                           2        1      1   1      2
                   (k−n)≤0                                                                     решение разностной задачи существует тогда и только тогда, когда µN =
 и имеет место следующая оценка                                                                                                                                                                         1
                                                                                               µN. Следовательно,
                                                                                                2
            X  n−k
1    F            b         F       1             F
         |yk ≤                     =                   =           ;                                                         µ1             2πn
      |a| (n−k)≥0a          |a| 1 − |b|=|a|     |a| − |b|                                                          µ2 = exp i N          ;   n=0;::: ;N −1:
           1
 т.е. ряд для функции yk является абсолютно сходящимся. Кроме того, ряд                                                                       2            2πn
 является частным решением исходного уравнения:                                                                  Так как µ1µ2 = −1, то µ1 = −exp i N                , т.е.
                       ∞                 ∞
                      X n               X n                                                                                       πn                       πn
ayk +byk+1 = a             G fn+b             G fn=
                             k                  k+1                                                                  µ =iexp i           ;   µ =iexp −i             :
                    n=−∞               n=−∞                                                                           1             N          2               N
         Раздел 1.                                                           17               18                                    Лекция 3. Многочлены Чебышёва
         Нетривиальные решения исходной задачи соответствуют n = 1; ::: ;N −1                 Отсюда получаем, что C = −C и C (µN −µN) = 0, т.е. нетривиальное
                                                                                         2      1    1  1     2
         и имеют вид                                                                          решение разностной задачи существует тогда и только тогда, когда µN =
                                                                                                                                   1
                                                                 µN. Следовательно,
      (n)      k    k     k      πkn        πkn                             2
     y   =C µ −µ =C i exp i                −exp −i          =
      k      1  1    2     1          N              N                                              µ1         2πn
          =Cik2isinπkn =Cik+1sinπkn:                                                         µ2 = exp i N     ;  n=0;::: ;N −1:
   1        N              N
                                                                                      2       2πn
         Поскольку                                                                            Так как µ1µ2 = 1, то µ1 = exp i N   , откуда
          πn          πn         πn                                                              πn
      µ1 +µ2 = −2hλ=i exp iN +exp −iN             =2icos N ;                                                 µ1;2 = exp ±i N   :
         имеем                                                                                Нетривиальные решения исходной задачи соответствуют n = 1; :::; N −1
          (n)    i    πn                                                    и имеют вид
         λ   =−hcos N ; n=1;::: ;N −1:
         Отметим, что количество различных ненулевых собственных значений рав-                         (n)      k    k          πkn         πkn
                                                                         y   =C µ −µ =C exp i                −exp −i          =
         но N −1.                                                                                      k      1  1    2     1        N              N
                                                                                       =C2isinπkn =C sinπkn:
         Задача 2.1. Провести аналогию с дифференциальной задачей                                                       1      N           N
          y′ = −λy:                                              Поскольку
                                                                              h2                  πn          πn         πn
         Пример 2.4. Найти все λ, для которых разностная задача                                   2p = 2 1− 2 λ = µ1 +µ2 = exp iN       +exp −iN       =2cos N ;
  yk+1 −2yk +yk−1 =−λyk;     y0 = yN = 0; h = 1=N                           имеем
          2
         h                                                                           (n)   2        πn     4   2 πn
         имеет нетривиальные решения. Найдем характеристическоеуравнение раз-                         λ   = h2 1−cos N      = h2 sin 2N;   n=1;2; ::: ;N −1:
         ностной задачи:
                                                                 Отметим, что количество различных ненулевых собственных значений рав-
                             2                                   но N −1.
         2                            h
        µ −2pµ+1=0; где p= 1− 2 λ :                                         Задача 2.2. Провести аналогию с дифференциальной задачей:
p2                                   k      k                                           y′′ = −λy; y(0) = y(1) = 0;
         Его корни: µ   =p± p −1.Еслиµ =µ =µ,тоy =C µ +kC µ ,аиз
   1;2                    1    2        k    1       2
         краевых условий следует, что C = C = 0. Если µ 6= µ , то общее решение
          1    2           1    2                                                                             2
                                                                                y  (x) = Csin(πnx); λ   =(πn) ; n = 1; ::: :
         разностного уравнения имеет вид                                                                      (n)                 (n)
       y =C µk+C µk;
        k    1 1    2 2                                            Лекция 3. Многочлены Чебышёва
         а константы C и C определяются из системы
     1   2
       C +C =0;                                                  Найдем общее решение однородного разностного уравнения с параметром:
        1    2
       C µN +C µN =0:                                                              yn+1(x) = 2xyn(x)−yn−1(x);   x∈R:
        1 1     2 2
         Раздел 1.                                                             19               20                                     Лекция 3. Многочлены Чебышёва
         Имеем:                                                                                    Доказательство.Либоизначальныхусловий,либоподставивx=cosϕ
          2                         p 2                                                                                  ˆ          ˆ
                                                                   в иррациональное представление, получаем C (x) = 1, C (x) = 0. Это при-
         µ −2xµ+1=0; µ1;2 =x± x −1:                                                                                       1          2
                                                                   водит к указанной формуле.
         Следовательно, при x 6= ±1 верна формула                                                  Отметим, что тригонометрическую форму можно взять за определение
                                                                   многочлена Чебышёва первого рода. Действительно, при любом η имеем
         p 2     n             p 2     n
  y (x) = C (x)(x +   x −1) +C (x)(x− x −1) :
   n       1                     2
                                                                                 cos (n+1)η +cos (n−1)η =2cosηcos(nη):
         Случай x = ±1 далее рассматривается отдельно.                                          Полагая η = arccosx, получаем, что тригонометрическая формула удовле-
 Если|x| < 1, то удобно перейти к действительнойформезаписирешения                   творяет рекуррентному соотношению и указанным начальным условиям.
         yn(x), представив µ1;2 в тригонометрическом виде. Пусть x = cosϕ, тогда:               Отсюда следует, что при |x| ≤ 1 рекуррентное соотношение и тригономет-
ˆ                     ˆ                                            рическая формула задают один и тот же многочлен.
   y (x) = C (x)cos(narccosx)+C (x)sin(narccosx):
    n       1                     2                                              Можно показать, что тригонометрическая форма верна для произволь-
                                                                   ного комплексного x. Для этого достаточно воспользоватьсяформулой Му-
         Значения соответствующих констант определяются начальными условия-                                    1               n                n             √      2
         ми, например, для y0(x);y1(x).                                                         авра cos(nθ) = 2((cosθ + isinθ) + (cosθ − isinθ) ); где sinθ =  1−x , и
                                                                   выбрать для всех функций подходящие ветви. Отсюда также можно обос-
 Многочлены Чебышёва первого рода Tn(x).                                             новать иррациональное представление для комплексных x.
         Определение 3.1 МногочленамиЧебышёвапервого рода T (x) называет-                          Многочлены Чебышёва второго рода Un(x).
                                      n                            Определение 3.2 Многочленами Чебышёва второго рода U (x) называ-
         ся последовательностьмногочленов,удовлетворяющихрекуррентномусо-                                                                                   n
         отношению                                                                              ется последовательность многочленов, удовлетворяющих рекуррентному
                                                                   соотношению
 Tn+1(x) = 2xTn(x)−Tn−1(x);     T0(x) = 1; T1(x) = x:                                  Un+1(x) = 2xUn(x)−Un−1(x);      U0(x) = 1; U1(x) = 2x:
         Теорема 3.1 Для многочленов Tn(x) имеет место иррациональное пред-                     Теорема 3.3 Для многочленов Un(x) имеет место иррациональное пред-
         ставление                    √                √                                        ставление

            2    n           2    n
     x+ x −1 + x− x −1                                                                       √                √
       Tn(x) =                                 :                                                            2    n+1           2    n+1
                   2                                                             Un(x) = x+ x −1 √− x− x −1                  :
                                                                                                           2
         Доказательство. Пусть x 6= ±1. Тогда из начальных условий получаем                                                         2 x −1
       1                                                                         Доказательство. Выписав решение разностного уравнения с учетом
         C (x) = C (x) =   , что приводит к указанной формуле. Для x = ±1 имеем
1       2     2                                                                      начальных условий, находим указанную формулу для x 6= ±1. Из непре-
       n          n
         µ   =x, т.е. T (x) = C (x)x +C (x)nx . Из начальных условий получаем                   рывности и тождественного совпадения рекуррентной последовательности
          1;2          n       1         2
                    n
         C (x) = 1, C (x) = 0, т.е T (x)|  =(±1) . Это совпадает со значениями,                 ииррациональногопредставленияполучаем,что формулатакжевернадля
1          2            n    ±1
         получаемымиприформальнойподстановкеx=±1виррациональноепред-                            x=±1.
         ставление, поэтому, найденная формула верна при всех x. Корректность                   Теорема 3.4 Для многочленов U (x) имеет место тригонометрическая
         указанного выражения для x = ±1 также следует из непрерывности рекур-                                                   n
         рентного соотношения и иррационального представления для всех x ∈ R и                  форма
         их тождественного равенства для x 6= ±1.                                                                  U (x) = sin((n+1)arccosx); |x| ≤ 1:
                                                                                       n          sin(arccosx)
         Теорема 3.2 Для многочленов Tn(x) имеет место тригонометрическая                          Доказательство.Либоизначальныхусловий,либоподставивx=cosϕ
         форма                                                                                  в иррациональное представление, получаем указанный вид.
 Tn(x) = cos(narccosx); |x| ≤ 1:                                      Свойства многочленов Чебышёва первого рода Tn(x).
Раздел 1.                                                                          21                  22                                             Лекция 3. Многочлены Чебышёва
Теорема 3.5 Все многочлены T2n(x)  четные, T2n+1(x)  нечетные; ко-                                   Теорема 3.10 (Лебедев В.И.) Дляпроизвольныхположительныхцелых
                    n         n−1

эффициент при старшем члене x равен 2               . Для |x| ≤ 1 имеем Tn(x) ≤                        m;n верны тождества
1.
                                                                                                      T3n(x) = T3(Tn(x)) = Tn(x)(2T2(Tn(x)) −1) =
                                                                                                                                     √              √
    Доказательство первого утверждения можно получить методом ин-                                                                 =4T (x)(T (x)−         3)(T (x)+      3);
дукции из рекуррентной формы записи a). Второе утверждение следует из                                                                   n      n        2     n        2
тригонометрической формы записи b).                                                                                     Umn−1(x) = Um−1(Tn(x))Un−1(x):
Теорема 3.6                                                                                                Доказательство может быть получено из вида многочленов Tn(x) и
                                                                                     Un(x).
    1                     
   Z Tn(x)Tm(x)            0       при n 6= m;                                          Из теоремы Лебедева в том числе следует, что треть корней T3n(x) яв-
      I    =       √           dx =     π=2 приn=m6=0;                                          ляются корнями T (x), а корни U             (x) состоят из корней U        (T (x)) и
       mn                  2                                                                                         n                mn−1                             m−1 n
  −1      1−x              π       при n = m = 0:                                   Un−1(x).                                                  n
    Доказательство. Положим x=cosϕ, тогда dx =−sinϕdϕ и                                                Теорема 3.11 Среди всех многочленов P (x) = x + ::: со старшим ко-
                                                                                                                                     n
      π                                                                              эффициентом 1 приведенный многочлен Чебышёва Tn(x) = 21−nTn(x) наи-
         I   =Z cos(nϕ)cos(mϕ)dϕ = π(δ0             +δ0     ):                                  менее уклоняется от нуля на отрезке [−1;1] , т.е.
          mn                                   n−m      n+m
                                2                                                                                                          1−n

                                                                                                            max P (x) ≥ max T (x) =2               :
     0                                                                                                              n                n
                                                                                                            [−1;1]           [−1;1]
Таким образом, система многочленов Чебышёва ортогональна, а система
     √              √                                                                               Доказательство.ПустьkP (x)k                  <21−n.ТогдамногочленQ             (x) =
  1           2             2                                                                                                              n     C[−1;1]                              n−1
{√ T0(x); √ T1(x);:::; √ Tn(x);:::} ортонормальна на отрезке [−1;1] с ве-
   π         π              π                                                                          T (x)−P (x) имеет степень n−1 и отличен от нулевого. Однако при этом
          1                                                                                       n        n
сом p(x) = √          .                                                                                в точках x        экстремума многочлена Чебышёва знак разности Qn−1(x)
   2                                                                                              (m)
        1−x                                                                                     определяется знаком Tn(x):
Теорема 3.7 Все нули многочленов Чебышёва T (x) имеют вид: x                       =
                                        n                     m                                                                                   m
                                                                                                            sign T (x      ) −P (x      ) =(−1) :
    π(2m−1)                                                                                                                           n  (m)      n   (m)
cos     2n      , где m = 1;:::;n (все нули лежат внутри отрезка [−1;1],                               Следовательно, Q         (x) является отличным от нуля многочленом степени
их ровно n).                                                                                                                n−1
                                                                                     n−1,ноимеетnнулей,посколькуn+1разменяетзнаквточкахэкстремума.
    Доказательство. Искомые нули являются корнями уравнения                                            Полученное противоречие завершает доказательство.
             cos(narccosx ) = 0.                                                         Таким образом, приведенный многочлен Чебышёва является решением
                            m
                                                                                     следующей минимаксной задачи:
Теорема 3.8 ВсеэкстремумымногочленаЧебышёваTn(x)наотрезке[−1;1]
         πm                                                                                             arg{       inf       max |P (x)| } = T (x):
имеют вид: x        =cos      , m = 0;:::;n (на [−1;1] имеется n+1 экстре-                                                              n               n           n
         (m)                                                                                                             P (x)=x +::: x∈[−1;1]
          n                                                                                                    n
        m
мум и Tn(x       ) = (−1) ).
      (m)                                                                                       Такжеможнодоказатьединственностьтакогорешения, т.е. для произволь-
                                                                                     ного P (x) из указанного класса, отличного от T (x), выполняется оценка:
    Доказательство. Искомые экстремумы являются корнями уравнения                                              n                                               n
                                                                                     kT (x)k          <kP k          .
cos(narccosx      ) = ±1.                                                                                 n     C[−1;1]      n C[−1;1]
       (m)
                                                                                                                                              n
                                                                                     Теорема 3.12 Среди всех многочленов P (x) = x +::: со старшим коэф-
Теорема 3.9 Для произвольных положительных целых m;n верны тож-                                                                                        n
дества                                                                                                 фициентом 1 приведенный многочлен Чебышёва
               1

          Tm(x)Tn(x) = (Tm+n(x)+Tm−n(x)); m≥n;                                                                                   b −a n             2x−(b+a)
               2                                                                                       T[a;b](x) =             21−nT
          T (T (x)) = T      (x):                                                                                   n              2             n      b −a
m n            mn
          Раздел 1.                                                                    23                  24                                         Лекция 3. Многочлены Чебышёва
          наименее уклоняется от нуля на отрезке [a;b] , т.е.                                              при x = −b+a: Так как
                  [a;b]            n 1−2n                                              b −a
                                                                                                      s
        max P (x) ≥ max |T         (x)| = (b − a) 2    :
    n               n                                                                                                                  √

        [a;b]          x∈[a;b]                                                                             b+a         b +a 2           b+a     2 ba
   Доказательство. Сделаем линейную замену переменных                                                          −b−a±          b −a    −1=−b−a±b−a =
     a+b     b −a ′                                                                                                    √ √                              √ √
          x =         +       x для отображения отрезка [−1;1] в заданный отрезок                                                           2
      2        2                                                                                                    (  b ∓   a)            ±1           b −   a
                                                                                           =− √       √ √ √ =−q ; q =√ √ ;
                                                2x−(b+a)                                       (  b −   a)( b+ a)          1      1     b +   a
          [a;b]. МногочленTn(x)приэтомпреобразуетсявмногочленTn                  b −a
            n−1           n                            [a;b]                  то                                                n
          состаршимкоэффициентом2            (2=(b−a)) иэкстремумамивточкахx             =                                                       2         2q
                                                       (m)                                       ˜[a;b]                         1        n
                                                                                                kT    kC[a;b] =           =         ≤2q :
          a+b b−a                                                                                                              n             qn +q−n     1+q2n        1
     +       x   . После перенормировки по старшему коэффициенту и ис-                                                             1    1          1
 2       2    (m)
          пользования предыдущей схемы доказательства имеем, что многочлен                                 Теорема доказана.
                                                                            Теорема 3.14 Среди всех многочленов P (x), удовлетворяющих условию
 [a;b]           n 1−2n      2x−(b+a)                                                                                     n
          Tn (x)=(b−a) 2           Tn      b −a                                                                                                         2x−(a+b)

                                                                              max P (x) =M,приведенный многочлен Чебышёва MT
                                                                                      n                                                     n      b −a
          является наименее уклоняющимся от нуля на отрезке [a;b] многочленом                              x∈[a;b]
                                       [a;b]                                  принимает наибольшее по модулю значение для всех ξ ∈= (a;b), т.е.
          со старшим коэффициентом 1. Искомая оценка для kTn            kC[a;b] следует из
                                                                                                             2ξ −(a+b)
    2x−(b+a)
                                                                                                P (ξ) ≤ M T                      ; ξ ∈= (a;b):
          равенства max |Tn                    | = 1:                                                                         n            n      b −a
   x∈[a;b]         b −a
                                                                              Доказательство.Предположимпротивное,т.е.пустьсуществуеттакоеξ ∈=
          Теорема 3.13 Среди всех многочленов P (x) равных 1 при x = 0, x ∈=
                          n                     0        0
                                                                                                        2ξ −(a+b)
          [a;b], приведенный многочлен Чебышёва
                                                                              (a;b), что P (ξ) > M T                      : Тогда у ненулевого полинома
                                                                                           n            n      b −a
                    Tn2x−b−a
          [a;b]            b−a                                                                           P (ξ)           2x−(a+b)
         ˜                                                                                                 n
         T    (x) =
          n                b+a                                                             Q (x) =               T                   −P (x)
                      Tn(−     )                                                             n            2ξ−(a+b)   n      b −a           n
                           b−a                                                                       Tn     b−a
          наименее уклоняется от нуля на отрезке [a;b]. При этом
                                                                                                                                         [a;b]
                                   √ √                                        как минимум (n+1) перемена знака на [a;b] в точках x          , т.е. n нулей на
                    2                b −  a                                                                                              (m)
     ˜[a;b]                        √                                          (a;b) и ноль в точке ξ. Противоречие.
         max |T     (x)| =           ;  q =        √ :
      n           −n    n     1
         x∈[a;b]            q   +q              b +  a
                  1     1                                                     Теорема 3.15 (Марков А.А.) (Обобщенная теорема). Среди всех мно-
   Доказательство. Оптимальность приведенного многочлена Чебышё-

                                                                              гочленов P (x), удовлетворяющих условию max P (x) = M, приведен-
                                                                                         n                                            n
          ва может быть доказана по рассмотренной ранее схеме от противного, т.к.                                                                         x∈[a;b]
   ˜[a;b]                                                                                                                  2x−(a+b)
          разность Tn    (x) − P (x) отлична от тождественного нуля, является мно-
    n                                                                         ный многочлен Чебышёва M Tn                        принимает наибольшее по
          гочленом степени не выше n, имеет n нулей на отрезке [a;b] и ноль в точке                                                               b −a
          x =0∈= [a;b].                                                                                    модулю значение производной для всех ξ ∈= (a;b), т.е.
0
                          1
      ˜[a;b]
   Найдем величину kTn       kC[a;b] =       b+a . Для этого вычислим зна-                                          ′              ′  2x−(a+b)
                    |T (−     )|
                      n    b−a                                                                   P (x)      ≤M T                          :
          чение                                                                                                                 n    x=ξ        n       b −a       x=ξ
              √ 2      n        √ 2      n
          Tn(x) = (x+ x −1) +(x− x −1)                                                   Равенство достигается только для указанного полинома.
                         2
  Раздел 1.                                                                                            25
  Доказательство.Предположимпротивное,т.е.пустьсуществуеттакоеξ ∈=                                                                     2. Дифференциальные уравнения
′                   ′ 2x−(a+b)

  (a;b), что P (x)             >M T                             : Тогда у ненулевого полинома
 n      x=ξ            n      b−a        x=ξ
                                                                                                                Лекция 4. Теория разностных схем
                   ′

                  P (x)
          Q (x) =             n      x=ξ        T     2x−(a+b) −P (x)
 n             ′ 2x−(a+b)            n                           n
                                              b −a
            (Tn(      b−a    ) x=ξ                                                                            Пусть в области D с границей Γ задана дифференциальная задача с гра-
                                                                                                              ничным условием
                                                             [a;b]
  как минимум (n+1) перемена знака на [a;b] в точках x                              , т.е. n нулей на                                                                   Lu=f в D;                                                   (1)
                                                             (m)
  (a;b). Но тогда у полинома Q′ (x) как минимум n−1 нуль на (a;b) и нуль в
                        n                                                                                                                             l u = ϕ     на      Γ:                                      (2)
  точке ξ. Отсюда следует, что Q′ (x) ≡ 0, т.е. Qn(x) ≡ const и имеет n нулей,
                           n                                                                                  Здесь L и l  дифференциальные операторы; f и ϕ  заданные элементы,
  т.е. Qn(x) ≡ 0. Противоречие. (Единственность экстремального полинома                                                         а u  искомый элемент некоторых линейных нормированных пространств
  без доказательства).
                                                                                                              F; Φ и U соответственно.
                                                                                                                  Конечно-разностный метод.
                                                                                                              Для применения разностного метода задают некоторую сетку  конечное
                                                                                                              множествоточек(узлов)Dh =DhSΓh,принадлежащееобластиD =DSΓ
                                                                                                              (как правило, Γ ⊂ Γ), определяют сеточные пространства F ; Φ и U и
                                                                                                                                    h                                                               h    h       h
                                                                                                              задаютоператорыпроектирования(·) элементов исходныхпространствна
                                                                                                                                                                  h
                                                                                                              элементы сеточных пространств (часто пространства F ; Φ и U опреде-
                                                                                                                                                                                           h     h      h
                                                                                                              ляют как пространства следов функций из F; Φ и U на Dh; Γh и Dh со-
                                                                                                              ответственно, в этом случае каждая непрерывная функция v совпадает с
                                                                                                              функцией (v) в узлах сетки). При этом в пространствах задаются согла-
                                                                                                                                h
                                                                                                              сованные нормы.
                                                                                                              Определение 4.1 Нормыk·k;k·kh называются согласованными, если для
                                                                                                              произвольной достаточно гладкой функции v выполняется соотношение
                                                                                                                                                 lim        k(v) k =kvk:
                                                                                                                                                      h→0         h h
                                                                                                              Еслинормынеявляютсясогласованными,тоизусловияlim                                        k(u) k = 0
                                                                                                                                                                                                h→0        h h
                                                                                                              не следует kuk = 0, т.е. что u ≡ 0 в исходном пространстве U. Однако, это
                                                                                                              требование необходимо для обоснования сходимости сеточной функций uh
                                                                                                              к непрерывной u. Отметим, что пространства U и F могут различаться,
                                                                                                                                                                                 h      h
                                                                                                              т.е. различаться узлы, где ищется решение и задана правая часть.
                                                                                                                  Все производные, входящие в уравнение и краевые условия, заменяются
                                                                                                              разностными аппроксимациями. В результате дифференциальные опера-
                                                                                                              торы L и l заменяются разностными Lh и lh.
                                                                                                                  Длянахожденияприближенногорешениязадачи(1),(2)определимраз-
                                                                                                              ностную схему  семейство разностных задач, зависящих от параметра h:
                                                                                                                                                    Lhuh =fh в Dh;                                                (3)
                                                                                                                                                    l u =ϕ          на Γ :                                        (4)
                                                                                                                                                     h h        h           h
                                                                                                                                                                26
Раздел 2.                                                                           27                   28                                             Лекция 4. Теория разностных схем
Решение uh, называемое разностным, принимается в качестве приближен-                                     Определение 4.4 Оператор Lh из (3) локально аппроксимирует в точ-
ного решения дифференциальной задачи.                                                                    ке x дифференциальный оператор L из (1), если для достаточно гладкой
                                                                                            i
Пример 4.1.                                                                                              функции u ∈ U существуют такие положительные постоянные h0, c и p,
 u′(x) = f(x);u(0) = u0;u(x);f(x) ∈ Cm[0;1];kvk = max |v(x)|;                                     не зависящие от h, что при всех h ≤ h0 справедливо неравенство
                                                x∈[0;1]                                                                                          p
                                                                                                                (L (u)     −(Lu) )          ≤ ch :
                                                                                                                    h    U          F
 h=1=N;x =ih;(u)           =u(ih);(f)      =f(ih+h=2);                                                                               h          h x=xi
  i          U               F
 u     −u                h               h
   i+1     i = f ; f = f((i +1=2)h);i = 0;:::;N −1; u = u0;                                       Число p при этом называется порядком аппроксимации. Аналогично опре-
      h         i   i                                        0                                    деляется порядок локальной аппроксимации оператора l .
 u =[u ;:::;u ] ∈ RN+1; f =[f ;:::;f                ] ∈ RN;                                                                                                         h
  h      0       N               h     0       N−1                                                    Также используется понятие аппроксимации на решении, позволяющее
 kuhkh = max |ui|; kfhkh =         max |fi|:
0≤i≤N                 0≤i≤N−1                                                          строить схемы более высокого порядка точности на фиксированном шаб-
                                 PN        2 1=2                                       лоне.
Отметим, что евклидова норма kv k              = (       |v | )    и норма kv k =
                       h ∗∗        i=0   i                    h ∗
hkv k не согласованны с нормой исходной задачи kvk , т.к. при h → 0
    h h                                                                                                  Определение 4.5 Говорят, что разностная схема (3), (4) аппроксими-
имеем k(v) k → 0, k(v) k           →∞дляпроизвольной ненулевой функции
v ∈ C[0;1].h ∗               h ∗∗                                                                        рует на решении u с порядком аппроксимации p = min(p1;p2) дифференци-
                                                                                       альную задачу (1), (2), если существуют такие постоянные h0, c1, p1, c2
    Сходимость.                                                                                          и p2, что для всех h ≤ h0 выполняются неравенства
Определение 4.2 Решение uh разностной схемы (3), (4) сходится к ре-                                                                              p                               p
                                                                                                    kL (u)     −f k     ≤c h 1;      kl (u)    −ϕ k ≤c h 2;
                                                                                                       h    U      h        1          h   U       h        2
                                                                                                             h       F                       h       Φ
шению u дифференциальной задачи (1), (2), если существуют такие по-                                                                     h                                h
стоянные h0, c и p, что для всех h ≤ h0 выполнено неравенство                                            причем c1, p1, c2 и p2 не зависят от h и выполнены условия нормировки
             k(u)    −u k      ≤chp;
                  U      h                                                                           lim kf −(f)       k    =0; lim kϕ −(ϕ) k               =0:
                   h       U                                                                                 h      F    F                  h       ϕ    Φ
                             h                                                                       h→0              h   h         h→0               h   h
причем c и p не зависят от h. Число p называют порядком сходимости                                       Лемма 4.1 Из аппроксимации задач следует аппроксимация на решении
разностной схемы; при этом говорят, что разностное решение uh имеет                                      с порядком не ниже p.
порядок точности p.
                                                                                           Доказательство.Действительно,таккакнарешенииuимеем(Lu)                           =
                                                                                                                                                                         F
Наибольший интерес представляет именно сходимость как условие близо-                                                                                                                        h
                                                                                       (f)   , (lu)    =(ϕ) , то
                                                                                           F       Φ         Φ
сти полученного численно и точного решений. Проверку сходимостиудобно                                         h        h        h
                                                                                                                                                                              p
свести к проверке аппроксимации и устойчивости.                                                            kL (u)     ±(Lu)     −f k      ≤kL (u)       −(Lu) k +k(f) −f k ≤c h 1;
                                                                                            h   U          F      h F         h   U          F F           F      h F       1
                                                                                                  h          h        h             h         h   h          h        h
                                                                                                                                                                            p
                                                                                         kl (u)    ±(lu)     −ϕ k ≤kl (u) −(lu) k +k(ϕ) −ϕ k ≤c h 2:
                                                                                           h   U         Φ       h Φ       h    U         Φ              Φ      h         2
    Аппроксимация.                                                                                                 h         h         h           h          h Φh          h        Φh
Определение 4.3 Разностная задача (3), (4) аппроксимирует с поряд-                                       Вобратную сторону не верно, т.е. аппроксимация на решении может быть
ком аппроксимации p = min(p ;p ) дифференциальную задачу (1), (2), если                                  вышеаппроксимации задач, т.к. имеется связь Lu = f, lu = ϕ между реше-
                 1  2                                                                  нием u и функциями f, ϕ.
для любых достаточно гладких функций u;f;ϕ из соответствующих про-
странств существуют такие постоянные h0, c1, p1, c2 и p2, что для всех                                       Устойчивость.
h≤h0 выполняются неравенства                                                                             Определение 4.6 Разностная схема (3), (4) устойчива, если существу-
                                                  p                                    ет такое h0 > 0, что для любого ε > 0 найдется такое δ = δ(ε), что для
         kL (u)     −(Lu) k +k(f) −f k ≤c h 1;
 h    U          F             F      h        1
       h          h F           h       F                                                                            (i)
                      h                   h                                            произвольных функций u , i = 1;2, являющихся решениями (3), (4), из
                                                  p                                                                  h
          kl (u)    −(lu) k      +k(ϕ)      −ϕ k ≤c h 2;
 h   U         Φ              Φ      h         2                                       неравенств
       h         h Φh          h        Φh





причем c , p , c и p не зависят от h.
 (1)     (2)

 (1)      (2)

                                                                                           h≤h , f        −f          ≤δ, ϕ −ϕ               ≤δ
   1    1  2     2                                                                                          0
 h        h

 h        h

                                                                                                                   F                      Φ
                                                                                                                    h                      h
    Выражения, стоящие под знаком норм, называют погрешностями ап-



 (1)     (2)

                                                                                       следует оценка u         −u          ≤ε.
проксимации.
 h       h

                                                                                                                        U
                                                                                                                          h
Раздел 2.                                                                           29                   30                                             Лекция 4. Теория разностных схем
Определение 4.7 Линейная схема устойчива, если существуют такое                                          Так как разностная схема устойчива, то по определению для линейных за-
h итакиепостоянныеc иc ,чтодляпроизвольныхрешенийu(i),i=1;2                                              дач имеем
  0                          1    2                                        h
задачи (3), (4) при всех h ≤ h0 верна оценка                                                                      ku −(u) k         ≤c kL (u)       −f k +c k(l (u)          −ϕ )k :
                                                                                                   h      U U         1   h   U      h F       2   h   U       h  Φ
                                                                                                            h   h               h        h               h          h








 (1)     (2)

 (1)     (2)

 (1)     (2)
     Итак как разностная схема аппроксимирует на решении дифференциаль-
      u    −u         ≤c f −f                +c ϕ −ϕ                :

 h       h
         1
 h      h
        2
 h       h

        U                      F                     Φ
         h                      h                      h                               ную задачу, то
                                                                                                                      ku −(u) k         ≤chp:
                                                                                                                         h       U U
Для случая линейных задач разностная схема представляет собой систему                                                                               h   h
                                     (1)     (2)   (1)     (2)                         Это неравенство по определению означает сходимость с порядком p. Теоре-
линейных алгебраических уравнений. И если f                =f ,ϕ =ϕ ,тоиз
                                     h       h     h       h                           ма доказана.
условияустойчивостиимеемku(1)−u(2)k ≤0.Т.е.снулевойправойчастью
                  h      h   h                                                             Отметим, что в классе задач с решениями конечной гладкости требова-
задача имеет единственное решение, следовательно,по теореме Кронекера–                                   ние устойчивости является необходимым условием сходимости.
Капелли задача однозначно разрешима при произвольных правых частях.
Такимобразом,длялинейныхуравненийустойчивостьвлечеткорректность                                              Методнеопределенныхкоэффициентовпостроенияразностных
 задача имеет единственное решение при всех правых частях, и малые                                      схем. Построимдляуравненияu(m)(x) = f(x)разностнуюсхемуLhuh =fh
                                                                                       на сетке с узлами {x }. Пусть f = (f)           . Тогда правая часть аппроксими-
изменения в f ;ϕ приводят к малым изменениям в решении.                                                                           i           h       F
         h   h                                                                                                                                   h                  n
    Непрерывную зависимость по fh (равномерную относительно h) назы-                                     руется точно. Оператор Lhuh будем искать в виде 1 Xciui на шаблоне
вают устойчивостью по правой части, а непрерывную зависимость по ϕ                                                                                                    hm
                                                                    h                                                                                   i=0
называют устойчивостью по граничным условиям.                                                            x , а коэффициенты определим из условия |(Lu)                 −L (u) | ≤ chp, т.е.
                                                                                         i                                                       F       h    U
    Найдем константу C в условии устойчивости. Представим задачу (3),                                                                                 n              h           h
(4) в виде системы линейных уравнений A u = b :                                                                                    |u(m)(x )− 1 Xc u(x )| ≤chp
                               h h      h                                                                                k    hm        i   i
                                                                                                                                   i=0
L             f            (1)     (2)                   (1)    (2)                           с наивысшим p. Представим x = x +α h и разложим каждое u(x ) в ряд
    h              h                                  −1                                                                              i    k     i                              i
         u =             ⇒ku −u k ≤k(A ) k kb −b k ;
  l       h       ϕ            h       h   h       h      h  h      h   h                         Тейлора относительно узла сетки x , будем иметь u(x + α h) = u(x ) +
   h                h                                                                                                                       k                      k     i          k
                                                                                       u′(x )α h+:::+O(hp+m). Подставивданные разложенияв условие аппрок-
                                                                                            k   i
              −1
т.е. можно взять C ≥ k(A )         k . Задача устойчива, если норма оператора
            h     h                                                                    симации и приравняв коэффициенты при соответствующих степенях h, по-
      −1
k(A )    k остается ограниченной при h → 0.                                                              лучимсистемулинейныхуравненийотносительнонеизвестныхc .Приэтом
    h     h                                                                                                                                                                        i
Пример 4.2. "Разностная схема" h ·u =f неустойчива.                                                      константа c в оценке будет зависеть от величины ku(s)kC для некоторого s.
                             h     h
                                                                                       Пример 4.3. Найти коэффициенты разностного оператора при наиболь-
Теорема 4.1 (Филиппов А.Ф.) (Освязиаппроксимации,устойчивости                                            шем p:
и сходимости). Пусть выполнены следующие условия:                                                                              1
    1) операторы L, l и Lh, lh  линейные;                                                                           u′(x ) =    (c u(x −h)+c u(x )+c u(x +h))+O(hp):
                                                                                                       k     h 1      k          2    k     3    k
    2) решение u дифференциальной задачи (1), (2) существует и един-
ственно;                                                                                                                                                              h2           h3
                                                                                       ПодставимрядТейлораu(x ±h)=u(x )±hu′(x )+                       u′′(x )±     u′′′(ξ ) в
    3) разностная схема (3), (4) аппроксимирует на решении дифференци-                                                                   k             k         k     2      k     6       ±
альную задачу (1), (2) с порядком p;                                                                     схему и приведем подобные слагаемые. Это приводит к системе уравнений
    4) разностная схема (3), (4) устойчива.                                                                         1                      1                   1 h2        h2
Тогда решение разностной схемы uh сходится к решению u дифференци-                                                  h(c1 +c2 +c3) = 0; h(c3h−c1h) = 1; h( 2 c1 + 2 c3) = 0:
альной задачи с порядком не ниже p.                                                                      Ее решение имеет вид c = −c = 1, c = 0, следовательно, L u |                         =
                                                                                                                    3        1     2   2                            h h xk
    Доказательство. Рассмотрим следующие задачи                                                           uk+1 −uk−1. При этом константа в оценке погрешности находится из усло-
                                                                                       вия: 2h

                                                                                                              3                  3
          L u =f ;            L (u)    =f +(L (u)         −f );                                                        1    h               h
h h      h          h    U      h      h    U      h                                                                    ′′′              ′′′            2
                          h                  h
                                                                                                                   c u (ξ )−        c u (ξ )  ≤ ch :
          l u =ϕ ;            l (u)   =ϕ +(l (u)         −ϕ ):                                                         h    6 3       +      6 1       −
          h h      h          h    U       h     h    U      h
                         h                  h
Раздел 2.                                                                              31                   32                  Лекция 5. Численное дифференцирование и задача Коши
Отсюда в том числе следует, что найденная схема точна для произволь-                                        Пусть погрешность ε вычисления функции u не превосходит 10−4. Тогда
ного многочлена второй степени. Таким образом, систему уравнений на                                         при h ∼ 10−4 имеем E ∼ 104. Оптимальный шаг h ∼ 10−1 дает E ∼ 10−2.
                                                                                                                                                      0                 0
коэффициенты можно найти из условия точности формулы разностного                                                Конечно-разностный метод решения задачи Коши. Для задачи
дифференцирования для многочленов наиболее высокой степени. Для это-
                                     2                                                                      ′                              0
го подставляем последовательно u(x) = 1;x;x ;::: в разностную формулу                                                       y (x) = f(x;y(x)); y(x ) = y ;
                                                                                                                                    0
и приравниваем к точному значению производной u(m)(x). Решение полу-                                                        y ∈ C(m)[x ;x +X]; kyk = max                       |y(x)|
                                                                                                                       0  0                     x∈[x0;x0+X]
ченной линейной системы определяет те же коэффициенты схемы.                                                построим следующую разностную схему
                                                                                                            n               n
                                                                                                         1 Xa y         =Xb f(x ;y );
  Лекция5.Погрешностьформулчисленногодиф-                                                                                 h       −i k−i          −i     k−i   k−i
                                                                                                           i=0             i=0
      ференцирования. Задача Коши                                                                                          y ={y}N;x =x +ih;h= X; ky k                    = max |y |
                                                                                                          h      i 0    i     0                   h U               i
                                                                                                                                           N          h   0≤i≤N
                                                                                          с некоторыми начальными условиями y0;y1;:::;yn−1.
Рассмотрим задачу численного нахождения значения производной в усло-                                            Если a0 6= 0, b0 6= 0, то схема называется неявной; если a0 6= 0, b0 = 0, то
виях приближенных вычислений:                                                                               явной; если a0 = 0, b0 6= 0, то с забеганием вперед.
                 n                                                                            Напомним, что разностная задача аппроксимирует дифференциальную
 (m)         1 X                  p     m                                                 на решении на отрезке [x ;x +X] с порядком p, если для функции погреш-
          u    (x) =           c u(x ) +ch = D u(x)+E :                                                                            0  0
            hm       i    i                         1
                i=0                                                                       ности                      n                   n
                                                                                                                  1 X                   X
                                                                                                           r =          a y(x      ) −      b  f x     ; y(x    )
Пусть известны только приближенные значения u˜(x ) и u(x )−u˜(x ) = ε .                                                        h           −i     k−i          −i    k−i      k−i
                                             i        i        i      i                                           h
Тогда                                                                                                                                 i=0                 i=0
                                                                                          выполняетсяоценка kr k           ≤chp иимеется нормировка по правым частям,
                                                                                                                     h F
                                                                                                                         h
      n                   n
     X                   X                                                                т.е. kf   −(f) k        → 0 при h → 0. Коэффициенты a , b                   формально
  1                   1                                                                           h       F   F                                              −i   −i
u(m)(x) =           c u˜(x ) +          c ε +E =Dmu˜(x)+E +E :                                                        h   h
 hm       i    i     hm       i i     1                  2     1                          определяются с точностью до множителя, указанная нормировка устраня-
     i=0                 i=0                                                              ет такой произвол и означает, что правая часть разностного уравнения ап-
    Величина Dmu˜(x) равна вычисленному приближению к u(m)(x), вели-                                        проксимирует правую часть дифференциального уравнения.
  n                                                                                           Вобщемслучаепоисккоэффициентовa−i,b−iсводитсякнетривиальной
  Pcε          p
чина E +E =             i i + ch дает погрешность. Пусть                                                    нелинейнойсистеме,поэтомуаппроксимациялевойиправойчастейдиффе-
  2     1        hm
 i=0                                                                                      ренциального уравнения может рассматриваться отдельно. В этом случае
                        Aε                                                                коэффициенты a−i, b−i определяются из условий аппроксимации задачи
         |E +E |≤           +chp =E(h);                                                                                        p                          p
            1     2                                                                           kL (y)     −(Ly) k        ≤c h , kf −(f) k           ≤c h .
                         m                                                                       h    U          F   F      1       h       F   F      2
                        h                                                                              h          h   h                      h   h
                                                                                          Вданном разделе мы не рассматриваем методы построения краевых усло-
где Pn |ci| ≤ A, |εi| ≤ ε. Нас интересует минимизация погрешности E(h)                                      вий y0;:::;yn−1 с требуемым порядком точности. Отметим также, что ре-
 i=0
за счет выбора h. В точке минимума h0 имеем E′(h0) = 0. Отсюда следует,                                     шение задачи Коши по сути сводится к интегрированию функции f, поэто-
что                                                                                                         му результаты о погрешности формул численного дифференцирования не
                                                  1
    −m εA +cphp−1 =0; hp+m = εAm; h0 =εAmm+p.                                                             применимы.
  hm+1         0           0         cp              cp                                                  Условия аппроксимации p-го порядка. Рассмотрим задачу нахож-
   0
           1          1− m          p         p                                                                                                             ′
Таким образом, h ∼ εm+p;E ∼ ε                m+p +εm+p ∼εm+p.                                               дения аппроксимации высокого порядка для уравнения y (x) = f(x) следу-
   0             0
                                                                                          ющей схемой:
Пример 5.1. Известно, что                                                                                                                   n                n
  u′′(x) = u(x+h)−2u(x)+u(x−h) +ch2:                                                                                   1 Xa−iyk−i =Xb−ifk−i:
                           h2                                                                                          h i=0              i=0
 Раздел 2.                                                                                33                    34                   Лекция 5. Численное дифференцирование и задача Коши
 Выпишем ряд Тейлора для решения задачи y и правой части f = y′:                                                    Устойчивость разностных схем. Для задачи Коши принято прове-
                    p                  s
   y(x −ih)=Xy(s)(x )(−ih) +O(hp+1);                                                          рять более слабое условие α-устойчивости.
       k                      k    s!
                                                                                                                                                 n
                   s=0       p                  s−1                                           Определение 5.1 Разностнаясхема 1 Xa−iyk−i = fk длязадачиy′(x) =
      f(x −ih)=y′(x −ih)=Xy(s)(x )(−ih)                        +O(hp):                                                                                   h i=0
          k                k                     k   (s −1)!
                           s=1                                                                f(x) называется α-устойчивой, если все корни соответствующего харак-
 Тогда для функции погрешности имеем: r                   = 1y(x )E + h0y′(x )E +                               теристического многочлена однородного разностного уравнения принадле-
                                     h      h    k   0            k   1
 h1y′′(x )E +:::+hp−1y(p)(x )E +O(hp); где                                                                      жатединичному кругу и на границе нет кратных корней.
  k   2                      k   p
            n                     n           n
    E =Xa ; E =−Xa i−Xb ;                                                                         Можно показать, что для любой разностной схемы, не удовлетворяю-
      0          −i      1            −i          −i                                          щей условию α-устойчивости, существует дифференциальное уравнение с
           i=0                   i=0         i=0
        n            s             s−1
E =X a (−i) −b (−i)                       ; s = 2;:::;p:                                      бесконечно дифференцируемой правой частью, для которого даже при от-
  s           −i   s!       −i(s−1)!                                                          сутствии округлений и погрешности в начальных данных решение разност-
       i=0                                                                                    ной задачи не стремится к решению дифференциальной при измельчении
                                       n
 Данные соотношения и условие нормировки Xb−i = 1 для правой части,                                             шага.Условиеα-устойчивостидляширокогоклассазадачобеспечиваетсхо-
                                      i=0                                                     димость,ноконстантавоценкеблизостирешенийможетувеличиватьсяпри
 означающее, что k(f) −f k             →0приh→0,позволяютсформулировать                                         увеличении длины отрезка X. Поэтому всегда полезно проверить свойства
         h     h F
                   h
 следующее утверждение.                                                                                         выбранной разностной схемы для модельного уравнения.
 Теорема 5.1 Для задачи y′(x) = f(x) условия аппроксимации на решении                                           Пример5.3. Длязадачиy′+y =0,y(0)=1сточнымрешениемy(x)=e−x
 p-го порядка имеют вид:                                                                                        рассмотрим различные схемы, имеющие второй порядок аппроксимации и
       n              n             n                                                         являющиеся α-устойчивыми. Отметим, что равенства y0 = 1, y1 = 1 − h
       Pa−i=0; Pb−i=1;Pa−ii=−1;                                                               аппроксимируют решение y(x) исходной задачи в точках x = 0;h со вто-
      i=0            i=0          i=0                                                         рымпорядком. Нас интересует качественная близость решений разностной
       n
       P(a−ii+b−is)is−1 = 0; s = 2;:::;p:                                                     и дифференциальной задач на большом отрезке [0;X], X = Nh.
      i=0                                                                                         Первая схема:
     Первая группа (три уравнения) образует необходимые и достаточные
 условия аппроксимации (т.е. p = 1). Всего имеется p+2 уравнения и 2n+                                                       y       −y       y     +y                  1−h=2
 2 неизвестных, для корректности p = 2n, при этом возможная точность                                                         k+1         k + k+1        k = 0;    µ=             ;   |µ| < 1;
                                                                                                                  h               2                    1+h=2
 O(h2n).                                                                                                                     y0 =1:
     Однако,методыснаивысшимпорядкомаппроксимацииобычнонеустой-
 чивы,поэтомупрактическинеприменимыдлярасчетов.Внастоящеевремя                                                  При малых h решение разностной задачи yk = µk качественно похоже
 используют алгоритмы при a−i = 0, i ≥ 2 (в этом случае производная ап-                                         на решение дифференциальной задачи: yk монотонно убывает и lim yN =
 проксимируется по двум точкам). Для остальных схем обычно отсутствует                                                X=h      −X                                                                h→0
                                                                                              lim µ      =e       =y(x ).
 сходимость даже для класса бесконечно гладких правых частей и при от-                                          h→0                        N
 сутствиипогрешностиокругления,а если сходимостьи наблюдается,то по-                                                Вторая схема:
 грешность растет как eCX. При этом аппроксимация производной по боль-
 шому числу точек влечет проблему начальных условий.                                                                   ( yk+1−yk−1                                    p        2
                                                                                                                       +yk =0; µ1;2 =−h± 1+h ; max|µi|>1;
 Пример5.2. СхемыАдамсаспорядкомаппроксимациинарешенииO(h2),                                                                    2h                                                  i=1;2
     явная схема: yk −yk−1 = 3f             −1f       ,                                                                   y0 = 1;y1 = 1−h:
        h          2 k−1     2 k−2                                                            В данном случае у задачи имеется растущее по модулю (но ограниченное
     неявная схема: yk −yk−1 = 1(fk +fk−1).                                                                     на [0;X] при h → 0) знакопеременное решение. Схему не стоит применять.
           h         2
 Раздел 2.                                                                                                                                        35                                  36                                                                 Лекция 6. Методы решения задачи Коши
 Если, например, погрешность вычислений ∼ 10−18, то растущее решение                                                                                                                         Методы типа Адамса. Рассмотрим следующее интегральное тожде-
 весьма заметно для X ∼ 10, а для X ∼ 20 сходимость не наблюдается.                                                                                                                   ство, верное на решении задачи y′(x) = f(x;y):
       Третья схема:                                                                                                                                                                                                                            x+h                                     x+h
                                                                                 r                                                                                                              y(x+h)=y(x)+ Z y′(τ)dτ =y(x)+ Z f(τ;y(τ))dτ:
  yk+1−yk−1 + yk+1+yk−1 =0; µ=± 1−h; max|µi|<1;                                                                                                                                                                                     x                                        x
                2h                             2                                       1+h i=1;2
  y0 = 1;y1 = 1−h:                                                                                                                                                        Заменим точное значение интеграла на приближенное значение, применив
                                                                                                                                                                           следующую лемму.
 Даннаясхемапо своим свойствампохожана первую схему, но имеет знако-                                                                                                                                                                     2                                                                     Z b
 переменное решение.                                                                                                                                                                  Лемма 6.1 Пусть g ∈C [a;b]. Тогда для интеграла I(g) =                                                                          g(x)dx вер-
       Еще раз отметим, что рассмотренное α-условие характеризует устой-                                                                                                                                                                                                                                          a
                                                                                                                                                                           ны следующие оценки:
 чивость схемы и при наличии аппроксимации обычно влечет сходимость                                                                                                                                                                              ′   (b−a)2
 решения разностной схемы к решению дифференциальной задачи. Однако,                                                                                                                           1)|I(g) − g(a)(b − a)| ≤ kg k                              2 2 ;
                                                                                                                                                                                    2)|I(g) − g(b)(b − a)| ≤ kg′k(b−a) ;
 сходимость может существенно зависеть от длины отрезка интегрирования                                                                                                                                                                                   2          3
 и отсутствовать для больших X.                                                                                                                                                                3)|I(g) − g(a+b)(b −a)| ≤ kg′′k(b−a) ;
                                                                                                                                                                                                             2                                      24                 3
                                                                                                                                                                                    4)|I(g) − 1(g(a) +g(b))(b −a)| ≤ kg′′k(b−a) ;
                                                                                                                                                                                                       2                                                          12
                                                                                                                                                                           где kgk = maxx∈[a;b]|g(x)|.
    Лекция 6. Методы решения задачи Коши                                                                                                                                                     Доказательство. Первые три оценки могут быть получены из разло-
                                                                                                                                                                           жений Тейлора:
 Кромеконечно-разностногометодадлярешениязадачиКошиприменяются                                                                                                                                            g(x) = g(a)+g′(ξ (x))(x−a);
                                                                                                                                                                                                                                 1
 следующие алгоритмы.                                                                                                                                                                                     g(x) = g(b) +g′(ξ (x))(x −b);
                                                                                                                                                                                                                                2
                                                                                                                                                                                                                 a+b             ′  a+b               a+b            1 ′′                         a+b 2
                                                                                                                                                                                               g(x) = g(               ) +g (              )(x −             ) + g (ξ (x))(x−                            ) ;
       МетодТейлора.Пустьнаотрезке[x ;x +X]требуетсянайтирешение                                                                                                                                                              2                  2                  2           2         3                    2
                                                                       0      0
 дифференциального уравнения y′ = f(x;y) при начальном условии y(x ).
                                                                                                                                       0                                   четвертое  из тождества:
 Дифференцируя уравнение по x, имеем следующую цепочку соотношений:                                                                                                                      b                                                                    b
            ′′                      ′      ′′′                            ′               ′ 2              ′′                                                              Z g(x)dx− b−a(g(a)+g(b))= 1Z (a−x)(b−x)g′′(x)dx;
          y =fx+fyy; y =fxx+2fxyy +fyy(y ) +fyy ; ::: :                                                                                                                                                2                                     2
                                                                                                                                                                            a                                                                   a
                                                                                                                                                                           которое можно проверить, проинтегрировав правую часть равенства по ча-
 Последовательно подставляя начальные данные в полученные соотноше-                                                                                                                   стям два раза. Лемма доказана.
 ния, получаем значения производных искомой функции: y′(x ), y′′(x ), :::.                                                                                                                   Явный метод Эйлера. Из оценки 1) леммы следует, что
                                                                                                                0              0
                                                                                                         n      (i)
                                                                                                        Py (x0)                          i                                                                                                                                            2
 Этопозволяетнаписатьприближенноеравенство:y(x) ≈                                                                                     (x−x ) :                                                                              y(x+h)=y(x)+hf(x;y(x))+O(h ):
                                                                                                                   i!                0
                                                                                                       i=0
 Если величина |x−x | больше радиуса сходимости ряда, то формально ме-
                               0                                                                                                                                           Это приводит к расчетным формулам
 тод неприменим, но можно разбить [x ;x +X] на подотрезки и построить
                                                                  0     0
 решение в точке x за несколько шагов. Данный алгоритм может быть поле-                                                                                                                                                       y         =y +hf(x ;y );                         y =y(x );
                                                                                                                                                                                                                     k+1           k                k     k            0             0
 зен, когда требуется решить большое количество задач вполне определен-
 ного вида с различными начальными данными. В этом случае требуемые                                                                                                                   имеющимлокальнуюпогрешностьO(h2)исходимостьспорядкомO(h),т.е.
 производные можно найти аналитически и сохранить для многократного                                                                                                                   схема имеет первый порядок точности.
 применения.                                                                                                                                                                                 Неявный метод Эйлера. Из оценки 2) леммы следует, что
Раздел 2.                                                                                                                                       37                                  38                                                               Лекция 6. Методы решения задачи Коши
                   y(x+h)=y(x)+hf(x+h;y(x+h))+O(h2):                                                                                                                     Иесли выбрать y∗(x+h) = y(x)+hf(x;y(x)), то требуемое на y∗ условие
Это приводит к расчетным формулам                                                                                                                                                   точности будет выполнено. Соответствующие расчетные формулы имеют
                        y         =y +hf(x                     ; y        );      y =y(x );                                                                              вид:
                          k+1           k                k+1       k+1              0             0
такжеимеющимлокальнуюпогрешностьO(h2),сходимостьO(h), но устой-                                                                                                                                                       y∗        =y +hf(x ;y );                         y =y(x );
                                                                                                                                                                                                             k+1           k                k     k           0             0
                                                                                                                                                                                                                                   h                                          ∗
чивымдляболееширокогоклассауравнений.                                                            Накаждомшагенеявного                                                                                                 y         =y + f(x ;y )+f(x                                     ; y       ) :
                                                                                                                                                                                                             k+1           k       2          k     k               k+1        k+1
метода Эйлера требуется решать нелинейное уравнение относительно yk+1.                                                                                                                    Замечание.Данныйподходпосутисоответствуетпервомушагувпри-
При фиксированном k решение можно найти следующим внутренним ите-                                                                                                                   ближенном решении имеющегося нелинейного уравнения. Отметим, что
рационным процессом по j = 0;1; ::::                                                                                                                                                дальнейшиеитерацииформальнонеповышаютпорядокточности,нообыч-
                         yj+1 = y +hf(x                         ; yj      );      y0        =y :                                                                         но уменьшают главный член погрешности.
                           k+1           k                k+1       k+1             k+1            k                                                                           Замечание.Применимидеюзаменыy(x+h)нанекотороеприближение
Можнопоказать, что при достаточно малых h и гладкой функции f метод                                                                                                                 y∗ в случае неявного метода Эйлера. Получим:
сходится, т.к. отображение yj+1 = Y(yj                                            ) является сжимающим.                                                                                                                            y∗        =y +hf(x ;y );
                                              k+1                k+1                                                                                                                                                      k+1            k               k     k
        Формулы Адамса второго порядка точности. Для формулы тра-                                                                                                                                                                  y         =y +hf(x                     ; y∗       ):
                                                                                                                                                                                                                          k+1            k               k+1       k+1
пеций оценка 4) из леммы дает
                                                                                                                                                                         Формально локальная погрешность остается O(h2), но устойчивость схемы
                                        h                                                                          3                                                   повышается.
     y(x+h)=y(x)+ 2 f(x;y(x))+f(x+h;y(x+h)) +O(h ):                                                                                                                            Построимдругуюпарурасчетныхформул.Дляэтогозамениминтеграл
                                                                                                                                                                         по формуле прямоугольников по центральной точке:
Соответствующая расчетная формула имеет вид
                                                                                                                                                                                                     y(x+h)=y(x)+hf(x+ h;y(x+ h))+O(h3):
                                   h                                                                                                                                                                                                                 2                2
           y        =y + f(x ;y )+f(x                                      ; y       ) ;       y =y(x ):
             k+1           k       2          k      k              k+1        k+1               0             0
                                                                                                                                                                         Еслиy(x+h)=y∗(x+h)+O(h2),токакивпредшествующемслучаеимеем
                                                                                                                                                                                              2                      2
Решение yk+1 для каждого k часто удается найти внутренним итерацион-                                                                                                                                                                                             h                  h
ным методом:                                                                                                                                                                                                   y(x+h)=y(x)+hf(x+ 2;y∗(x+ 2))+O(h3):
              j+1                   h                                          j                                                                                       Соответствующие расчетные формулы принимают вид:
           y         =y + f(x ;y )+f(x                                     ; y        ) ; j = 0;1;::::
             k+1            k       2          k     k               k+1       k+1
                                                                                                                                                                                                                       y∗         =y +hf(x ;y );
                                                                                                                                                                                                                         k+1             k      2         k     k
При малых значениях h соответствующее отображение обычно является                                                                                                                                                                        2                                     ∗
                                                                                                                                                                                                                       yk+1 = yk +hf(x                       1 ; y      1):
сжимающим, и итерационный процесс сходится к искомому y                                                                         .                                                                                                                                  k+2        k+
                                                                                                               k+1                                                                                                                                                      2
       Упростим расчетные формулы неявного метода Адамса без понижения                                                                                                                    Методы Рунге–Кутта. Один из наиболее популярных подходов к ре-
порядкаточности.Добавимвправуючастьслагаемые±hf(x+h;y∗(x+h)),                                                                                                                       шениюзадачиКошидляуравненийпервогопорядкаy′ =f(x;y); y(x ) =y
                                                                                                    2                                                                                                                                                                                                          0          0
где y(x+h)−y∗(x+h)=O(h2). Так как                                                                                                                                                   заключается в следующем. Зафиксируем некоторые числа
                                                                                                                                                                                                       α ;:::; α ;               p ;:::; p ;              β ; 0<j<i≤q
                     h (f(x+h;y(x+h))−f(x+h;y∗(x+h)))=                                                                                                                                                    2              q         1              q         i;j
                     2
                     hf (x+h;y˜)(y(x+h)−y∗(x+h))=O(h3);                                                                                                                  и последовательно вычислим
                     2 y
                                                    ∗                                                                                                                                       k (h) = hf(x; y);
где y˜ лежит между y(x+h) и y (x+h), то                                                                                                                                                                  1
                                                                                                                                                                                            k (h) = hf(x+α h; y +β                                k (h));
                                                                                                                                                                                              2                              2                2;1 1
                                                                                                                                                                                            : : :     : : :     : : :     : : :     : : :     : : :     : : :
                                       h                                             ∗                              3
    y(x+h)=y(x)+                            f(x;y(x))+f(x+h;y (x+h)) +O(h ):                                                                                                                k (h) = hf(x+α h; y+β k (h)+:::+β                                                          k       (h)):
                                       2                                                                                                                                                      q                              q                q;1 1                           q;q−1 q−1
    Раздел 2.                                                                                                              39                           40                                                  Лекция 7. Оценка глобальной погрешности
                                                                                                                                                                                            ′          ′′          ′′′
    Вэтом случае расчетная формула будет иметь вид:                                                                                                     Подставим в выражения ϕ(h); ϕ (h); ϕ (h); ϕ (h) значение h = 0 и, вос-
                                                                                                                                      пользовавшись этими соотношениями, получим:
                                                                q
               y(x+h)≈z(x+h)=y(x)+Xpk(h):
                                                                     i  i                                                                        ϕ(0) = y(x)−y(x) = 0;
                                                              i=1                                                                                  ′
                                                                                                                                                 ϕ(0)=(1−p1−p2)f(x; y);
                                                                                                                                                   ′′
                                                                                                                                                 ϕ (0) = (1−2p α )f (x; y)+(1−2p β )f (x; y)f(x; y);
    Обозначимпогрешностьметоданашагечерезϕ(h) =y(x+h)−z(x+h).Если                                                                                                                          2 2 x                              2 21     y
                                                                                                                                                   ′′′                        2
                                                                                                                                                 ϕ (0) = (1−3p2α )fxx(x; y)+(2−6p2β21)fxy(x; y)f(x; y)+
    f(x; y)  достаточно гладкая функция своих аргументов, то справедлива                                                                                                                       2
                                                                                                                                                                          2                              2                   ′′
    формула Тейлора:                                                                                                                                                      +(1−3p2β21)fyy(x; y)(f(x; y)) +fy(x; y)y (x):                                            (1)
                                                                                                                                                               ′
                              s                                                                                                       Соотношение ϕ (0) = 0 выполняется при всех f(x; y), если
                                     (i)               (s+1)
                ϕ(h) = Xϕ (0)hi+ ϕ                             (θh)hs+1;                                                                                                               1−p1−p2=0;                                                           (2)
                             i=0      i!               (s +1)!
                                                                                                                                                              ′′
                                                                                                  ′                                   соотношение ϕ (0) = 0 выполняется, если
    где 0 ≤ θ ≤ 1. Выберем параметры метода α ; p ; β                                              так, что ϕ (0) =
                                                               i      i     i;j
          (s)                                                                                                s+1
    : : : = ϕ       (0) = 0. Тогда локальная погрешность метода равна O(h                                                ), а                                                             1−2p α =0 и 1−2p β =0:                                                              (3)
    величина s называется порядком метода.                                                                                                                                                          2 2                           2 21
   Построим метод при q = 1 и выпишем формулу погрешности. Имеем:                                                                                                                           ′             ′′
                                                                                                                                      Таким образом, ϕ(0) = ϕ (0) = ϕ (0) = 0 при всех f(x; y), если выпол-
   ϕ(h) = y(x+h)−y(x)−p1hf(x; y);                               ϕ(0) = 0;                                                                        нены три указанных выше соотношения (2), (3) относительно четырех па-
     ′             ′                                                                                                                             раметров. Задавая произвольно один из параметров, получим различные
   ϕ(0)=(y (x+h)−p1f(x; y))|h=0 = f(x; y)(1−p1);
     ′′           ′′                                                                                                                             методы Рунге–Кутта второго порядка. Например, при p1 = 1=2 получаем
   ϕ (h) = y (x+h):
      ′                                                                                                                               p =1=2; α =1; β =1.Приp =0получаемp =1; α =1=2; β =1=2.
    Равенство ϕ (0) = 0 выполняется для всех гладких функций f(x; y) лишь в                                                                               2               2            21                   1                          2            2               21
                                                                                                                                                                          ′                                              ′′′
    случае p1 = 1. Для погрешности этого метода на шаге получаем выражение                                                                              В случае уравнения y = y, согласно (1), имеем ϕ (0) = y независимо от
′′             h2                                                                                                                     значений p ; p ; α ; β . Отсюда следует, что нельзя построить формул
    ϕ(h) = y (x+θh)                  :                                                                                                                                    1      2      2      21
                2                                                                                                                     Рунге–Кутта со значениями q = 2 и s = 3.
  Построим все методы при q = 2. Для погрешности имеем:
        ϕ(h) = y(x+h)−y(x)−p1hf(x; y)−p2hf(x¯; y¯);                                                                                      Лекция 7. Оценка глобальной погрешности
    где x¯ = x+α h; y¯ = y+β hf(x; y). Вычислим производные функции ϕ(h):
       2                   21
                                                                                                                                      Главный член погрешности. Для задачи
       ′           ′
    ϕ(h)=y(x+h)−p f(x; y)−p f(x¯; y¯)−p h α f (x¯; y¯)+
                          1                  2                 2       2 x
                                                                                                                                                                                  y′(x) = y;         y(0) = 1
    β21fy(x¯; y¯)f(x; y) ;
       ′′           ′′                                                                                                                         рассмотрим схему
    ϕ (h) = y (x+h)−2p α f (x¯; y¯)+β f (x¯; y¯)f(x; y) −
                              2    2 x                 21 y
  2                                                               2                             2
    −p h α f (x¯; y¯)+2α β f (x¯; y¯)f(x; y)+β f (x¯; y¯)(f(x; y)) ;
         2      2 xx                    2 21 xy                               21 yy                                                                                                 yk+1 −yk
       ′′′           ′′′                     2                                                                                                                                           h         =yk;        y0 = 1;        k ≥ 0:
    ϕ (h) =y (x+h)−3p α f (x¯; y¯)+2α β f (x¯; y¯)f(x; y))+
                               2     2 xx                    2 21 xy
         2                             2                                                                                                                                                                                                     2
    +β21fyy(x¯; y¯)(f(x; y))               +O(h):                                                                                                Найдем в разложении ошибки y(x )−y = c +c h+c h +··· постоянные
                                                                                                                                                                                              n        n       0      1        2
                                                                                                                                      c ;c для точки x = 1.
                                                                                                                                        0   1                      n
    Согласно исходному дифференциальному уравнению имеем:                                                                                                     Точное решение разностной задачи имеет вид:
  ′              ′′                        ′′′                                  2           ′′                                                                                                              n                    n
y =f; y =fx+fyf; y =fxx+2fxyf+fyyf +fyy :                                                                                                                         yn = (1 +h)yn−1 = (1+h) y0 = (1+h) ;
  Раздел 2.                                                                                                                                                 41                                     42                                                                 Лекция 7. Оценка глобальной погрешности
  а точное решение дифференциальной задачи при x = x равно y(x ) =                                                                                                                                       Перейдем к получению оценки глобальной погрешности для одношаго-
                                                                                                                  n                         n
  exp(x ). Так как x = nh = 1, следовательно,                                                                                                                                                      вого явного метода, см. рис.:
  n                           n
                                                                                                                                                                                                             y(x)                                                                      y=_y(x )
                                                                  1=h                         1                                                                                                                                                              y  (x   )=y              n    n   n
                y(x )−y =e−(1+h)                                         =e−exp                     ln(1 +h) =                                                                                                                                                  n−1   n−1     n−1           y  (x )
                       n           n                                                            h                                                                                                                                                                                            n−1   n
                                                                                                                                                                                                                                                                                            y(x )
                                                                                                                                                                                                                                               y(x )=y                                       k   n
                                               h               2             e                  2                                                                                                                                          k    k    k                                  y  (x )
                =e 1−exp −2 +O(h ) = 2h+O(h ):                                                                                                                                                                                y  (x   )=y                                                    k−1   n
                                                                  e                                                                                                                                                            k−1   k−1     k−1                                            y(x )
  Таким образом, имеем c = 0;c =                                                 :                                                                                                                                                                                                                      1   n
                                          0             1                                                                                                                                                                                                                                   y(x )
                                                                                                                                                                                                                    y(x )=y                                                                      n
                                                                  2                                                                                                                                                  1   1     1                                                             0
                                                                                                                                                                                                                                                                                            y(x )
         Оценка погрешности явного одношагового метода. Для уравне-                                                                                                                                                    y(x )=y                                                                              n
  ния y′ = f(x;y) с начальным условием y(x ) рассмотрим явную одношаго-                                                                                                                                                 0   0     0
                                                                                  0                                                                                                                         y(x )
  вую разностную схему общего вида                                                                                                                                                                                          0                                                                               x
         y , y            =F(x ;y ;x                         −x ), k = 0;1; ::: ;n−1; x = x +X.                                                                                                                              x           x             x            x                   x            x
0      k+1                  k      k      k+1            k                                                  n          0                                                                                            0           1             k−1          k                  n−1           n
  Нас интересует оценка погрешности в n-ой точке интегрирования, т.е. ве-                                                                                                                                 Здесь y(x)  точное решение исходного уравнения, y  найденное при-
  личина |y(x )−y |. Докажем вспомогательное утверждение.                                                                                                                                                                                                                                                                k
                n           n                                                                                                                                                           ближенное решение, а yk(x)  решение уравнения y′(x) = f(x;yk(x)) с
                                                                                                                                                                                                                                                                                                            k
                                                                                                                                                                                        начальными условиями y (x ) = y .
  Лемма 7.1 Пусть y (x) и y (x)  два решения дифференциального урав-                                                                                                                                                                                   k      k            k
                                    1                2                                                                                                                                        Пусть y = F(x ;y ;h ). При этом y − y(x ) = r  погрешность на-
  нения y′ = f(x;y), x ∈ [a;b], где f  непрерывная и непрерывно дифферен-                                                                                                                                                1                 0     0      1                               0              0            0
                                                                                                                                                                                        чальных данных, y − y (x ) = c hs+1 + δ  погрешность метода плюс
  цируемая по y функция. Тогда                                                                                                                                                                                                              1          0      1             1 1                 1
                                                                                                                                                                                        вычислительная погрешность. И так далее, y −y                                                                   (x ) = c hs+1 +δ для
                                                                                                                                                                                                                                                                                       k         k−1        k            k k                k
                                                                                          b                                                                                             всех k = 2;:::;n.
                                                                                         R f (x;y˜(x))dx
                                                                                              y                                                                                               Рассмотрим следующее тождество:
                          y2(b) −y1(b) = (y2(a) −y1(a))ea                                                         ;
                                                                                                                                                                                                                                                                n
  где функция y˜(x) заключена между y1(x) и y2(x).                                                                                                                                                      y −y(x )=y (x )−y(x )=X(y (x )−y                                                                     (x ))+y (x )−y(x ):
                                                                                                                                                                                                n              n           n      n                n                    k      n           k−1         n             0     n                n
         Доказательство. Рассмотрим два решения с различными начальными                                                                                                                                                                                                 k=1
  данными                                                                                                                                                                                          Из определения функции y (x), (см. рис.) и леммы имеем:
                              y′(x) = f(x;y2(x)); y′(x) = f(x;y1(x)):                                                                                                                                                                            k
                                2                                         1
                                                                                                                                                                                                                                                                                                    xn
  Для их разности имеем тождество                                                                                                                                                                                                                                                                              R f (τ;y˜ (τ))dτ
                                                                                                                                                                                                                                                                                                          y       k
                                                                                                                                                                                                                                                                                                   xk
                                                                                                                                                                                                              y (x )−y                     (x ) = (y (x )−y                            (x ))e                                  :
                                                           ′                                                                                                                                                     k     n            k−1        n              k     k           k−1         k
                             (y2(x) −y1(x)) = fy(x;y˜)(y2(x)−y1(x))
                                                                                                                                                                                        Так как y (x ) = y , а оценка локальной погрешности имеет вид y −
  с некоторой функцией y˜(x). Так как y˜(x) фиксирована, и f (x;y˜) зависит                                                                                                                                              k      k              k                                                                                                           k
                                                                                                                       y                                                                y        (x ) = c hs+1 +δ ; то
  только от x, то можно определить функцию g(x) = fy(x;y˜). Тогда                                                                                                                                    k−1        k            k k                k
                                                                                                                                                                                                                                                                      xn                                     xn
                  x                                                         x                                                                                                                                                                                         R                                      R
                 R                                                         R                                                                                                                                                        n                                     f (τ;y˜ (τ))dτ                         f (τ;y˜ (τ))dτ
              −a g(τ)dτ                                       ′        −a g(τ)dτ                                                                                                                                                 X s+1                               xk y           k                        x0 y          0
            e                  (y (x) −y (x)) = e                                        g(x)(y (x) −y (x)):                                                                                          y −y(x )=                         (c h            +δ )e                                     +r e                                  :
                                   2                1                                                 2               1                                                                                 n              n                    k k                k                                        0
                                                                                                                                                                                                                                 k=1
                                        x
                           d  −R g(τ)dτ
  Следовательно,                            e a                 (y2(x)−y1(x)) = 0: Интегрируя по [a;b], име-                                                                                       Пусть |ck| ≤ c;|δk| ≤ δ;hk ≤ h. Рассмотрим два случая.
                          dx
                                b
                                R                                                                                                                                                              1. |f (τ;y˜ (τ))| ≤ L. Тогда
                            − g(τ)dτ                                                                                                                                                                   y          k
  ем (y2(b)−y1(b))e a                                     =y2(a)−y1(a): Отсюда, умножая на экспоненту,
  получаем требуемое равенство. Лемма доказана.                                                                                                                                                      |y −y(x )| ≤ eL(xn−x0)(chshn+δn)+r eL(xn−x0) = eLX(cXhs +δn+r ):
                                                                                                                                                                                              n              n                                                               0                                                                  0
Раздел 2.                                                                           43                   44                                   Лекция 7. Оценка глобальной погрешности
                               xn
                        n   −L R dτ                                                    мы не только теряем качественное совпадение решений разностной и диф-
    2. f (τ;y˜ (τ)) ≤ −L. Тогда, т.к. P e        xk    ≤      1     , имеем                              ференциальной задач, но и столкнемся с катастрофическим ростом нормы
 y     k                                           1−e−Lh
                       k=1                                                             приближенного решения и вычислительной погрешности.
                    1                    chs+1 +δ                                          Так как y(x+h) = y(x)+hy′(x)+ h2y′′(ξ), где x ≤ ξ ≤ x+h, то погреш-
     |y −y(x )| ≤ (chs+1 +δ)                 +r e−LX ≤                 +r e−LX:                                                                       2
n       n                  1−e−Lh        0              Lh         0                              ность аппроксимации имеет вид |hy′′(ξ)|. Величина y′′(ξ) = a2e−aξ ≪ 1 при
                                                                                                                              2
Формально данная оценка не ухудшается при увеличении отрезка интегри-                                    aξ ≫ 1. Поэтому при aξ ≫ 1 для достижения требуемой точности локаль-
рования X, но с ростом X константа c может существенно расти.                                            ной аппроксимации |hy′′(ξ)| ≤ ε не требуются мелкие шаги, но h ≤ hcou для
                                                                                                                2
   Устойчивые и неустойчивые задачи. Рассмотримкачественноепове-                                         всех x из условия качественного совпадения решений (условия устойчиво-
дение решений следующих уравнений:                                                                       сти).
         y′ = y ;    y′ = −y ;     y′ = −2(x−1)y ;                                                    Данный пример показывает, что разумно выделить класс т.н. жестких
1    1     2       2     3                3                                            задач. Будем считать задачу y′ = f жесткой, если характерное время из-
         y (x) = cex;     y (x) = ce−x;     y (x) = ce−(x−1)2:
1               2                 3                                                    менения решения много меньше отрезка интегрирования (в данном случае
                                                                                                                                                 ′                           T
Интегральные кривые первого семейства расходятся с увеличением x, вто-                                   это означает, что aX ≫ 1). Система уравнений y = Ay, y = (y1;:::;yn)
рого  сближаются, а третьего  сначала расходятся, а затем сближаются.                                  считается жесткой, если
Так как на k-ом шаге найденное приближенное значение yk смещается с
интегральной кривой y         (x), то внесенная в результате этого погрешность                                                                         max |Re(λ (A))|
         k−1                                                                                            1)Re(λ (A)) < 0;      2)s =       i      i       ≫1:
можетвзависимостиотповедения семейства решений либо возрастать,ли-                                                                i                    min |Re(λ (A))|
                                                                                                                                          i      i
бо уменьшаться, см. рис.:
                                                                                       Число s принято называть числом жесткости. Данное определение есте-
       C exp(x)                 C exp(-x)                C exp(-(x-1)^2)                          ственнообобщаетсянаслучайматрицA(x),атакже(наосновеметодазамо-
                                                                                       роженных коэффициентов) на случай правых частей общего вида F(y;x).
                                                                                            В случае одного уравнения задача будет жесткой, если решение со-
                                                                                       держитнесколькокомпонентссущественноотличающимисяхарактерными
                                                                                       временами изменения. Например, пусть y′ = −a(y −sinx)+cosx;y(0) = 1,
Всвязисэтимимеетсясущественнаяразницавчисленноминтегрировании                                            a ≫ 1. Тогда точное решение имеет вид y(x) = e−ax + sinx. Здесь можно
двух на первый взгляд эквивалентных задач                                                                выделить пограничный слой быстрого изменения решения, далее решение
   y′ = y1; y1(0) = 1;     y′ = ex; y2(0) = 1;                                         мало отличается от плавной функции sinx. Однако при всех x для успеш-
    1                       2
так как соответствующие им семейства интегральных кривых существенно                                     ного интегрирования необходимо выполнение условия h ≤ hcou.
отличаются: y (x) = cex, y (x) = c+ex.                                                                       Еще раз отметим, что устойчивость дифференциальной задачи опреде-
         1              2                                                                         ляется типом уравнения и значениями параметров, устойчивость разност-
Задача 7.1. Выяснить, какое из рассмотренных уравнение явный метод                                       ной задачи  типом разностной схемы, значениями параметров и величи-
Эйлера проинтегрирует точнее.                                                                            ной шага. Так явные схемы с постоянным шагом y                     = y +hf(x ;y )
    Жесткиесистемы.Рассмотримзадачуинтегрированияуравненияy′ =                                                                                                         k+1      k          k  k
                                                                                       обычно требуют мелких шагов, но просты в реализации. Неявные схемы
−ay, a = const > 0, x ∈ [0;X]. Для решения данной задачи запишем явную                                   y     =y +hf(x ;y           ) обычно имеют менее жесткие условия на h, но в
разностную схему                                                                                           k+1      k         k  k+1
                                                                                       общем случае каждый шаг требует решения нелинейного уравнения. Для
   yk+1 −yk = −ay ⇒y             =(1−ha)y :                                            рассмотренногомодельногоуравненияy′ = −ay условиеустойчивостинеяв-
        h             k      k+1              k                                        нойсхемыпринимаетвид1=(1+ha)<1,т.е.выполненопривсехh,поэтому
Длякачественногосовпаденияповедениярешенийразностнойидифферен-                                           величина h выбирается только с учетом точности аппроксимации.
циальной задач необходимо, чтобы |1 − ha| ≤ 1. Соответствующее множе-                                        Метод Лебедева решения жестких систем. Для решения систе-
ство шагов h называется областью устойчивости разностной схемы, а мак-                                   мы обыкновенных дифференциальных уравнений y′(x) = −Ay, y ∈ Rn
симально допустимый шаг hcou = 2=a  числом Куранта. Если h > hcou, то                                   рассмотрим явную схему с переменными шагами. Тогда за N шагов будем
Раздел 2.                                                                             45                   46                                         Лекция 8. Уравнения второго порядка
иметь                                                                                                      будутсущественнобольшеединицы.Действительно,пустьeнормирован-
                        N                                                                ный собственный вектор матрицы A, отвечающий наибольшему собствен-
   y =P (A)y ; P (A)=Y(I−hA):=S; y                             =Sky :                               ному числу λ(A) = M. Найдем норму вектора y = (I − hiA)e для i = N.
    N      N      0      N                  i              kN         0                             Имеем
                       i=1

Лемма 7.2 ПустьсобственныефункцииоператораS образуют базис.То-                                                                M M                   1     −1      M1 π2 −1           N2
гда                                                                                                                  hN =      2 + 2 cosπ(1− 2N)             ∼ 2 24N2             ∼ M:
         lim kSkk ≤ const ⇔ |λ(S)| ≤ 1:                                                                                          2
        k→∞                                                                              Поэтому y = (I −h A)e ∼ (1− N M)e, т.е. kyk ∼ N2. Следовательно, для
                                                                                                                N               M
Доказательство. Напомним, что kSkk = sup kSkxk. Отсюда, разложив                                           больших значений N применение метода может привести как катастрофи-
                                 kxk=1                                                   ческому росту погрешности вычислений, так и к переполнению машинных
                                            n                                            разрядов. Для устранения данной проблемы необходимо переупорядочить
по базису из собственных векторов {e } вектор x = P α e , получим требу-
                          i                     i i                                      последовательность шагов {h1;h2;:::;hN}. На данный момент известны и
                                           i=1                                           строго обоснованы алгоритмы для N = 2p3q. Приведем без доказательства
емую оценку. Лемма доказана.
    Пусть sp(A) ∈ [0;M], и собственные функции оператора A образуют ба-                                    один из таких результатов для N = 2p, гарантирующий, что норма опе-
  n                                       N                                                         ратора перехода P (A) по модулю не превосходит единицы для каждого
зис в R . Найдем набор таких шагов {hi}i=1, что схема, оставаясь устойчи-                                                        n
вой,позволяетзаN шаговпроинтегрироватьзадачупоотрезкунаибольшей                                            n=1;2;:::;N.
                         QN                                                                                       M     M      (2i−1)   −1
длины. Так как λ(S) = P (λ(A)) =                  1−hλ(A) , то, с учетом леммы,                                 Пусть hN+1−i = (         + cos           π)   ;   i = 1;:::;N; т.е. нумерация
            N              i=1        i                                                                             2     2       2N
искомые значения {hi}N         равны обратным величинам корней такого поли-                                шагов ведется "от большего к меньшему".
         i=1
          Q
нома P (x) =        N (1−h x), что                                                                             Для N = 2 устойчивая последовательность имеет вид (2;1). Пусть для
 N           i=1       i                                                                                   p−1
                        PN              ′                                                N=2 последовательностьпостроена:(i1;i2;:::;i p−1), т.е. шаги берутся
max |P (x)| ≤ 1;              h =−P (0)→sup:                                                                                                          2
         N                i=1 i         N
          x∈[0;M]                                                                                   в следующем порядке: {hi ;hi ;:::;hi             }.
                                                                                                                        1   2         p−1
                                                      2x−M                                                     p                   2
Решением является многочлен Чебышёва, т.к. P (x) = T                              имеет                        Тогда для N = 2 последовательность определяется формулой:
                                        N          N     M
требуемыйвид, удовлетворяетусловиюустойчивостии имеет, согласно тео-                                           (2p +1−i1;i1;2p +1−i2;i2;:::;2p +1−i p−1;i p−1).
                                                                                                                                              2     2
реме Маркова, наибольшую производную в нуле. Следовательно, формула                                        Например: (3;2;4;1), (6;3;7;2;5;4;8;1). Таким образом, делается серия ша-
                               M     M      (2i−1)   −1 N                                гов по правилу "малый  большой", самый малый шаг выполняется пред-
для чебышёвских шагов найдена: {hi = ( 2 + 2 cos 2N π)                    }i=1. Вычис-
лим соответствующую длину отрезка интегрирования, т.е. значение P′ (0):                                    последним, а самым большой  последним.
                                                                N
           TN(x) = cosNθ; cosθ = x;
   T′ (x) = N sin(N arccosx) = NU            (x);
     N           sinarccosx              N−1                                               Лекция 8. Уравнения второго порядка
     (x+√ 2     N      √ 2    N                   √
          x −1) −(x− x −1)             N−1           2
   UN−1(x) =               √ 2              =Nx        +O( x −1);
               2 x −1
отсюда находим | d T 2x−M|              =| 2 T′ (x)|         = 2N2:                                      Рассмотрим следующую задачу:
   dx N      M     x=0      M N       x=−1      M
    Такимобразом,суммарнаядлинаотрезкаинтегрированиясN чебышёв-                                                                 y′′ = f(x;y;y′);     y(a) = ξ ; y′(b) = ξ :
       2N2                                                                                                                                  a             b
скимишагамиравна M .Максимальнодопустимыйпостоянныйшагявной
схемы равен hcou = 2 , поэтому суммарная длина отрезка интегрирования                                      Введениемновойнеизвестнойфункцииv(x) =y′(x)онаможетбытьсведена
      M
за N постоянныхшаговравна 2N,чтовN разменьше,чемсчебышёвскими                                              к системе уравнений первого порядка:
                  M
шагами.                                                                                                                                 v′ = f(x;y;v);     v(b) = ξ ;
    Важнойпроблемойвслучаечебышёвскихшаговявляетсяустойчивость                                                                                                      b
                                                                                                                      y′ = v;    y(a) = ξ :
метода по отношению к ошибкам округления. Дело в том, что условие                                                                                           a
Q
устойчивости k       N (I −h A)k ≤ 1 гарантированно выполняется за N ша-                                   Иесли b=a, то для ее решения можно применить методы, рассмотренные
   i=1       i
гов, хотядля большихiвеличинашагаhi и,следовательно,нормаkI−hiAk,                                          выше. В некоторых случаях данный прием оказывается полезным. Однако
Раздел 2.                                                                           47                   48                                         Лекция 8. Уравнения второго порядка
в общем случае методы, приспособленные к решению конкретного класса                                      Главный член погрешности на решении имеет вид: r                   = L (y) − f =
                                                                                                                                                       h       h    h     h
задач, оказываются более эффективны. Далее будем рассматривать задачи                                      2              4              2              4                h4
                                                                                        h y(4)(x ) + h y(6)(x )− h f(2)(x )− h f(4)(x ) = −                y(6)(x )+O(h6):
с правыми частями, не зависящими от y′: f(x;y;y′) = f(x;y); т.е. уравнения                                12       k    360       k     12       k    144       k        240       k
вида                                                                                                     Пример 8.4. Рассмотрим следующее уравнение
                  y′′ = f(x;y)                                    (1)
                                                                                                                   − k(x)y′ ′ +p(x)y = f(x);
с краевыми условиями, заданными на границе отрезка [0;1]. В данном слу-
                                                                                       гладкие коэффициенты которого удовлетворяют условиям 0 < k ≤ k(x) ≤
чае (по аналогии с задачей Коши для уравнения первого порядка) разност-                                                                                                             0
ной схемой на равномерной сетке x = x + kh, k ≥ 0 называется система                                     k ;    0 ≤ p(x) ≤ p : Тогда схема
                        k     0                                                          1                 1
разностных уравнений                                                                                               −1k(x         )yi+1 −yi −k(x          )yi −yi−1+p(x )y =f
    n              n                                                                                       i+1=2                  i−1=2                    i  i     i
1 Xa−iyk−i =Xb−ifk−i; k=n;n+1; :::                                (2)                              h                  h                      h
          h2                                                                                                                               2
  i=0             i=0                                                                  имеет порядок аппроксимации O(h ).
с известныминачальнымиусловиямиy ,y ,:::,y                  , где a   , b  не зависят                        Краевое условие для задачи (1) может быть задано на любом из концов
от h, a ;a 6= 0, и f       =f(x      ; y   ). 0  1      n−1        −i   −i                               отрезка в виде линейной комбинации функции и производной, т.н. краевое
 0  n          k−i        k−i   k−i                                                               условие третьего рода:
Теорема 8.1 Необходимые и достаточные условия аппроксимации на ре-                                                                           ay+by′ =c:
шении уравнения (1) разностной схемой (2) имеют вид                                                      Вэтом случае следует обратить внимание на способ его аппроксимации.
    n                   n                   n                 n                                       Аппроксимация граничных условий третьего рода. Пусть для
1 Xa−i=0; −1Xia−i=0; 1Xi2a−i=1; Xb−i=1:                                                           уравнения
      h2                    h                   2                                                                                            ′′
   i=0                 i=0                 i=0               i=0                                                                  −y +p(x)y =f(x)
Доказательство. Подставим решение y(x) в формулу разностной схемы,                                       задано граничное условие ay(0)+by′(0) = c. Построим для этого условия
для каждого слагаемого выпишем разложение в ряд Тейлора в точке x ,                                      конечно-разностнуюаппроксимациювторогопорядкаточностинарешении,
                                                                   k
приравняем нулю коэффициенты при h−2;h−1;h0 и, добавив условие нор-                                      используя значения функции y в точках x = 0 и x = h. Из формулы
                                                                                                                                           0           1
мировкиправойчасти,получимтребуемыесоотношения.Теоремадоказана.                                          Тейлора имеем
                                        ′′                                                                             2
    Рассмотрим разностные схемы для уранения y (x) = f(x).                                                   y(h) = y(0)+hy′(0)+ h y′′(0)+Oh3;
Пример 8.1. Естественная аппроксимация:                                                                  откуда следует                 2
            yk+1 −2yk +yk−1 = fk:                                                          y′(0) = y(h) −y(0) − h y′′(0)+Oh2:
                     h2                                                                                   h         2                    ′′
                                                                                       Из исходного уравнения получаем, что −y (0) = f(0)−p(0)y(0): Поэтому
                                                         2
Главныйчленпогрешностинарешенииравенr =L (y) −f = h y(4)(x )+                                                         y(h)−y(0)       h                              2
                                   h      h   h    h    12       k                     ay(0)+b                   +     f(0)−p(0)y(0)        =c+O h :Искомаяаппрок-
O(h4).                                                                                                                     h          2
                                                                                       симация имеет вид:
Пример 8.2. Схема                                                                                                  h                y1 −y0          h
      y    −2y +y                  h2                                                        a − 2 bp(0) y0 +b         h     =c−2bf(0):
       k+1      k     k−1 = f +       f′′(x )                                              Устойчивость разностных схем второго порядка. Вслучаезадачи
              h2               k   12      k
                                                                                       Кошипринято проверять более слабое определение α-устойчивости.
аппроксимирует уравнение на решении порядком O(h4).
Пример 8.3. Схема Нумерова:                                                                              Определение 8.1 Для задачи Коши y′′(x) = f(x) схема называется α -
                                                                                       устойчивой,есливсе корни соответствующего характеристическогомно-
                                                                                                  n
  yk+1 −2yk +yk−1 = fk+1 +10fk +fk−1 :                                                 гочлена P a−iµk−i однородного уравнения принадлежат единичному кругу
           h2                       12                                                           i=0
          Раздел 2.                                                                   49                 50                                    Лекция 8. Уравнения второго порядка
          и на границе круга нет кратных корней, за исключением µ = 1 кратно-                            Проверим, что (y(n);y(m)) = 0 при m 6= n. Рассмотрим оператор A как
                                                                                                       h                                             h
          сти 2.                                                                                         оператор, действующий на y ;:::;y        . В этом случае матрица A симмет-
                                                                                           T              1      N−1                            h
                                                                            рична A =A , следовательно,
  Отличие данного условия устойчивости от условия устойчивости для                                     h     h
          уравненияпервогопорядкаобусловленоболеевысокойстепеньюhвправой                                                (n)  (m)       (n)     (m)        (n)    (m)   (m)   (n)
                                                                                 0 = (A ϕ    ; ϕ   ) −(ϕ ;A ϕ         ) =(λ     −λ )(ϕ ;ϕ ) ;
      P                  P                                                                                h           h           h     h                            h
          части:    n  a y     =h2 n b f .
  i=0 −i k−i         i=0 −i k−i                   ′′                                         (m)   (n)             (m)    (n)
  Устойчивостькраевойзадачи.Пустьуравнениеy (x)=f(x)доопре-                                   т.е. (ϕ   ; ϕ  ) =0дляλ         6=λ .Ортогональность собственных векто-
                                                                                            h
          делено краевыми условиями на разных концах отрезка. Напомним опре-                                                        −1       −1
                                                                            ров доказана, поэтому kA     kh = λ    :
                                                                                                                min                       2              π
          деление устойчивости для линейных задач. Разностная схема A y = f
                                                  h h     h                    Получимоценкудляλ          =λ .Изнеравенстваsin|β| ≥        |β| при |β| ≤
          линейной задачи устойчива, если существуют C;h такие, что для произ-                                                     min     1                          π               2
                                  0                                         имеем
          вольныхA y(1;2) = f(1;2) выполняется оценка ky(1)−y(2)k ≤ Ckf(1)−f(2)k                                                 4     πh                          4
   h h       h                            h     h  h       h     h   h                                              2
                                                                                             λ =      sin     ≥4; λ       =λ       ≤    :
          при всех h ≤ h0 с константой C, не зависящей от h.                                                                1   h2      2          max     N−1    h2
                             −1
  Если матрица A не вырождена, то y = A          f . Отсюда получаем нера-
 h                     h     h  h                                                                                                               −1      1
          венство для нормы векторов:                                                                    Таким образом, верна не зависящая от h оценка для нормы kA            kh ≤ 4:
   (1)   (2)        −1      (1)   (2)                                       По определению это означает устойчивость схемы.
 ky   −y kh≤kA khkf −f kh:
   h     h          h      h      h
                       −1                                                         Энергетический метод исследования устойчивости. Рассмот-
          Следовательно, можно выбрать C ≥ kA         kh.
                       h                                                    рим энергетический метод исследования устойчивости на примере диффе-
  Метод собственных функций. Исследуем устойчивость разностной
          схемы                                                                                          ренциальной задачи
 −yk+1−2yk+yk−1 =f ; y =y =0 ⇔ A y =f                                                               −y′′ +p(x)y = f(x);     y(0) = y(1) = 0;   p(x) ≥ 0:
h2             k     0    N              h h     h
                                                                            Умножимуравнение на y(x), и результат проинтегрируем по отрезку [0;1]:
                                    P
          в сеточной интегральной норме ky k2 = (y ;y ) =           N−1y2h, эквивален-
                 h h      h   h h      k=1  k
        1                                                                                          1              1          1
          тойнормеky(x)k2         =Ry2(x)dxисходнойзадачи.Дляэтогооценимнор-                                                  Z      ′′      Z    2      Z
         L2(0;1)                                                                                               (−y )ydx+      py dx =     fydx:
        0
          −1                                                                                                 0              0          0
          му оператора kA     kh, где
          h
                      −1     −1                                             После интегрирования по частям получим интегральное тождество
                   (A y ;A y )
      −1 2            h  h   h   h h                                                                1           1           1
    kA kh= sup                      :                                                              Z           Z          Z
      h                (y ;y )
              yh6=0      h   h h                                                                       ′ 2          2
                                                                                                     (y ) dx +    py dx =    fydx:
          Пусть известны собственные числа λ матрицы A , а собственные векто-
                    n             h                                                                0           0           0
          ра y(n) ортонормальны: (y(n);y(m)) = δn. Тогда собственные вектора об-                         Далее нам потребуется неравенство, связывающее интегралы от квадратов
   k                                h     m
          разуют базис, и произвольный вектор yk можно представить в виде yk =                           функции и ее производной. Из равенства
          P         (n)                    P             (n)
 N−1                     −1        N−1 −1                  −1              −1
      cny   . С учетомA    yk =        λ cny     имеемkA kh =maxn|λ |.                                                               x0
 n=1     k               h         n=1  n     k                            n
  Ранее было получено, что решение разностной задачи на собственные                                                         y(x ) = Z y′(x)dx
          значения                                                                                                                        0
    y    −2y +y                                                                                                              0
     k+1      k    k−1 = −λyk;     y0 = yN = 0;   h=1=N                                следует, что
 h2
          имеет вид                                                                                                         x0      x0           x0               1
                                                                                         2     Z 2         Z   ′ 2       Z    ′ 2     Z   ′ 2
                                                                                                                 
                                                                                     y(x )   ≤      1 dx       (y ) dx   ≤ (y) dx≤ (y) dx:
   (n)                     4     2 πnh                                                             0
  y    =sinπnkh;     λ =      sin      ;  n=1;::: ;N −1:
   k                  n    h2       2                                                                       0           0             0            0
          Раздел 2.                                                                      51                  52                   Лекция 9. Методы решения уравнений второго порядка
          Послеинтегрированияпоx поотрезку[0;1]обеихчастейполучимискомое                                     Докажем сеточный аналог неравенства для функции и ее производной в
           0
          неравенство                                                                                        точках k = 1;:::;N −1.
                                                                                                          k
  1                 1         1              1         1                                                           X
 Z       2       Z   ′ 2   Z             Z   2      Z    ′ 2                                Из тождества yk =        (yi − yi−1) следует

    y(x ) dx ≤       (y ) dx    dx    или     y dx ≤     (y ) dx:                                                   i=1
        0     0                   0
 0                 0         0              0         0                                                       k     !   k                !       N
                                                                                             2     X2 X                      2       X              2
          Врезультате имеем                                                                                             yk ≤        1   ·      (yi − yi−1)   ≤N (yi−yi−1) :
                                                                                                   i=1        i=1                    i=1
     1          1            1           1            1          1      
    Z   2      Z   ′ 2     Z     2     Z           1 Z    2     Z   2                           Отсюда получается требуемая оценка
y dx ≤    (y ) dx +    py dx =     fydx≤ 2        f dx+      y dx   ;
    0          0            0          0               0         0                                        N−1           N                      N                N−1
                                                                                        X 2         2 X             2    1 X              2   X 2
                                           1                                                yk ≤ N       (yi − yi−1) ≤    2    (yi − yi−1) +       piyi =
                                          Z   2                                         k=1           i=1               h i=1                  i=1
          откуда                      kyk   ≤kfk ; где kyk2 =             y dx:                                                                        !
            L2        L2             L2                                                   N−1            N−1       N−1
                                          0                                             = Xfiyi ≤ 1       Xf2+Xy2 :
                                                                                                      2        i         i
          Это  априорная оценка для решения, означающая устойчивость диффе-                                            i=1            i=1       i=1
          ренциальной задачи по правой части.
  Докажемэнергетическим методом устойчивостьстандартной разностной                                Таким образом,
                                                                                                   N−1       N−1          N−1        N−1
          схемы                                                                                                                 Xy2≤Xf2,т.е. Xy2h≤ Xf2h.
                                                                                                         i         i           i          i
     −yk+1−2yk+yk−1 +pkyk =fk; k =1;:::;N −1;                 y0 = yN = 0:                                            i=1       i=1         i=1        i=1
        h2                                                                                 Отсюда следует, что априорная оценка для решения разностной задачи в
                                                                                                   N−1
                                                                                                   P 2 1=2
          Умножим на yk и просуммируем от 1 до (N −1). Так как y0 = yN = 0, то:                              норме kykL2;h = (i=1 yih)      , согласованной с L2(0;1), имеет вид kykL2;h ≤
N−1                      N−1                                                               kfkL2;h: Устойчивость доказана. И т.к. схема имеет второй порядок аппрок-
  − 1 X(yk+1−yk)yk+ 1 X(yk−yk−1)yk =                                                              симации, то согласно теореме Филиппова верна
    h2                       h2
 k=1                     k=1
    N                        N−1                       N                                   Теорема 8.2 Решение рассмотренной разностной схемы сходится к ре-
1 X                        1 X                     1 X               2                                                                           2
  =−h2       (yk −yk−1)yk−1 + h2        (yk −yk−1)yk = h2       (yk −yk−1) :                      шению дифференциальной задачи с порядком O(h ) в норме L2;h, т.е.
   k=2                       k=1                      k=1
                                                                                                             k(y) −y k       ≤ch2:
          Отсюда следует конечномерный аналог интегрального тождества:                                                                        h    h L2;h
    N                  N−1         N−1
 1 X               2   X 2 X
h2     (yk −yk−1) +        pkyk =      fkyk:                                     Лекция9.Методырешенияуравненийвторого
   k=1                 k=1         k=1
          Введем следующие обозначения:                                                                           порядка
                       N                N−1
      ∇y =y −y         ; (u;v] = Xu v ; (u;v) = X u v :
         k    k    k−1                i i                i i                               Рассмотримэффективныечисленныеалгоритмырешениясистемлинейных
                      i=1                i=1
                                                                                алгебраических уравнений, возникающих, например, при аппроксимации
          Тогда конечно-разностное интегральное тождество принимает вид:                                     обыкновенных дифференциальных уравнений второго порядка.
       1                                                                         Метод прогонки. Пусть требуется найти решение системы уравнений
          (∇y;∇y]+(py;y)=(f;y):                                                                                  T                                              T
       h2                                                                       Ay=f;гдеy=(y0;y1;:::;yN) векторнеизвестных,f =(f0;f1;:::;fN)
Раздел 2.                                                                                                                                       53                                  54                                   Лекция 9. Методы решения уравнений второго порядка
заданный вектор правых частей, A  квадратная (N +1)×(N +1) мат-                                                                                                                   Исключение из этой системы yN−1 приводит к формуле для yN:
рица:
                                                                                                                                                                                                                                            fN +aNβN
        c               −b          0          0          : : :     0                0                 0                0                                                                                                                 yN = c −a α :
    0              0                                                                                                                                                                                                                          N          N N
        −a1 c1                      −b1 0                 : : :     0                0                 0                0              
                                                                                                                                                                                  Формально отметим, что yN = βN+1. Вывод формул закончен. Сформули-
        0               −a2 c2                 −b2 ::: 0                             0                 0                0              
                                                                                                                                                                                  руем алгоритм в целом.
        :::             : : :       : : :      : : :      : : :     : : :            : : :             : : :            : : :          :
                                                                                                                                                                                        Для решения системы (1) сначала рекуррентно вычисляются прогоноч-
        0               0           0          0          : : :     −aN−2 cN−2                         −bN−2 0                         
                                                                                                                                                                                  ные коэффициенты α ;β :
                                                                                                                                                                                                                   k      k
        0               0           0          0          : : :     0                −aN−1 cN−1                         −bN−1 
  0           0           0          0          : : :     0                0                 −aN              cN                                                                                                   α =b =c ; α                          =           bk          ;
                                                                                                                                                                                                                      1        0     0          k+1          c −a α
Перепишем задачу следующим образом:                                                                                                                                                                                                                                     fk +akβk
                                                                                                                                                                                                                   β =f =c ; β                         = k              k k ;
                                                                                                                                                                                                                      1        0     0          k+1          c −a α
                              c y −b y =f ;                                              k = 0;                                                                                                                                                               k         k k
                                0 0          0 1           0
                 −akyk−1 +ckyk −bkyk+1 = fk; 1 ≤ k ≤ N −1;                                                                          (1)                                  где k последовательно принимает значения 1;2;:::;N −1.
                       −aNyN−1+cNyN =fN;                                                k = N :                                                                                Затем вычисляется yN:
Основная идея метода состоит в представлении решения в виде                                                                                                                                                                                 y     = fN +aNβN :
                                                                                                                                                                                                                                   N        c     −a α
                                                                                                                                                                                                                                              N          N N
                y =α               y         +β           ;      k = N −1;N −2;:::;0;                                               (2)
                  k          k+1 k+1               k+1                                                                                                                   И,наконец,рекуррентноопределяютсяостальныекомпонентывекторанеиз-
для которого значения α ;β и y вычисляются по коэффициентам исход-                                                                                                                  вестных:
                                       k     k         k
                                                                                                                                                                                                   y =α               y         +β            ;     k = N −1;N −2;:::;0:
ной системы и правой части.                                                                                                                                                                                     k          k+1 k+1               k+1
       Из первого уравнения (1) следует:                                                                                                                                            Полученные соотношения называют формулами правой прогонки.
                      y =α y +β ; α =b =c ; β =f =c :
                         0         1 1          1           1         0    0         1        0     0                                                                    Теорема 9.1 (Достаточные условия корректности и устойчивости ме-
                                                                                                                                                                         тода прогонки). Пусть коэффициенты системы (1) действительны и удо-
Найдемпоследующиекоэффициентывравенствеy =α                                                                          y        +β          . Для
                                                                                         k         k+1 k+1               k+1                                             влетворяют условиям: c0;cN, ak;ck;bk при k = 1;2;:::;N −1 отличны от
этого подставим уже найденную формулу y                                                       =α y +β вуравнение из
(1):                                                                                   k−1            k k          k                                                                нуля и
                                              y         =α y +β ;                                                                                                                                            |ck| ≥ |ak| + |bk|;                   k = 1;2;:::;N −1;
                                                k−1            k k           k                                                                                                                               |c0| ≥ |b0|;             |cN| ≥ |aN|;
                                  −akyk−1 +ckyk −bkyk+1 = fk:                                                                                                            причем хотя бы одно из неравенств является строгим. Тогда для формул
Отсюда имеем                                                                                                                                                                        метода прогонки справедливы неравенства:
                           (−a α +c )y −α β −b y                                         =f ;                                                                                                           c −a α 6=0; |α |≤1; k=1;2;:::;N;
                                  k k           k     k         k k           k k+1             k                                                                                                         k        k k                       k
                          α          =           bk          ; β          = fk +akβk :
                             k+1          c −a α                   k+1          c −a α                                                                                   гарантирующие корректность и устойчивость метода.
                                            k        k k                         k         k k
Этот процесс закончится, когда мы придем к последнему уравнению систе-                                                                                                                    Доказательство проведем методом индукции.
мы(1), содержащему только два значения неизвестных:                                                                                                                                 База: |α | ≤ 1. Шаг: Пусть |α | ≤ 1.
                                                                                                                                                                                        1                                         k
                                                                                                                                                                         Покажем, что |c −α a | > 0 и |α                                          | ≤ 1. Действительно,
                                                                                                                                                                                                        k         k k                      k+1
                                            y         =α y +β ;
                                              N−1             N N             N                                                                                                                   |c    −α a |≥|c |−|α ||a | ≥ |c |−|a | ≥ |b | > 0:
                                        −aNyN−1+cNyN =fN:                                                                                                                                            k         k k             k            k      k           k           k           k
 Раздел 2.                                                                                      55                      56                      Лекция 9. Методы решения уравнений второго порядка
 Отсюда следует, что                                                                                                    Пример 9.3. Для задачи −y′′ = f, y′(0) = a;y(1) = b при рассмотренных
                |α     | =       |bk|      ≤1:                                                        аппроксимациях метод прогонки применим.
                   k+1      |c  −α a |                                                                    Метод стрельбы. Идея этого подхода выглядит следующим образом.
                              k      k k
 Отметим, что если при некотором k выполняется |α | < 1, тогда |α | < 1                                                 Для решения системы уравнений
                              0                      k                    j
                                                      0
 при всех j > k .
  0
                                                                                                                    yk+1 −2yk +yk−1
      Рассмотрим |c −α a | ≥|c |−|α ||a |. По условию:                                                                             −                          =fk; ⇔Lhyh =fh ; y0 =a;yN =b
      N      N N          N        N N                                                                                        h2
      либо |α | < 1, если |c | > |b | или |c          | > |a    | + |b  |,
        N                  0      0          k        k        k
                                   0        0        0                                                рассмотрим две вспомогательные задачи
      либо |cN| > |aN|,
 следовательно, |c        −α a |>0.Теорема доказана.
      N      N N                                                                                                                     L u =f ; u =a; u =u¯ ;
 Пример 9.1. Для задачи −y′′ = f, y(0) = a;y(1) = b разностная аппрок-                                                                                  h h       h    0         1      1
                                                                                                                                     L v =0; v =0; v =v¯ ;
 симация имеет вид                                                                                                                                      h h          0         1      1
                                                                                                    и построим решение y = u +Cv , определив коэффициент C из условия
                                                                                                                                  h      h        h
           2       −1 0         0      0     : : : 0     y1                                                    y   =b.Формальнозначенияu ,v могутбытьпроизвольными,однако,для
                                                                                                       N                                     1   1
                                                  y2        
           −1 2           −1 0         : : : 0                                                               повышения устойчивости схемы разумно выбрать u −u = O(h), v −v =
                                                                                                                                                                         1     0             1     0
                                                         :           
       1  0        −1 2         −1 0         : : : 0                                                         O(h) .
                                                         :           =f;
      h2  :        :      :     :      :     :     :                                                             МетодФурье(базисныхфункций).Пустьтребуетсянайтирешение
                                                         :                                                                                                              M
           0              : : :        −1 2        −1                                                        системы линейных уравнений Ay = b, y ∈ R                      при условии, что известны
   0            : : :        0     −1 2           yN−2                                              все собственные вектора и собственные числа матрицы A:
                                                     yN−1
                                                                                                                                    Ay(n) = λ y(n); n = 1;:::;M;
  a                              b T                                                                                                             n
 где f = (f1 + h2;f2;:::;fN−2;fN−1 + h2) .
      Вданном случае мы исключили известные значения y ;y . Метод про-                                                  и y(n) образуют ортонормированный базис в пространстве RM.
                                                           0  N
 гонки устойчив.                                                                                                            Основная идея метода состоит в формальном разложении решения y по
                       ′′        ′           ′                                                        собственным векторам y = PM cny(n); определении коэффициентов cn в
 Пример 9.2. Для задачи −y =f, y (0) = a;y (1) = b разностная аппрок-                                                                                          n=1
 симация имеет вид                                                                                                      данном представлении и последующем восстановлении вектора y.
                                                                                                          Таккакпроблеманахождениясобственныхвекторовисобственныхзна-
           2       −2 0         0      0     : : : 0     y0                                                  чений существенно сложнее решения системы линейных уравнений, то дан-
                                                  y1                                                ный метод позволяет эффективно находить вектор y, если все собственные
           −1 2           −1 0         : : : 0                       
                                                         :                                                   вектора и собственные числа заданы аналитически, и система собственных
       1  0        −1 2         −1 0         : : : 0                 
                                                         :           =f;                                     векторовобразуетв пространстверешенийортонормированныйбазисотно-
      h2  :        :      :     :      :     :     :                                                                                                                          (n)    (m)         n
                                                         :                                                   сительно некоторого скалярного произведения: (y                      ; y    )  = δ . В этом
                                                                                                                                                                                   h      m
           0              : : :        −1 2        −1                
   0            : : :        0     −2 2           yN−1                                              случае коэффициентыcm могутбытьнайдены по явной формуле. Действи-
                                                     yN                                               тельно,
                                                                                                                               M                            M
 2a                          2b T                                                                                          A(Xc y(n))=b ⇒ Xc λ y(n)=b:
 где f = (f0 −        ; f1; : : : ; fN−1; fN −    ) .                                                                                                 n                             n n
  h                           h                                                                                               n=1                           n=1
      Аппроксимация, например, левого краевого условия получена следую-
 щимобразом:y(h)=y(0)+hy′(0)+h2y′′(0)+O(h3),и изуравнениянаходим                                                        Умножим данное равенство скалярно на y(m) для m = 1;:::;M. С учетом
     ′′                                         2                                                                       ортонормированности базиса получим
 −y (0) = f(0).
      Вданном случае из теоремы не следует корректность метода прогонки.                                                            M
 Но и задача некорректна, т.к. если y решение системы, то y +const также                                                          (Xλ c y(n);y(m)) =(b;y(m))                    ⇒ c λ =(b;y(m)) :
 решение.                                                                                                                                n n               h               h            m m                 h
                                                                                                                 n=1
   Раздел 2.                                                                                                      57                         58                           Лекция 9. Методы решения уравнений второго порядка
                                                                  (m)                                                                            N−1
   Отсюда имеем c              =d =λ , где величины d = (b;y                             )   являются коэф-                                                          P (m) (n)              h (m) (n)         h (m) (n)
          m       m m                               m                   h                                                  (y(m);y(n)) =                y     y     h+ y y + y y :
                                                M                                                                                          h             k      k         2 0       0       2 N       N
   фициентами в разложении вектора b = P d y(m).                                                                                                                    k=1
                                                      m                                                                         Для доказательства ортогональности собственных векторов покажем,
                                              m=1                                                                                                                                                                            T
   Пример 9.4. Выписать алгоритм решения системы                                                                                             что оператор A, действующий на векторах (y0;y1;:::;yN−1;yN) , симмет-
                                                                                                                           ричен относительно выбранного скалярного произведения. Действительно,
        y      −2y +y                                                                                                                                         N−1 N                         N                       N
     − k+1            k      k−1 = bk; k = 1;:::;N −1; y0 = yN = 0; h = 1=N                                                                                   XX                        h X                    hX                            ˜
          2                                                                                                                     (Au;v) =h                      a u v +               a u v +                 a    u v     =h(Au;v);
        h                                                                                                                                 h                     ij   j i     2         0j j 0        2        Nj j N
                                                                                                                                                    i=1 j=0                     j=0                    j=0
   методом Фурье. Для данной задачи собственные векторы и собственные                                                                                   1                 1
   числа могут быть найдены аналитически                                                                                                          где 2a0j = a˜0j, 2aNj = a˜Nj для ∀j; aij = a˜ij иначе.
                                                                                                                                                        T
                                                                                                                                               ˜      ˜
        √                                                                                                                  Но матрица A = A симметрична, следовательно,
          (n)                                       4      2πnh                                                                                               ˜                  ˜            ˜
        y      = 2sin(πnkh);               λ =         sin             ; n = 1;:::;N −1:                                                   (Au;v) =h(Au;v)=h(u;Av)=h(Av;u)=(Av;u) =(u;Av) :
          k                                 n      h2            2                                                                                   h                                                                 h               h
                                                                                                                           Ортонормальность собственных векторов проверяется аналогично преды-
   (n)                                                                                                                                                                (0)            (0)
   При этом y             ортонормированны относительно скалярного произведения                                                              дущему примеру. Так как λ                       = 0, y         ≡ 1, то необходимым и достаточ-
       N−1                                                                                                                 нымусловиемкорректностиисходнойсистемы уравнений является условие
   (y(n);y(m)) = P y(n)y(m)h.
 h             k     k                                                                                                     (b;1) = 0.
        k=1                                                                                                                        h
 Ортогональностьследует из симметричности оператора A, действующе-                                                                         Отметим, что для рассмотренных примеров нахождение коэффициен-
                                                                                                                           тов d       и восстановление решения y можно существенно ускорить за счет
   го на y1;:::;yN−1. Проверим условие ортонормальности:                                                                                             m                                              k
                                                                                                                           арифметических свойств y(n) при помощи так называемого быстрого пре-
                              N−1                     N−1                                                                  образования Фурье.
         (n)    (n)           X (n) 2                 X 2
     (y      ; y    )   =h         (y     ) =2h             sin (πnkh) =
                     h                k
                              k=1                     k=1
      N−1                                                    N−1
=hX(1−cos(2πnkh))=(N−1)h−hXcos(2πnkh);
       k=1                                                   k=1
      N−1                             N−1
       Pcos(2πnkh)=Re P e(i2πnhk) =
       k=1                            k=1
                                                                   q −qN
      =Re(q+:::+qN−1)(1−q)=(1−q)=Re 1−q :
   ТаккакqN =cos2πNhn+isin2πNhn=1,hN =1,то(y(n);y(n)) =Nh=1.
                                                                                 h
   Пример 9.5. Для задачи
     −yk+1−2yk+yk−1 =bk; k =1;:::;N −1;
                   h2
     −2(y −y )=b ; 2 (y −y                             ) = b ; h = 1=N
        h2     1      0       0    h2    N       N−1          N
   собственныевекторы,собственныечислаисоответствующеескалярноепро-
   изведение имеют вид
     (0)          (n)     √                                                (N)
   yk    =1;yk = 2cos(πnkh); n=1;:::;N −1;yk                                    =cos(πNkh);
     (0)           (n)       4       πnh
   λ      =0; λ         = h2sin( 2 );n = 1;:::;N;
                                                                                             60                                      Лекция 10 Векторные и матричные нормы
    3. Линейная алгебра                                                                      Отсюда для произвольного вектора x получаем
                                                                                                                                                                      X 2
                                                                                                         minλ ·(x;x) ≤ (Cx;x) ≤ maxλ ·(x;x);                (x;x) =       α :
   Лекция 10. Векторные и матричные нормы                                                                                   i    i                          i    i                            i
                                                                                                                                                                       i
                                                                                             Поскольку все λ > 0, полученное неравенство означает эквивалентность
                                                 T                                                                i
 Определение 10.1 Нормой вектора x = (x ;:::;x ) называется функ-
                                      1       n                                              евклидовой норме kxk с постоянными
 ционал, обозначаемый kxk и удовлетворяющий следующим условиям:                                                                            2
                                                                                                                               q                  q
                                                                                                                         c = minλ; c = maxλ:
        kxk > 0; если x 6= 0;          k0k = 0;                                                                           1        i    i     2        i    i
        kαxk = |α|kxk;                                                                       Определение 10.3 Нормой матрицы A называется функционал, обозна-
        kx+yk≤kxk+kyk:                                                                       чаемый kAk и удовлетворяющий следующим условиям:
     Наиболее употребительны следующие нормы:
                                          v                                                                            kAk>0; если A6=0; k0k=0;
                        n                 un
                       X                  uX 2 p                                                                       kαAk=|α|kAk;
  kxk     = max |x |; kxk =           |x |; kxk = t         x = (x;x):
       ∞ 1≤i≤n i             1           i      2             i                                                                   kA+Bk≤kAk+kBk;
                       i=1                   i=1
 Определение 10.2 Нормыk·kI иk·kII называютсяэквивалентными,если                                                                         kACk≤kAkkCk:
 для всех x ∈ Rn с одними и теми же положительными постоянными c1

                                                                                                                                              n        1=2
 и c2 справедливы неравенства                                                                                  Пример10.2. ФункционалN(A)=                     P a2          являетсяматричнойнор-
                                                                                                                                                   ij
             c kxk ≤kxk ≤c kxk :                                                                                                            i;j=1
              1     II        I    2     II                                                  мой. Норму N(A) называют нормой Фробениуса (нормой Шура, евклидовой
                     √                                                                       матричной нормой) и обозначают kAkF.
 Пример 10.1. kxk∞ ≤kxk2 ≤ nkxk∞.                                                                              Пример 10.3. Функционал η(A) = max |a | не является нормой в про-
 Теорема 10.1 Пусть C  симметричная положительно определенная                                                                                                    i;j  ij
                   p                                                                         странстве матриц. Свойства 1-3 определения матричной нормы очевидно
 матрица. Тогда функционал              (Cx;x) = kxkC задает норму вектора x,                                  выполнены. Рассмотрим матрицы A = B : aij = bij = 1, для которых
 и верна следующая оценка                                                                                      имеют место соотношения η(AB) = n; η(A) = η(B) = 1, противоречащие
           p                           p                                                     четвертому свойству матричной нормы: η(AB) ≤ η(A)η(B). Отметим, что
      min     λ kxk ≤kxk ≤max λ kxk ;
        i      i    2        C      i       i    2                                           функционал M(A)=nη(A) является матричной нормой.
 где {λ }  собственные числа матрицы C.
 i                                                                                                      Лемма 10.1 Пусть задана некоторая векторная норма k·k . Тогда мат-
     Доказательство. ПерваячастьтеоремыследуетизпредставленияC =                                                                                                                          v
                                             √          √                                    ричную норму можно определить как операторную
 QTD1=2QQTD1=2Q, здесь QTQ = I, D1=2 = diag{ λ ;:::; λ }. Найдем
                                                 1          n
 константы эквивалентности с нормой k · k2. Пусть e1;:::;en  ортонор-                                                                kAkv = sup kAxkv = sup kAxkv:
 мированная система собственных векторов матрицы C (т.е. (ei;ej) = δij), а                                                                      kxk 6=0 kxkv        kxk =1
                                                                                                                                 v                   v
 λ ;:::;λ  соответствующиесобственныезначения. Любойвекторx пред-
  1        n
       n
 ставим в виде x = P α e . Поэтому,                                                                                Доказательство сводится к элементарной проверке свойств 1-4 мат-
           i i                                                                               ричной нормы.
     i=1
                n             n       !      n                                                   Построенная матричная норма называется подчиненной соответствую-
                X            X              X 2                                              щей векторной норме k·kv. Отметим, что для произвольной подчиненной
  (Cx;x) =           λ α e ;     α e     =      λ α :
                      i  i i       i i            i i                                        матричной нормы k·k и единичной матрицы I имеем kIk = 1.
                 i=1         i=1            i=1                                                                          v                                           v
                           59
   Раздел 3.                                                                                                      61                         62                                               Лекция 10 Векторные и матричные нормы
   Теорема 10.2 Матричныенормы,подчиненныевекторнымнормамk·k∞,                                                                               Следствие 10.1 Для любого собственного значения λ(A) невырожденной
                                                                                                                                                                                    −1
   k·k1 и k·k2, имеют вид                                                                                                                    матрицы A справедлива оценка 1=kA                            k ≤ |λ(A)|:
              n                              n                                                                                  Элементы теории возмущений. Рассмотрим систему линейных ал-
            X                               X                        q               T
   kAk =max                 |aij|; kAk1 = max               |aij|; kAk2 =          maxλ (A A):                                        гебраических уравнений Ax = b с квадратной невырожденной матрицей A
         ∞        i                               j                                  i     i
            j=1                             i=1                                                                            и точным решением x. В результате численного решения с конечной раз-
                                                                                                                                                                                                                    ˜      ˜       ˜
 Доказательство. Получим оценку сверху для величины kAxk :                                                                            рядностью вместо x получается приближенное решение x: Ax = b. При
                                                                                       ∞                                                                    ˜                                                                              ˜
                                                                                                                           этом вектор z = x −x называется вектором ошибки, а вектор r = b −Ax
                                                                                                                       называется вектором невязки.

                          P                         P
   kAxk =max a x ≤max                                 |a | max|x |          ≤
           ∞         i    j    ij  j        i      j     ij     j      j                                                      Найдем насколько приближенное решение отличается от точного. Из
                                                                                                                         неравенств
                         ≤max P|a | kxk :                                                                                                                    ˜           −1           ˜
                               i       j    ij          ∞                                                                                            kx−xk≤kA kkb−bk; kAkkxk≥kbk
                                                                                                                           получаем, что для относительной ошибки верна оценка
   Покажем,чтоэтаоценкадостигается.Пустьмаксимумпоiимеетместопри
                                                                                                                                                 ˜                                ˜                                   ˜
   i = l; тогда возьмем x = sign(al1);sign(al2), :::;sign(aln) . Имеем kxk∞ =                                                                                kx−xk                      −1 kb−bk                         −1 kb−Axk
                                                                                 n                                                             kxk      ≤kAkkA k kbk =kAkkA k                                     kbk        :
   1 и точные равенства во всей цепочке выше, т.е. kAk∞ = max X|aij|: Ана-                                                                                                  −1
                                                                          i    j=1                                              Величина kAkkA k называется числом обусловленности матрицы A и
                                               n                                                                           часто обозначается cond(A). Для вырожденных матриц cond(A) = ∞. Кон-
   логично показывается, что kAk1 = maxX|aij|:                                                                                               кретное значение cond(A) зависит от выбора матричной нормы, однако, в
                                         j                                                                                 силу их эквивалентности при практических оценках этим различием обыч-
                                              i=1
 Найдем kAk2. По определению матричной нормы, подчиненной евкли-                                                                      но можно пренебречь. Если cond(A) велико, то матрицу называют плохо
   довой векторной норме, имеем                                                                                                              обусловленной.
                                     s                          s T                                                        Пример 10.4. Покажем, что если матрица A плохо обусловлена, то ма-
kAk2 = sup kAxk2 = sup                   (Ax;Ax) =sup               (A Ax;x):                                              лая невязка не может гарантировать малость относительной ошибки. Бо-
            x6=0 kxk2           x6=0       (x;x)           x6=0        (x;x)                                               лее того, может оказаться так, что достаточно точное решение будет иметь
                                                                                                                           большую невязку. Пусть
          T                                      T
   Матрица C = A A  симметричная, и (A Ax;x) = (Ax;Ax) ≥ 0, следова-                                                                                                      ε 0           !  1 !              ε !
   тельно, все λ(C) ≥ 0. Рассуждая далее как и в предыдущей теореме, полу-                                                                                                          −1                 =              ;    ε ≪1:
   чим sup (Cx;x) ≤ maxλ (C); а равенство достигается на соответствующем                                                                                                     0 ε                ε              1
          (x;x)            i     i
   x6=0                                                                                                                                                               T
                                            q                                                                                          ˜
                                                             T                                                             Вектор x = (1+1;ε) , который не является близким к x, дает маленькую
   собственном векторе. Поэтому kAk =                            maxλ (A A):                                                                                                                                   √
                                      2                 i                                                                                                 T                ˜                       T
                                                  i                                                                        невязку r = (−ε;0) . Вектор x = (1;ε +                               ε)     достаточно близок к x в
 Следуетотметитьважныйчастныйслучайсимметричнойматрицы:если                                                                                                                                                ˜
                                                                                                                           смысле относительной погрешности, однако x дает большую невязку r =
      T                                                                                                                                          √ T
   A=A ,тоkAk =max|λ(A)|:
         2       i      i                                                                                                  (0;−1= ε) .
   Теорема 10.3 Модуль любого собственного значения матрицы не больше                                                                        Лемма 10.2 ДлялюбойматрицыAимеемcond(αA)=cond(A),cond(A)≥
                                                                                                                           1 и cond (Q) = 1 для ортогональной матрицы Q.
   любой ее нормы: |λ(A)| ≤ kAk.                                                                                                                          2
 Доказательство. Зафиксируем произвольный собственный вектор x                                                                             Доказательство.Первоеутверждениеследуетизсвойствобратноймат-
   матрицы A и построим матрицу X, столбцами которой являются вектора                                                                        рицы и определения матричной нормы. Далее, так как I = I · I, kIk ≤
                                                                                                                                                −1
   x. Получим равенство λX = AX. Отсюда следует |λ|kXk ≤ kAkkXk; что                                                                         kIkkIk, I = A            A, то
                                                                                                                                                                       −1               −1
   порождает искомый ответ.                                                                                                                                           1 ≤ kIk = kA           Ak≤kA kkAk=cond(A):
Раздел 3.                                                                                                                                       63                                  64                                                                Лекция 11. Точные методы решения слау
Далее, имеем:                                                                                                                                                                       действий. Данная оценка, а также необходимость хранения всех элемен-
                                                                                                                                                                         тов матрицы в памяти машины, накладывают существенное ограничение
                                                        1=2                           T             1=2
           kQk = sup (Qx;Qx)                                   = sup (Q Qx;x)                              =1:                                                           на область применимости точных методов. Однако, для решения задач не
                   2                          kxk                                        kxk                                                                             очень большой размерности (n ∼ 103÷4) в большинстве случаев разумно
                           kxk 6=0                   2              kxk 6=0                     2
                                2                                        2
                                                                                                                                                                         применение точных алгоритмов. Отметим, что при численном решении за-
Аналогично находим, что kQ−1k2 = kQTk2 = 1.                                                                                                                                         дач математической физики часто требуется обращать матрицы блочно-
Пример 10.5. Покажем, что если определитель матрицы мал, то матри-                                                                                                                  диагонального вида. В этом случае удается построить точные методы с
ца не обязательно плохо обусловлена, а определитель плохо обусловленной                                                                                                             меньшим по порядку числом арифметических действий. К таким алгорит-
матрицы может равняться 1.                                                                                                                                                          мам относятся метод прогонки, стрельбы, Фурье (базисных функций).
       Пусть дана диагональная матрица A = εI, где ε > 0  малое число                                                                                                                    Метод исключения Гаусса является наиболее известным из точных
и I  единичная матрица. Определитель det(A) = εn весьма мал, тогда как                                                                                                             методов, применяемых для задач с матрицами общего вида. В предположе-
матрица A хорошо обусловлена, поскольку                                                                                                                                             нии, что коэффициент a11 6= 0, уравнения исходной системы заменяются на
                                                                                                                                                                         следующие
                                                      −1                             −1       −1                                                                                                n
            cond (A) = kAk kA k =εkIk ε kI k =1:                                                                                                                                               X
                     ∞                       ∞               ∞                 ∞                     ∞                                                                                               a1j               b1
                                                                                                                                                                               
                                                                                                                                                                                x +                        x =              ;
                                                                                                                                                                                       1                       j
                                                                                                                                                                             
   ПустьA=                    ε      0           ;    тогда det(A) = 1;                      cond (A) = ε−2:                                                                                  j=2 a11                 a11
                                       −1                                                             2                                                                                n
                              0      ε                                                                                                                                          X                            a1j                                b1
                                                                                                                                                                               
                                                                                                                                                                                              a x −                 a x           =b −                a ;        i = 2;:::;n;
                                                                                                                                                                                                ij    j               i1 j              i               i1
Пример 10.6. Пусть                                                                                                                                                                         j=2                          a11                               a11
                                                                                                                                                                               т.е. первое уравнение делится на a11, а затем, умноженное на соответ-
   1            −1 −1 ::: −1                                             1            1         2        : : :    2n−2                                               ствующий коэффициент ai1, вычитается из последующих уравнений. В по-
   0            1         −1 ::: −1                                      0            1         1        : : :    2n−3                                                                                       (1)             (1)
                                                                                                                                                                         лученной системе A                          x = b              неизвестное x оказывается исключенным
                                                                −1                                                                                                                                                                                                 1
    A=                                                         ; A             =                                                        :
   ::: :::                : : :    : : :     : : :                       ::: ::: ::: ::: :::                                                                         из всех уравнений, кроме первого. Далее, при условии, что коэффициент
       0         0         0        : : :     1                                 0        0         0        : : :    1                                                     (1)                         (1)
                                                                                                                                                                         a       матрицы A                   отличен от нуля, исключаем x из всех уравнений кроме
                                                                                                                                                                           22                                                                                           2
                                                                                                                                                                                                                                                                                   (n)              (n)
                        −1                                                                                                                                               первого и второго, и т.д. В итоге получим систему A                                                            x = b             с верхне-
Здесь матрица A                           найдена как решение системы Ax = b при помощи                                                                                             треугольнойматрицей.Даннаяпоследовательностьвычисленийназывается
обратного хода метода Гаусса. Определитель A равен 1, вычислим ее число                                                                                                             прямымходомметодаГаусса.Из последнего уравнения приведенной систе-
                                                                            −1                                          2
обусловленности. Получим: kAk∞ = n, kA                                                     k∞ = 1 + 1 + 2 + 2 + ··· +                                                               мы определяем компоненту решения x . Далее подставляем x в (n−1)-е
2n−2 = 2n−1, cond (A) = n2n−1, т.е. матрица A плохо обусловлена, хотя                                                                                                                                                                                           n                                              n
                          ∞                                                                                                                                              уравнение, находим x                               и т.д. Соответствующая последовательность вы-
det(A) = 1. Отметим также, что в данном случае λ (A) = 1, но матрица A                                                                                                                                                         n−1
                                                                                           i                                                                             числений называется обратным ходом Гаусса. Если на k-м шаге прямого
несимметрична, поэтому за обусловленность отвечают собственные числа                                                                                                                хода коэффициентa(k−1) равен нулю, тогда k-я строка уравнения перестав-
    T                                                                                                                                                                                                                      kk
A A.                                                                                                                                                                                ляетсяспроизвольнойl-йстрокой,l > k сненулевымкоэффициентомa(k−1)
                                                                                                                                                                                                                                                                                                                   lk
                                                                                                                                                                         при x . Такая строка всегда найдется, если det(A) 6= 0.
                                                                                                                                                                                    k
   Лекция11.Точныеметодырешениясистемли-                                                                                                                                                     Если на k-м шаге прямого хода диагональный элемент a(k−1) отличен
                                                                                                                                                                                                                                                                                                  kk
         нейных алгебраических уравнений                                                                                                                                            от нуля, но имеет малое абсолютное значение, то коэффициенты очеред-
                                                                                                                                                                                                       (k)
                                                                                                                                                                         ной матрицы A                       будут вычислены с большой абсолютной погрешностью.
                                                                                                                                                                         Этоможетсущественноисказить найденный ответ.Поэтому при практиче-
К точным методам решения системы Ax = b линейных алгебраических                                                                                                                     ской реализации метода Гаусса следует на каждом шаге прямого хода пере-
уравнений (слау) относятся алгоритмы, которые при отсутствии ошибок                                                                                                                 ставлять на k-е место строку с максимальным по модулю элементом a(k−1)
                                                                                                                                                                                                                                                                                                                   lk
округления позволяют точно вычислить искомый вектор x. Если число                                                                                                                   среди всех l ≥ k. Такая необходимая при расчетах модификация назвается
ненулевых элементов матрицы имеет порядок n2, то большинство тако-                                                                                                                  методомГауссасчастичнымвыборомглавногоэлемента.Данныйалгоритм
                                                                                                   3                                                                                                                                                                                      ˜
го рода алгоритмов позволяет найти решение за O(n ) арифметических                                                                                                                  позволяет гарантированно найти приближенное решение x с малой нормой
    Раздел 3.                                                                                                              65                           66                                                     Лекция 11. Точные методы решения слау
           ˜                                                                             ˜                                                                                                                                                           3
    невязки kb−Axk=kbk но, возможно, с большой ошибкой kx−xk=kxk.                                                                                             Среди точных методов, требующих для реализации порядка O(n ) дей-
                                                                                                                                      ствий, одним из наиболее устойчивых к вычислительной погрешности яв-
    Лемма 11.1 Реализация прямого и обратного хода метода Гаусса требу-                                                                                 ляется метод отражений.
      2 3        1 2                                                                                                                        Пусть имеется некоторый единичный вектор w ∈ Rn, kwk2 = 1. По-
    ет порядка 3n и 2n арифметических действий соответственно.                                                                                          строим по нему следующую матрицу U = I −2wwT, называемую матри-
                                                                                                                                      цей Хаусхолдера. Здесь I  единичный оператор, wwT = Ω  матрица
   Действительно, число умножений прямого хода равно n2 + ::: + 1 ≈                                                                              с элементами ω                = w w , являющаяся результатом произведения вектор-
    Rn 2               3                                                                                                                                                          ij        i   j         T
      0 x dx = n =3, столько же сложений; для обратного хода количесто ариф-                                                                            столбца w на вектор-строку w .
    метических действий находится аналогично.
                                                                                                                                      Теорема 11.1 (Свойства матрицы Хаусхолдера).
    Лемма 11.2 Прямой ход метода Гаусса соответствует последователь-                                                                                          1. Матрица U является симметричной и ортогональной матрицей,
    номуумножениюисходнойсистемынадиагональныематрицыC иниж-                                                                                            т.е. U = UT и UTU = I, и все ее собственные значения равны ±1.
                                                                                              k
    нетреугольные матрицы C′: матрица C получается из матрицы I заме-                                                                                         2. Uw = −w; если вектор v ортогонален w, тогда Uv = v.
                               k                     k

    ной диагонального элемента с индексом i                                   на элемент a(k−1) −1, мат-                                                      3. Образ Uy произвольного вектора y является зеркальным отраже-
                                                      k;k                           k;k                                               нием относительно гиперплоскости, ортогональной вектору w.
    рица C′ получается из матрицы I заменой k-го столбца на столбец
         k

                                  (k−1)         (k−1)               (k−1) T                                                                 Доказательство. 1. Симметричность U следует из явного вида U. Так
                0;:::;1;−ak+1;k;−ak+2;k;:::;−an;k                               .                                                     как (w;w) = 1, следовательно,
                                                                                                                                                     n
                                                                                                                                      ΩΩ| =Xww w w =Ω| иUU=I−4Ω+4ΩΩ=I,т.е.U2=UTU =I.
    Метод Гаусса по сути соответствует разложению исходной матрицы A на                                                                                       ij              i   k k j             ij
                                                                                                                                                    k=1
    произведение нижнетреугольной L и верхнетреугольнойR. Действительно,                                                                                      2. Так как (Ωw) = Pn w w w = w , следовательно (I − 2Ω)w =
                         ′             ′                                                                                                                               i           j=1     i   j   j          i
    CA = R, где C = C C                          : : : C C       нижнетреугольная матрица, а R                                                                                                                           P
                     n n−1            1 1                                                                                             w−2w=−w.АналогичноΩv=0,если                                            n     w v =(w;v)=0.
    верхнетреугольная матрица с единичной диагональю. Поэтому A = LR,                                                                                                                                                          j=1     j j
    где L = C−1.                                                                                                                                              3. Представим y в виде y = (y;w)w + v. Тогда из п. 2 следует Uy =
   ПрямойходметодаГауссасчастичнымвыборомглавногоэлементасоот-                                                                                   −(y;w)w+v, где v =y−(y;w)w, v ⊥w. Теорема доказана.
    ветствует последовательному умножению исходной системы на некоторые                                                                                       Преобразование Хаусхолдера. Для единичных векторов y и e най-
    диагональные матрицы C , нижнетреугольные матрицы C′ и матрицы пе-                                                                                                                                                                                          T
                            k                                                     k                                                   дем единичный вектор w такой, что Uy = e, где U = I −2ww . Из свой-
    рестановок P . При этом матрицы C , C′ совпадают с матрицами метода
        k                                      k      k                                                                               ства зеркально отражения 3 предыдущей теоремы несложно заметить, что
    Гаусса, матрицы P получаются из единичной матрицы I некоторой пере-                                                                                                         p                                                                    T
                 k                                                                                                                    w=±(y−e)= (y−e;y−e). Действительно, I−2ww y = y−ξ = e,
    становкой строк.                                                                                                                                    так как
   Такой подход гарантирует, что метод находит приближенное решение с
                                                                                                                                                            n
    малой относительной невязкой (но, возможно, большой ошибкой). Метод                                                                                                   2 P(yi−ei)(yk −ek)yk                       2(y −e )(1−(y;e))
    Гаусса с выбором на каждом шаге наибольшего элемента по всей подмат-                                                                                          ξ = k=1                                        =        i      i                     =(y −e ):
    рице на практике почти не применяется, хотя имеются немногочисленные                                                                                            i             (y−e;y−e)                                  2−2(y;e)                         i      i
    примеры, когда он дает качественное улучшение.                                                                                                      Отметим, что преобразование U не меняет длины вектора, следовательно,
   Отметим, что для невырожденной матрицы A существуют матрицы пе-                                                                               для неединичного вектора y имеем:
    рестановок P и P , нижняя треугольная матрица L и верхнетреугольная
        1       2
    Rтакие, что P AP =LR. При этом достаточноодной из матриц P . Умно-                                                                                                                                                                            −1
          1     2                                                                              i                                                                                                    (y−αe)                  (α      y−e)
    жение A на матрицу P слева переставляет строки исходной матрицы, а                                                                                                   Uy=αe; α=kyk2; w=±                                           =±                         :
                         1                                                                                                                                                                                                     −1
    умножение на P справа  столбцы. Для того чтобы матрица имела LR-                                                                                                                                                ky−αek2                 kα y−ek2
             2
    разложение, необходимо и достаточно, чтобы все ее ведущие подматрицы                                                                                      Метод отражений. Произвольнаяквадратнаяматрица A может быть
    (в том числе и A) были невырожденные.                                                                                                               приведенакверхнетреугольномувидуврезультатепоследовательногоумно-
         Раздел 3.                                                         67               68                             Лекция 11. Точные методы решения слау
         женияслеванаортогональныематрицыотражений.Действительно,повек-                     Утверждение 11.1 Пусть A  m×n матрица, m≥n, вектор-столбцы
    T                  T
         торам y = (a ;:::;a    )  и e = (1;0;:::;0)  можно построить вектор                которой линейнонезависимы.Тогда существуют и единственныматрица
     1     1;1     n;1     1
         w и соответствующую матрицу U так, чтобы первый столбец матрицы                    Q∈Rm×n,QTQ=I ,иR∈Rn×n,верхнетреугольнаясположительными
          1                              1                                                                    n
          (1)                                         n
         A =UAбылпропорционален вектору e ∈ R , т.е. U y = ±α e . Вы-                       диагональными элементами такие, что A = QR.
      1                              1            1 1      1 1
     2    2          2  1=2
         числим α =(a    +a +:::+a )         и определим
      1     1;1  2;1        n;1                                                     Классический алгоритм Грама–Шмидта ортогонализации набора
                          T                                    линейно-независимых векторов {a ;a ;:::;a }:
   ˜                                                 ˜   ˜                                                      1  2      n
  w =(a =α +sign(a );a =α ;:::;a =α ) ; w =w =kw k :
    1    1;1  1       1;1  2;1  1     n;1  1     1    1   1 2
                                                                             q =a ;                    q :=q =kq k ;
         Такой выбор знака и предварительная нормировка на α гарантируют ма-                               1    1                    1    1    1 2
                               1
                                                                             q =a −(a ;q )q ;          q :=q =kq k ;
         лость вычислительной погрешности и устойчивость алгоритма.                                        2    2    2  1  1         2    2    2 2
      n−1                   (1)    (1) T                                     : : :                     : : :
 Далее в пространстве R     по вектору y = (a ;:::;a ) строится
′                                2     22     2n        T                               q =a −Pn−1(a ;q )q ; q :=q =kq k :
         матрицаU2,отображающаяеговвектор,коллинеарныйe2 = (1;0;:::;0) ∈                                   n    n     j=1  n  j  j   n     n   n 2
         Rn−1. Затем определяется U2 =  1     0  и рассматривается матрица                Теорема 11.2 Вектора {q }n ортонормальны: (q ;q ) = δ .
              0  U′                                                                     i 1                  i  j    ij
                  2
                             I      0
          (2)                                                k−1                            Доказательство несложно провести методом индукции, используя явный
         A =U2U1A,итакдалее.На k-м шаге имеем Uk =           0    U′  . Таким
                                      k                        вид формул и условие
                                  ˜    ˜
         образом,матрицаотраженийUk строитсяповекторуwk = wk=kwkk2, wk ∈
         Rn, где                                                                                     span < a ;:::;a >= span < q ;:::;q >⊥ q ;   m>k:
                                                                                1     k            1      k     m
   ˜             (k−1)          (k−1)  (k−1)        (k−1)   T                       МодифицированныйалгоритмГрама–Шмидтаматематическиэк-
  w =(0;:::;0;a      =α +sign(a     ); a   =α ;:::;a    =α ) ;
    k            k;k   k        k;k    k+1;k k      n;k   k
                                                               вивалентен предыдущему, но более устойчив при наличии вычислительной
(k−1) 2    (k−1) 2        (k−1) 2 1=2                          погрешности:
    α =((a      ) +(a     ) +:::+(a      ) )  :
     k     k;k        k+1;k          n;k
         Врезультатепреобразований получится верхняя треугольная матрица R =                            q =a ;                   q :=q =kq k ;
                                                                            1    1                    1    1   1 2
         UA, где U = U    : : : U . При практической реализации явное вычисление                        q =a ;
     n−1    1                                                                          2    2
        (k−1)    (k−1)       T (k−1)                                     q =q −(q ;q )q ;         q :=q =kq k ;
         Uk не требуется, так как UkA (k−1)= A     −2wk wkA        . При этом                            2    2    2  1  1         2    2   2 2
                                   (k−1)                                   : : :                    : : :
         изменяются только элементы aij   , k ≤ i;j ≤ n матрицы A   .                                   q =a ;
 Изусловия UU =I имеем A=UR. Таким образом, произвольная квад-                                n    n
                                                                           q =q −(q ;q )q ;         q =q −(q ;q )q ;
         ратная матрица A может быть представлена в виде произведения симмет-                            n    n    n   1 1         n    n    n  2  2
         ричной ортогональной матрицы U и верхней треугольной матрицы R.                                : : :                    : : :
                                                                           q =q −(q ;q       )q   ; q :=q =kq k :
 Рассмотренный алгоритм позволяет свести систему линейных уравне-                             n    n    n   n−1  n−1    n    n   n 2
         ний Ax = b к виду Rx = Un−1:::U1b, а затем найти ее решение обратным               Вычислительная устойчивость достигается за счет вычитания уже найден-
         ходомметода Гаусса. Пусть решается задача с возмущенной правой частью              ных q из a . В этом случае накопление погрешности при вычислении q
          ˜                                                                                      i     n                                                       n
         Ax=b+δиkδk≪kbk.Таккакортогональныепреобразования не меня-                          из-за неточной ортогональности {q }, i < n происходит существенно мед-
                                     ˜                                                          i
         ют евклидову норму векторов, то для приведенной системы Rx = Ub+Uδ                 леннее.
         имеем kUδk = kδk ≪ kbk = kUbk, и относительная погрешность правой                     ПостроимпонайденнымвекторамматрицуQ=(q :::q )ирассмотрим
         части не увеличилась. В методе Гаусса матрица преобразования C не орто-                                                             1    n
                                                               матрицу R =QTA:
         гональна, и в общем случае может оказаться, что kCδk станет сравнимым с                                                                         
         kCbk. То есть малая начальная погрешность может существенно исказить                                               (q ;a )  (q ;a ) :  (q ;a )
                                                                               T                   1  1     1 2        1  n
                                                                             q
                                                                               1
         ответ.                                                                                                             0         (q ;a ) :  (q ;a ) 
                                                                     T                                      2 2        2  n
                                                                    Q A= ::: (a :::a )=                                   
                                                                                     1    n
 QR-разложение. Рассмотрим еще один метод (в дополнение к методу                                 T               :         :       :  :       
                                                                             q
         отражений) построения разложения A = QR.                                                           n                 0        :       0 (q ;a )
                                                                                                                       n  n
    Раздел 3.                                                                                                              69                           70                                   Лекция 12. Линейная задача наименьших квадратов
    с элементами r              =(q;a ). Отметим, что по условию                                                                                        Рассмотрим некоторые методы решения данной минимизационной задачи,
           ij        i    j
                                                                                                                                      называемой задачей наименьших квадратов (знк).
    span < a ;:::;a >= span < q ;:::;q >⊥ q ; m > k:
                 1           k                      1           k          m                                                                Метод нормального уравнения Гаусса для знк. Рассмотрим следу-
                                                                                                                                                                                                                                T              T
    Отсюда следует, что (q ;a ) = 0 при i > j. Построенная матрица Q ортого-                                                                            ющую, называемую нормальной, систему уравнений A Ax = A b с квад-
                        i    j                                                                                                                                        T
    нальна QTQ=I , т.к. (q ;q ) = δ . Отсюда и из QTA = R имеем A = QR.                                                                                 ратной матрицей A A размерности n×n. Отсюда найдем вектор x.
             n             i    j        ij
    Задача 11.1. Построить подобное разложение A = QR с квадратной мат-                                                                                 Теорема 12.1 (Гаусса К.Ф.) Пусть m ≥ n и rank(A) = n. Тогда нор-
    рицей Q.                                                                                                                                            мальное уравнение имеет единственное решение.
   Если модифицированный алгоритм Грама–Шмидта необходимо приме-
                                                                                                                                                                                                              T
    нить для решения задачи Ax = b (хотя для больших n происходит зна-                                                                                        Доказательство. Если Ax 6= 0, то (A Ax;x) = (Ax;Ax) > 0 . Но
    чительное накопление вычислительной погрешности, и поэтому лучше вос-                                                                               Ax 6= 0 для всякого x 6= 0, так как rank(A) = n. Следовательно, матрица
                                                                                                                                         T
    пользоватьсяметодомотражений),то задачусводятксистемеRx= d.При                                                                                      A A невырождена и нормальное уравнение имеет единственное решение.
                                                                                                                                                                T             T     T
    этом матрица R находится указанным способом, а компоненты вектора d                                                                                 Отметим, что A A =(A A) , т.е. полученная матрица симметрична.
                                                                                                           i
    для сохранения вычислительной устойчивости определяются по следующе-                                                                                Теорема 12.2 Пусть m ≥ n и rank(A) = n. Вектор x  решение задачи
    му алгоритму: r = b; d = (r                          ; q ); r = r            −dq; i=1; ::: ;n:
             0           i        i−1      i      i      i−1˜       i   i                                                             наименьших квадратов minkb − Ayk2 тогда и только тогда, когда x
   Отметим, что если приближенное решение x системы Ax = b получено                                                                                                                         y
                                                                                                                                                                       T              T
    каким-либо методом, основанном на QR-разложении, то можно выполнить                                                                                 решение системы A Ax = A b.
                                                                                              ˜
    следующий процесс уточнения. Найдем вектор невязки r = b−Ax с удво-                                                                                       Доказательство. Из предыдущей теоремы следует существование и
    еннымколичествомзначащихцифрирешимсистемуAz=r=krk.Положим                                                                                                                                                              T
    ˜        ˜                                                                                                                                          единственность такого вектора x, что A (b − Ax) = 0. Рассмотрим y =
    x := x + krkz. Процесс уточнения значительно экономичнее, чем решение                                                                               x+∆.Вэтомслучаеkb−Ayk2 =(b−A(x+∆);b−A(x+∆))=(b−Ax;b−
    исходного уравнения, так как разложение матрицы A уже имеется. Уточ-                                                                                                                                 2
                                                                                                                                                                                                            2                                 T
    нение можно повторять до тех пор, пока убывает норма вектора невязки.                                                                               Ax)+(A∆;A∆)+2(A∆;b−Ax)=kb−Axk2+(A∆;A∆)+2(∆;A (b−Ax)).
                                                                                                                                      Следовательно, минимум достигается при ∆ = 0, т.е. на векторе y = x.
                                                                                                                                            Метод QR-разложения. Метод нормального уравнения прост в ре-
      Лекция12.Линейнаязадачанаименьшихквад-                                                                                                            ализации, однако в приближенной арифметике для почти вырожденных
     ратов                                                                                                                                       задач большой размерности может давать плохой результат. Например, в
                                                                                                                                                                                                  T                           T                   2
                                                                                                                                      случае квадратной матрицы A = A имеем cond (A A) = cond (A). Та-
                                                                                                                                                                                                                        2                         2
                                                                                                                                      ким образом, обусловленность исходной задачи возводится в квадрат, по-
    Пусть требуется решить слау Ax = b с матрицей A размерности m × n,                                                                                  этому полученное численно решение может сильно отличаться от точного,
    правой частью b ∈ Rm и вектором неизвестных x ∈ Rn.                                                                                                 если cond(A) ≫ 1. Метод, основанный на QR-разложении матрицы A, бо-
   Рассмотрим три случая: 1) m = n, det(A) 6= 0; 2) m < n, rank(A) = m;                                                                          лееустойчивквычислительнойпогрешности.Соответствующееразложение
    3) m > n, rank(A) = n.                                                                                                                              A=QRприQTQ=I,detR6=0можнопостроитьметодомотраженийили
                                                                         −1                                                           методом вращений.
   В случае 1) задача невырождена и вектор x = A                                        b является точным
    решением. Для вектора невязки r = b − Ax имеем krk = 0. В случае 2)                                                                                 Теорема 12.3 Пусть m > n и rank(A) = n. Тогда матрицу A можно
    задача недоопределена. Исходная система имеет подпространство решений                                                                               привести к виду
    размерности (n − m). Для каждого решения имеем krk = 0. В случае 3)
    система переопределена и, если она несовместна, то точного решения не                                                                                                                                                  R
                                                                                                                                                                       A=QR=(Q Q )                         1      =QR;
    существует, т.е. для произвольного x ∈ Rn имеем kb−Axk = krk > 0.                                                                                                                                         1    2        0              1 1
   Представляютинтересметодырешенияпереопределенныхзадач,поэто-
    му далее, если не оговаривается иное, считаем, что m > n и rank(A) = n.                                                                                                       Q∈Rm×m;R∈Rm×n; QTQ=I;detR16=0
    ДлязадачтакогородаГаусс предложил считать решением вектор x, мини-                                                                                  с верхней треугольной R ∈ Rn×n. В этом случае решение x задачи наи-
                                                                                                                                                                                1
    мизирующий евклидову норму вектора невязки infkb−Ayk2 = kb−Axk2.                                                                                    меньших квадратов является решением системы R x = QTb.
                                                                  y                                                                                                                                                         1           1
        Раздел 3.                                                       71              72                 Лекция 12. Линейная задача наименьших квадратов
Доказательство. Разложение с указанными Q и R можно построить                и для задачи наименьших квадратов с матрицей A имеется семейство
        методом отражений. Из метода нормального уравнения следует, что x =             решений
T  −1 T                 T  T      −1 T T       −1 T
        (A A) A b. Поэтому x = (R Q Q R ) R Q b = R Q b. Таким об-                                               −1  T             T
      1  1  1 1    1  1      1  1                                             x= R (Q b−R x );x         ;
        разом, искомый вектор x является решением системы R x = QTb.                                             11  1     12 2   2
                             1     1
Формальнометодболеетрудоемкий,нопостроиводнаждыQR-разложе-                                T       k      n−k
                                                           где x = (x ;x ) ;x ∈ R ;x ∈ R   :
                                                                   1  2    1       2
        ние, можно быстро решать задачи с различными правыми частями.
Вырожденныезадачи.Задачанаименьшихквадратовназываетсявы-                       Доказательство. Искомое разложение A = QR можно построить ме-
        рожденной, если rank(A) < n. При численном решении вырожденных и                тодом отражений. Решим задачу наименьших квадратов:
        почти вырожденных систем требуется изменить постановку задачи и соот-
        ветственно применять иные методы. Рассмотрим следующий пример                              kb−Axk2=kQT(b−QRx)k2=kQTb−Rxk2=
                                                                              2                2             2
 1 1  x   1
            1





                =       :                                         T                   2       T                   2
  0 0      x        1
  Q           R    R

 Q b−R x −R x

            2                                                        1          11   12           1      11 1   12 2





                                                              =      T   b−              x   =            T            =

  Q2          0    0

        Q2b

        Для данного уравнения m = n = 2 и задача имеет семейство решений                                                 2                         2
     T                   T
        x = (1 − x ;x ) , r = b − Ax = (0;1) . Можно выбрать решения как с
2  2                                                                                  =kQTb−R x −R x k2+kQTbk2:
        нормами порядка единицы, так и со сколь угодно большими. Однако, для                                1     11 1    12 2 2    2  2
        возмущенной задачи                                                              В данном случае умножение на QT корректно, т.к. Q ортогональная мат-
 1 1  x   1                                          рица, не меняющая при умножении евклидовой длины вектора. Теорема
            1   =       ;                                  доказана.
  0 ε      x        1
            2                                                Замечание. В общем случае метод QR-разложения не позволяет из
        формально близкой к исходной при малых ε, имеется единственное реше-            всего множества решений выделить решение с минимальной евклидовой

      −1 −1 T                          −1                                    нормой, хотя выбор x = 0 может давать неплохое приближение.
        ние 1−ε ;ε       с большой нормой порядка ε  и нулевой невязкой. Это                               2
        означает, что сколь угодно малое возмущение элементов матрицы может               Метод QR-разложения с выбором главного столбца. Преобразу-
                                                                                                                           ˜
        существенно изменить структуру и норму решения.                                 ем исходную задачу так, чтобы первые k столбцов полученной матрицы A
                                                                                       ˜
                                                           были линейно независимы, т.е. A = AP = QR, где P  некоторая матрица
        Теорема 12.4 Пусть rank(A) = k, A ∈ Rm×n, m ≥ n и k < n. Тогда                                            ˜˜
                                                           перестановок. Отсюда имеем Ax = b, и далее найдем решение задачи наи-
        множество векторов x, минимизирующих kb−Axk2, образует (n − k)-                 меньших квадратов. Перестановкистолбцов в матрице A удобно проводить
        мерное линейное подпространство.                                                в процессе вычислений. Цель соответствующих перестановок  получить в
                                                                        R    R 
Доказательство. Пустьвекторz ∈ker(A) и dim(ker(A)) = n−k. Тогда                              11   12
                                                           матрице R =  0    R какможнолучше обусловленный блок R и
        Az = 0, и если x минимизирует kb−Axk , то x+z также минимизирует                                     22                                       11
                2                                                        0    0
        невязку, так как kb−A(x+z)k2 = kb−Axk2:                                         как можно меньшие элементы в R22. В приближенных вычислениях блок
                                                           R отличен от нуля, хотя исходная задача могла быть неполного ранга.
        Теорема 12.5 Пусть ранг матрицы A∈ Rm×n, m≥n, в точной арифме-                   22
        тике равен k < n, и первые k столбцов линейно независимы. Тогда мат-              Соответствующие вычисления проводятся на основе стандартного QR-
        рицу можно привести к виду                                                      разложения,например,методомотражений.Наk-мшаге(k =1;:::;n−1)в
                                                                    (k)
                                                           матрице A  выбирают столбец с номером j , k ≤ j ≤ n, с наибольшей ве-
                                                                                                 k     k
              R     R                                                  m      !1=2
        A=QR=(Q1Q2) 011 012 ;                                         личиной max   X a(k) 2      : Если таких столбцов несколько, то берут
                                                                   k≤j≤n      ij
                                                                         i=k
         m×m T                                                                                       (k)
    Q∈R      ; Q Q = I;                                               произвольный из них. В матрице A найденный столбец j переставляют
                                                                                                              k
    R ∈Rk×k; detR 6=0; R ∈Rk×(n−k);                                   с k-м столбцом. Далее реализуют очередной шаг QR-разложения.
     11              11       12
Раздел 3.                                                                                                                                       73                                  74                                         Лекция 12. Линейная задача наименьших квадратов
Задача 12.1. Оценить величину элемента r                                                       в методе QR-разложения с                                                             Aимеет диагональный вид, т.е. для произвольного вектора x = Pn                                                                             β v
                                                                              nn                                                                                                                                                                                                                              i=1 i i
выбором главного столбца для                                                                                                                                                        имеем y = Ax = Pn σ β u . Иначе говоря, всякая матрица A становится
                                                                                                                                                                                                               i=1 i i i
                                1 −1 ::: −1                                                                                                                            диагональной, если в области определения и в области значений подходя-
                                                                                                                                                                         щимобразом выбраны ортогональные системы координат.
                                0                1     −1 :::                                 n×n
                      A=                                                ; A∈R :
                                :::           : : :    : : :     : : :                                                                                                 Теорема 12.6 Пусть A = U1ΣVT, rank(A) = n. Тогда решение x задачи
                                        0      : : :       0         1                                                                                                   наименьших квадратов minkb−Ayk имеет вид x=VΣ−1UTb.
                                                                                                                                                                                                                           y                       2                                               1
       Методсингулярного (SVD) разложения.Методприменяютдляре-
шениягарантированнонаилучшимобразомплохообусловленныхи вырож-                                                                                                                             Доказательство. Из метода нормального уравнения следует, что ре-
денных задач.                                                                                                                                                                       шение x можно представить в виде
                                                                                                                                                                                            T       −1 T                          T             T −1               T                 −1 T
Утверждение 12.1 Пусть A  матрица размерности m×n, m ≥ n.                                                                                                                                x=(A A) A b=(VΣU1U1ΣV ) VΣU1b=VΣ U1b.
Тогда справедливо сингулярное разложение
                                                                                                                                                                                                                                                               Σk 0                             T
                                                                                                                                                                         Теорема 12.7 ПустьматрицаA=(U U )                                                                             (V V ) имеетранг
                                         T                           Σ           T                   T                                                                                                                                                1     2        0         0           1    2
                      A=UDV =(U1U2)                                           V =U1ΣV ;
                                                                     0                                                                                                   k < n, здесь U ∈ Rm×k, Σ ∈ Rk×k, V ∈ Rn×k.
                                                                                                                                                                                                    1                        k                      1
где                                                                                                                                                                                       Тогда пространство решений x задачи наименьших квадратов имеет
                                                                                                                                                                         вид x = V Σ−1UTb+V z с произвольным z ∈ Rn−k. Норма x минимальна
       U  ортогональная матрица размерности m×m;                                                                                                                                                     1 k          1             2
       V  ортогональная матрица размерности n×n;                                                                                                                                   при z = 0.
       Σдиагональнаяматрицаразмерностиn×nсэлементамиσ ≥σ ≥
                                                                                                                         1         2                                           Доказательство. kb−Axk2 =kUT(b−UDVTx)k2 =
: : : ≥ σ        ≥0.                                                                                                                                                                                                                              2                                            2
   n



       Столбцыu ;:::;u матрицыU называютлевымисингулярнымивекто-                                                                                                                                                                            T               2
                 1             m
      V

                                                                                                                                                                                                 T                              1
рами матрицы A, cтолбцы v ;:::;v матрицы V  правыми сингулярными
 U1 b−(Σk0)                            T        x
      T                  T       2           T       2
                                             1             n                                                                                                                         =
         V
 =kU b−ΣkV xk +kU bk :
                                                                                                                                                                                                                                2                            1                  1        2           2       2
векторами, величины σ  сингулярными числами. Если m = n, то нулевой
        T

                                   i
     U2 b

блок в матрице D отсутствует.                                                                                                                                                                                                                               2
       Построив SVD-разложение можно установить, является ли задача вы-                                                                                                             Отсюда следует, что вектор V Σ−1UTb является решением знк, а все ре-
                                                                                                                                                                                                                                     1 k         1
рожденной (σ = 0), невырожденной (σ 6= 0), "хорошей" (σ =σ не слиш-                                                                                                                                                                     −1 T                                                   n−k
                n                                                   n                                         1     n                                                    шения имеют вид x = V Σ                                  U b+V z для вех z ∈ R                                    . Действительно,
ком велико).                                                                                                                                                                                                                       1 k          1             2
                                                                                                                                                                         dimkerA = n − k; т.к. VTV = 0, то AV = UDVTV = 0; следовательно,
                                                                                                                          T                                                                                              1     2                        2                        2
       Если m < n; то сингулярное разложение строят для матрицы A . Если                                                                                                            kerA = V z, z ∈ Rn−k.
                    T                                                                                                                                                                     2
m=nиA=A ,тосингулярные числа σ = |λ |, т.е. с точностью до зна-                                                                                                                                                                                                                               −1 T
                                                                         i           i                                                                                         Норма x минимальна при z = 0, т.к. вектора V Σ                                                          U b и V z ортого-
ка совпадают с собственными числами, сингулярные векторы v являются                                                                                                                                                                                                                      1 k         1             2
                                                                                                                    i                                                    нальны.
соответствующими собственными векторами.
       Геометрическая интерпретация SVD-разложения.Рассмотримопера-                                                                                                                 Теорема 12.8 Пусть A=UDVT, rank(A)=n. Тогда
тор A, переводящий элемент x ∈ Rn в элемент y ∈ Rm. Единичная сфера
из Rn под действием A переходит в эллипсоид в подпространстве span <
                                                                                                                                                                                                                               inf          kA−Bk =σ
                       m                                                                                                                                                                                                         m×n                        2         k+1
u1;:::;un >⊂ R . Вектора ui, i = 1;:::;n, задают полуоси эллипсоида,                                                                                                                                                                 B∈R           ;
v ∈Rn ихпрообразы, σ  коэффициенты удлинения векторов v .                                                                                                                                                                        rank(B)=k≤n
   i                                                  i                                                                                 i
       Алгебраическая интерпретация SVD-разложения. Рассмотрим опера-                                                                                                               и достигается на матрице
торA,переводящийэлементx∈Rnвэлементy∈Rm.Вэтомслучаевпро-
странстве Rn существует ортонормальный базис v ;:::;v , а в простран-                                                                                                                                                                                  Σ            0
                                                                                           1             n                                                                                                                  A =U                   k              VT:
стве Rm  ортонормальныйбазисu1;:::;um такие, что матрица оператора                                                                                                                                                                       k                0         0
Раздел 3.                                                                           75                   76                                   Лекция 13. Линейная знк с ограничениями
    Доказательство.Попостроению(доказатьэто)матрицаA имеетранг                                             Лекция 13. Линейная знк с ограничениями
                                                       k
k. Покажем, что kA−A k =σ               . Действительно,
          k 2     k+1

                


       0  0
              Задача наименьших квадратов с линейными ограничениями–ра-

    T

   kA−A k =
U 0 Σ                  V
 ≤                                             венствами. Среди векторов x, удовлетворяющих системе Bx = d, требу-
           k 2
 n−k


       0  0
              ется найти вектор x, минимизирующий евклидову норму вектора невязки
                                            2                                                       ˜
                                                                                       inf˜kb−Axk2, т.е.
                                                                                          x



                          

    0   0
                                                                     ˜


                                                        inf kb−Axk2 =kb−Axk2:
                                                                                                                    ˜
                                   T                                                                              Bx=d



  ≤kUk  0 Σn−k  kV k =σ                       :
          2                           2     k+1


                                           m×n                    p×n

    0   0
2                                                        Здесь A ∈ R         , m ≥ n, B ∈ R        . Если rank(B) = n, то задача сводится
При этом                                                                                                 к решению Bx=d.
                                                                                           Методисключения.Пустьrank(B)=p<n.ПостроимQR-разложение
      kA−A k ≥k(A−A )v               k =σ       kUe      k = σ     ;                                                      T       R1                  n×n           p×p
   k 2             k   k+1 2      k+1     k+1       k+1                                следующего вида: B = Q                   ; где Q ∈ R      , R ∈R        , det(R ) 6= 0.
                                                                                                                          0                          1                 1
                                        T                                              Тогда
для kv      k = 1, где e         = (0;:::;0;1;0;:::;0) . Следовательно, kA −
 k+1 2               k+1
A k =σ        . Покажем,чтонесуществуетматрицыB рангаkболееблизкой                                                                    Bx= RT 0 QTx=d;
  k 2     k+1                                                                                                                                    1
к A. Так как                                                                                             можно сделать замену QTx = y и переписать исходную задачу в виде
                                                                                                                                y
       dim(ker(B))+dim(span{v ;:::;v             }) = n+1>n;                                                                       RT 0           1   =d;
                          1       k+1                                                                                     1          y
                                                                                                                                       2
                                                                                       где y ∈ Rp, y ∈ Rn−p  новые переменные. C учетом AQQTx ≡ (A A )y,
тосуществуетненулевоепересечениесоответствующихподпространств.Рас-                                             1          2                                                              1  2
         Pk+1                                                   2                      A ∈Rm×p,A ∈Rm×(n−p), исходная задача минимизации принимает вид
смотрим вектор h =                c v из этого пересечения с нормой khk              =                     1              2
            i=1 i i                                             2
P
   k+1c2 = 1. Имеем
   i=1 i                                                                                                                ˜                        ˜        ˜                               ˜
                                                                                          inf kb−Axk =          inf   kb−A y −A y k =infk(b−A y )−A y k ;
                                                                                                         2     T              1 1      2 2 2     ˜           1 1      2 2 2
                                                                                          ˜                                                      y
                                                                                        Bx=d                     ˜
                                                                                                              R y =d;                             2
                                       T                T                                                      1 1
                                                                                                                 ˜
                                                                                                                 y
kA−Bk2≥k(A−B)hk2=kAhk2=kUDV hk2=kU1ΣV hk2:                                                                                   2
                                                                                                                                            ˜
     T              T                                                                             т.е. сводится к стандартной знк относительно y при вычисленном из систе-
Так как V V = I, то V v = e , следовательно,                                                                                                                    2
            i     i                                                                           T                                                                              T
                                                                                       мы R y =d векторе y . Найденные таким образом компоненты (y ;y )
                                                                                              1  1                 1                                                   1   2
          k+1                    k+1                        k+1                                   позволяют получить искомый ответ x = Qy.
  VTh=Xce; ΣVTh=Xσce; U ΣVTh=Xσcu:                                                                    Замечание. Пусть rank(B) = r < p < n, и первые r столбцов линейно
    i  i                   i i i     1                i i i
          i=1                    i=1                        i=1                                   независимы. Тогда
Врезультате                                                                                                                R       R               RT      0  y   d
      k+1                    k+1                                                               BT =Q         11     12   ; Bx =        11            1    =       1   ;
       T          P 2 2 1=2              P 2 1=2                                                                        0     0                 RT     0       y           d
      kU ΣV hk =(           σ c )     ≥σ ( c) =σ khk =σ :                                                                                                12            2            2
  1         2          i i         k+1       i         k+1     2     k+1
       i=1                   i=1                                                                     r            n−r
Теорема доказана.                                                                                        где y ∈ R , y ∈ R                новые переменные (для вычисления матриц
                                                                                              1           2
    Сформулируем правило решения задачи наименьших квадратов в при-                                      можно применить QR-разложение с выбором главного столбца). Если по-
ближенной арифметике. В реальных вычислениях все σ получатся (с учё-                                     лученная система окажется несовместной, то решение исходной задачи не
                                               i
томмашиннойточности)отличнымиотнуля,поэтомузафиксируемнекото-                                            существует. Иначе исходная задача с ограничениями сводится к стандарт-
                                                                                                                  ˜                                       T
рое значение ε . Будем считать, что величины σ < ε при k = k +1;:::;n                                    ной знк относительно y при вычисленном из системы R y = d векторе
          0                                      k     0            0                                                         2                                      11 1      1
соответствуют погрешности вычислений, следовательно, можно заменить                                      y .
                                                                                         1
исходную задачу на задачу с матрицей A . Такой способ усечения матри-                                        Метод обобщенного сингулярного разложения. Решение задачи
                               k
цы A является оптимальным в том смысле, что полученная матрица A                                         наименьших квадратов с линейными ограничениями–равенствами будем
                                                                    k
наиболее близка к A в норме k·k2.                                                                        строить на основании следующего утверждения.
      Раздел 3.                                                                                                                         77                               78                                                      Лекция 13. Линейная знк с ограничениями
      Утверждение 13.1 (ОбобщенноесингулярноеразложениеGSVD).Пусть                                                                                                      что полученное решение сходится к решению исходной задачи при увели-
      A∈Rm×n,m≥n,B∈Rp×n,p≤n.Тогдасправедливо разложение                                                                                                                  чении λ (однако, при увеличении λ обусловленность системы стремится к
                                                                                                                                                       бесконечности).
                           A=UDAX−1; B=VDBX−1;                                                                                                              Пустьимеется GSVD для матриц A;B. Тогда исходная задача принима-
      где                                                                                                                                                                ет вид:
                                                                                                                                                                           kλD y−λVTdk2+kD y−UTbk2→inf; x=Xy;
     U  ортогональная матрица размерности m×m;                                                                                                                                              B                     2           A                   2
     V  ортогональная матрица размерности p×p;                                                                                                                   или покомпонентно,
     X  обратимая матрица размерности n×n;                                                                                                                                   p                                        n                                      m
     D =diag(α ;:::;α );α ≥:::≥α ≥0;D ∈Rm×n;                                                                                                                                X                                        X                                       X
        A                  1            n      1                   n             A                                                                                                                         2 2                                       2                         2
                                                                                                                                                                      (β y −(v ;d)) λ +                         (α y −(u ;b)) +                          (u ;b) →inf:
     D =diag(β ;:::;β );β ≥::: ≥ β ≥ 0;D ∈ Rp×n.                                                                                                                                     i i          i                            i i          i                           i
        B                  1           p      1                  p             B                                                                                            i=1                                      i=1                                   i=n+1
      Данное утверждение можно также обобщить на случай m < n и p > n.                                                                                                   Дифференцируяпоy иприравниваярезультаткнулю,находимоптималь-
     Пусть обобщенное сингулярное разложение построено:                                                                                                                                                i
                                                                                                                                                       ные значения yi. В результате имеем
             U =(u :::u );V =(v :::v );X =(x :::x ):                                                                                                                                   p                                                       n
                          1         m                 1         p                 1         n                                                                                                                     2
                                                                                                                                                                                     Xα(u;b)+λ β(v;d)                                        X (u;b)
                                                                                                                                                                              x=               i    i                 i    i       x +                   i       x :
                                                                                                                                                                                                         2        2 2                i                             i
                                                                                                                                                                                                       α +λ β                                            α
      Тогда исходная задача эквивалента следующей:                                                                                                                                                      i=1                i            i                    i=p+1           i
                             DBy=VTd; y=X−1x;                                                                                                         Отсюда следует оценка скорости сходимости x(λ) → x при λ → ∞.
                                 kDAy−UTbk2→inf:                                                                                                            Задача наименьших квадратов с ограничениями типа квадрат-
     Рассмотрим случай p ≤ n, rankB = p, rank(A) = n. Решая первое                                                                                                ных неравенств. Пусть A ∈ Rm×n, B ∈ Rp×n, n ≤ m, p ≤ n и требуется
      уравнение для y ;:::;y точно и минимизируя по оставшимся переменным                                                                                                найти такой вектор x, что
                 1            p
      y       ; : : : ; y   второе уравнение, получаем, что искомое решение имеет вид:
 p+1              n                                                                                                                                                                                                    kAx−bk2→inf;
                (v ;d)                                        (u ;b)                                                                                                                                        kBx−dk2≤E:
       y =          i      ; i = 1;:::;p;             y =         i       ; i = p + 1;:::;n:
         i         β                                    i         α                                                                                                                                                                 n
                      i                                              i                                                                                 ДополнительноеограничениевыделяетвR эллипсоидобластьдопусти-
      Отсюда находим:                                                                                                                                                    мых векторов x.
                                                                                                                                                            Пусть GSVD для матриц A, B найдено. Тогда исходная задача прини-
                                        p                           n                                                                                  мает вид
                                      X(v;d)                      X (u;b)
                   x=Xy=                        i       x +                   i       x :                                                                                                               kD y−UTbk →inf;
                                                β         i                   α         i                                                                                                                    A                   2
                                      i=1         i             i=p+1            i                                                                                                                      kD y−VTdk ≤E;
                                                                                                                                                                                                             B                   2
                                                                                                                                                       т.е.
      Отметим, что построение GSVD  процедура дорогостоящая.                                                                                                                                       k                                            m
                                                                                                                                                                                         A
                                                                                                                                                                                  P                                            P
     Для случая rank(B) < p, rank(A) < n решение строится аналогично.                                                                                                                                                          2                            2
                                                                                                                                                                                           (α y −(u ;b)) +                            (u ;b) →inf;
                                                                                                                                                                                                i i          i                             i
                                                                                                                                                                                  i=1                                      i=k +1
     Метод взвешиванием. Исходная система с ограничением заменяется                                                                                                                                                                         A
                                                                                                                                                                                       k                                        p
                                                                                                                                                                                         B
      на следующую задачу наименьших квадратов:                                                                                                                                                     P                                 2         P                  2         2
                                                                                                                                                                                 
                                                                                                                                                                                           (β y −(v ;d)) +                            (v ;d) ≤ E ;
                                                                                                                                                                                               i i          i                              i


                                                                  i=1                                     i=k +1
                                                                                                                                                                                                                                 B
                  λB                      λd
 λBx−λd;

                             x=                     ⇔

 →inf


                                       где k       =rank(A), т.е. α = 0 при j = k +1;:::;n; k = rank(B), т.е. β = 0
                    A                      b                    Ax−b                2                                                                          A                                j                          A                       B                                j
                                                                                                                                                       при j = k +1;:::;p. Найдем решение (y ;:::;y ) полученной задачи.
                                                                                                                                                                       B                                                        1            n
                                                                                                                                                                           p
      с некоторым λ ≫ 1. И так как для ее решения можно применить один из                                                                                                                   P                  2         2
                                                                                                                                                            Если                  (v ;d) > E , то решения не существует.
      стандартных алгоритмов, то данный подход прост в реализации. Покажем,                                                                                                                             i
                                                                                                                                                                      i=k +1
                                                                                                                                                                            B
Раздел 3.                                                                           79                   80                             Лекция 14. Итерационные методы решения слау
      p
      P           2     2                                                                         При этом множитель Лагранжа λ определяется из секулярного уравнения:
    Если          (v ;d) = E , то решение имеет вид:
  i                                                                                    ϕ y(λ) = 0: Так как в рассматриваемом случае ϕ y(0) > 0, а функция
   i=k +1
       B
    
                                                                                       ϕ y(λ) является монотонно убывающей при λ > 0, следовательно, суще-
     (v ;d)=β ;      1 ≤ i ≤ k ;
          i      i              B                                                                                ∗        ∗
          y =      (u ;b)=α ;    k +1≤i≤k ;                                                       ствуетединственноеλ : ϕ y(λ ) = 0.Его можнонайти,например,методом
i         i       i    B              A
     произвольные для            k +1≤i≤n:                                            Ньютона (начальное приближение определяется методом бисекции). Далее
                                   A                                                                     ∗                                               ∗
                                                                                       вычисляем y(λ ) и получаем искомое решение x = Xy(λ ).
Выборпроизвольныхкомпонентнулевымидаетрешениеминимальнойнор-                                                 Отметим,чтоеслиB =I,d=0,E =1,тоисходнаязадачасоответствует
мы. Здесь и далее считается, что если указан диапазон i1 ≤ i ≤ i2 для                                    задаче минимизации на единичном шаре.
i1 > i2, то соотвествующих i не существует.
        p
       P           2     2
    Пусть          (v ;d) < E . Тогда выберем первые компонентывектораy
   i                                                                                     Лекция14.Итерационныеметодырешенияслау
    i=k +1
        B
из условия kDAy−UTbk2 → inf, а оставшиеся  из условия минимизации
величины kDBy−VTdk2
                                                                                       Рассмотрим класс итерационных методов решения систем линейных алгеб-
 (u ;b)=α ;      1 ≤ i ≤ k ;                                                          раических уравнений, основанный на сжимающем свойстве оператора пе-
 i          i              A                                                          рехода. Различные постановки задачи минимизации нормы оператора пе-
     y =      (v ;d)=β ;     k     ≤i≤k ;                       (1)
       i         i      i     A+1          B
 произвольные для остальных i:                                                        рехода приводят к различным алгоритмам расчета.
                                                                                           Метод простой итерации. Преобразуем систему линейных алгебраи-
Если для него будет выполнено требуемое ограничение kDBy−VTdk2 ≤ E,                                      ческих уравнений
то найденный вектор является решением.                                                                                                          Ax=b                                         (1)
    Иначе искомое решение лежит на границе эллипсоида, т.к. ищется ми-                                   с невырожденной матрицей A к виду
нимум квадратичной функции на эллипсоиде, при этом ее абсолютный
минимум определяемый по формуле (1), не удовлетворяет ограничению                                                                             x=Bx+c:                                        (2)
kDBy−VTdk2 ≤ E, т.е. эллипсоиду не принадлежит. В этом случае ре-
шение может быть найдено из условий                                                                      Если решение системы (2) находится как предел последовательности
     k                            m
         A
     P                           P                                                                                                   k+1        k
                           2                 2
          (α y −(u ;b)) +             (u ;b) =f(y) →inf;                                                                           x     =Bx +c;                                     (3)
   i i     i                   i
     i=1                       i=k +1
                        A
        k                          p
         B
     P                    2      P           2     2                                             то такой процесс называется двухслойным итерационным методом, или
    
          (β y −(v ;d)) +             (v ;d) −E =ϕ(y)=0:
  i i      i                  i
     i=1                       i=k +1                                                            методом простой итерации. При этом B называется оператором перехо-
                        B
                                                                                       да. Рассмотрим общий способ перехода от задачи (1) к задаче (2). Всякая
Для решения данной задачи применим принцип множителей Лагранжа.                                          система
Для функции Лагранжа                                                                                                                      x=x−D(Ax−b)                                        (4)
             L(λ;y) = f(y)+λϕ(y)                                                       имеет вид (2) и при det(D) 6= 0 равносильна (1). В то же время всякая
условия ∂L=∂yi = 0;       1 ≤ i ≤ n имеют вид                                                            система (2), равносильная (1), записывается в виде (4) с матрицей D =
                                                                                                  −1
2α (α y −(u ;b))+λ2β (β y −(v ;d)) = 0;                                                (I −B)A .
   i   i i     i            i  i i      i                                                  Справедливы следующие теоремы о сходимости метода.
где α = 0;k < i ≤ n; β = 0;k < i ≤ n. Отсюда
      i       A             i       B                                                                    Теорема 14.1 Пусть kBk = q < 1. Тогда система уравнений (2) имеет
   α(u;b)+λβ(v;d)                                                                     единственное решение, и итерационный процесс (3) сходится с произволь-
   i i              i  i    ;   1 ≤ i ≤ max{k ;k };
    y (λ) =              2      2                           A B                                   ного начального приближения к решению задачи со скоростью геометри-
     i                 α +λβ
              i      i
                                                                                                                    k      k        0
     произвольные для остальных i:                                                     ческой прогрессии: kx−x k ≤ q kx−x k.
Раздел 3.                                                                                                                                       81                                  82                                                  Лекция 14. Итерационные методы решения слау
                                                                                                                                                                                                                      λ            ηα         0          : : :         0             
       Доказательство. 1. Известно, что система линейных уравнений имеет                                                                                                                                                                 1          1
                                                                                                                                                                                                                      0            λ          ηα         0             : : :         
единственное решение, если однородная задача имеет единственное реше-                                                                                                                                                                            2             2
                                                                                                                                                                                                     −1                                                                              
                                                                                                                                                                                                  ˜          ˜        :            :          :          :             :              ˜
ние. Для задачи (2) получаем                                                                                                                                                                                 S BS=                                                                                   =Λ:
                                                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                      0            : : :      0          λ             ηα            
                                                                                                       kck                                                                                                                 0        : : :                    n−1        λ n−1
           x=Bx+c⇒kxk≤kBkkxk+kck⇒kxk≤                                                                             ;                                                                                                                                                       n
                                                                                                  1−kBk                                                                  Пусть max |λ | < q < 1. Покажем, что метод сходится. Для η = q −
                                                                                                                                                                                              i     i
                                                                                                                                                                         max |λ | > 0 имеем
т.к. kBk < 1. Отсюда следует, что при kck = 0 имеем kxk = 0.                                                                                                                               i     i
                                                              k
       2. Пусть x  точное решение, а x  k-е приближение, тогда                                                                                                                                                     ˜
                                                                                                                                                                                                       kΛk = max (|λ |+ηα ) ≤max|λ |+η =q:
                                                                                                                                                                                                               ∞ i;α =0                 i            i           i        i
                                                                                                                                                                                                                            n
                                                                k+1               k
                                  x=Bx+c; x                             =Bx +c;
                                                                                                                                                                                                k            k−1             k 0         ˜˜k˜−1 0
                                                                                                                                                                         Итаккакz =Bz                                =B z =SΛ S z ,то
                                     k                 k
и для вектора ошибки z = x−x верна оценка:                                                                                                                                                                     k               ˜          ˜−1            k     0                           ˜ k 0
                                                                                                                                                                                               kz k          ≤kSk kS k q kz k =cond (S)q kz k ;
                       k            k−1           k                 k      0          k      0                                                                                                          ∞                ∞              ∞               ∞                 ∞                      ∞
                     z =Bz                 ; kz k ≤ kBk kz k ≤ q kz k → 0                                                                                                т.е. метод сходится.
                                                                                                                                                                               Пусть теперь для некоторого i выполняется |λ | ≥ 1, Be                                                                      = λ e .
                                                                                                                                                                                                                                             0                                 i                      i            i    i
при k → ∞.                                                                                                                                                                                                                                                                                  0                     0            0    0
                                                                                                                                                                                                                                           0                                                 k                 k 0
                                                                                                                                                                         Тогда для начального вектора x = x + cei находим kz k = kB z k =
                                                                                                                                                                                                                                                                   0
                                                                                                                                                                                k                    k
                                                                                                                                                                         kcB ei k = |cλ |kei k, следовательно, норма ошибки не стремится к нулю
                                                                                                                                                                                      0              i          0
Теорема 14.2 Пусть система уравнений (2) имеет единственное реше-                                                                                                                                                0
ние. Итерационный процесс (3) сходится к решению системы (2) при лю-                                                                                                                при k → ∞.
бом начальномприближениитогда итолько тогда, когда все собственные                                                                                                                        Оптимальный линейный одношаговый метод. Для систем со зна-
значения матрицы B по модулю меньше 1.                                                                                                                                              коопределёнными матрицами метод (3) обычно строится в виде
                                                                                                                                                                                                  k+1            k
       Доказательство. Напомним, что для произвольной матрицы B суще-                                                                                                                                      x         −x                   k
ствуют S и Λ, такие, что                                                                                                                                                                                           τ           +Ax =b;                      т.е.      B=I−τA; c=τb:                                               (5)
                                                                                                                                                                         Здесь τ  итерационный параметр.
                                               λ           α         0       : : :         0           
                                                      1        1                                                                                                               Так как точное решение x удовлетворяет уравнению (5), то имеет место
                                               0           λ         α       0             : : :                                                                                                                                                                   k                  k
                                                               2        2                                                                                                следующий закон изменения вектора ошибки z = x−x :
                    −1                                                                                 
                 S BS=Λ= :                                 :         :       :             :           :
                                                                                                                                                                                       k+1                             k           k+1                                  k
                                               0           : : :     0       λ             α                                                                                         z         =(I−τA)z ; kz                              k ≤ kI −τAkkz k; k = 0;1;2; ::: :
                                                    0       : : :                n−1        λn−1
                                                                                              n
                                                                                                                                                                         Оптимальныйитерационныйпараметрτ ищетсяизусловияминимумаопе-
                                                                                                                                                                                                                                                        0
ДанноеразложениеназываетсяЖордановойнормальнойформой. Здесь λ                                                                                                                       ратора перехода: minkI −τAk. Данная минимизационная задача решается
                                                                                                                                        i                                                                     τ
 собственные числа матрицы B, а α =0 или 1. Пусть η > 0. Тогда для                                                                                                                                                 T
                                                                  i                                                                                                      явно при A = A > 0. В этом случае в качестве нормы k · k удобно взять
         1                                                         λ
                                                                     i                           ˜                                                                       евклидову k·k норму. Тогда подчиненная ей матричная норма имеет вид
матрицы ηB с собственными числами η существует S:                                                                                                                                                               2
                                          λ                                                                                                                                                                            kAxk2             q                     T
                                                  1     α        0        : : :        0                                                                                                          kAk2 = sup                           = max|λ(A A)|=maxλ(A);
                                                η          1                                                                                                                                                      x6=0 kxk2
                                                        λ                                         
                                               0           2     α        0            : : :
                                                                    2
                          1                             η                                         
                   ˜−1           ˜        :            :        :        :            :                                                                                а соответствующая оптимизационная задача сводится к следующей:
                  S          BS=                                                                        ⇒
                                                                                                  
                          η                                               λ                       
                                                                             n−1
                                          0            : : :    0                     α           
                                                                              η         λn−1                                                                                                            minkI −τAk =min max|1−τλ(A)| =q :
                                               0        : : :                             n                                                                                                               τ                      2         τ                                              0
                                                                                         η                                                                                                                                                        λ(A)
Раздел 3.                                                                           83                   84                             Лекция 14. Итерационные методы решения слау
                       T                                                                                                         T
Теорема 14.3 При условии A = A > 0, λ(A) ∈ [m;M] и 0 < m ≤ M < ∞                                         Теорема 14.4 При условии A = A > 0, λ(A) ∈ [m;M] и 0 < m ≤ M <
оптимальное значение параметра равно τ =                2    и верна оценка                              ∞оптимальные значения параметров равны обратным величинам кор-
                               0    m+M
                                                                                       ней многочлена Чебышёва степени N на отрезке [m;M]: τ−1 = M+m +
                                     M−m                                                                                                                      j         2
       k        k       0                                                               M−mcosπ(2j−1), и после N итераций для погрешности справедлива оцен-
kx−x k ≤q kx−x k ; q =                        <1:
          2     0          2     0   M+m                                                  2         2N
                                                                                       ка:
                  k            k                                                                                                                             √       √
    Доказательство. Пусть z = x − x . Тогда уравнение для вектора                                                    N            2            0         N        0              M− m
      k                 k−1                           k                                                                                                      √
ошибки имеет вид z = (I − τA)z                . Отсюда получаем kz k2 ≤ k(I −                                kx−x k ≤                   kx−x k ≤2q kx−x k ; q =                        √ :
  k−1                                                                                                            2    q−N +qN              2      1          2     1      M+ m
τA)k2kz      k2. Будемминимизироватьпопараметруτ евклидовунормуопе-                                                           1       1
ратора перехода:                                                                                             Доказательство. Для вектора ошибки имеем:
 minkI −τAk2 =min           max      |1 − τλ(A)|:                                                          N                                  N
   τ                  τ  λ(A)∈[m;M]
                                                                                                   k+N     Y              k      k+N          Y                 k
                                                                                                 z      =     (I −τ A)z ⇒kz           k ≤k       (I −τ A)k kz k :
                                                                                                                    j                  2               j     2     2
Найдем решение данной минимизационной задачи:                                                                               j=1                                j=1
                        2                           M−m                                Будем минимизировать по параметрам τ евклидову норму оператора пе-
 |1 − τ m| = |1 −τ M|;τ =               ; q = kI −τ Ak =                :                                                                         j
       0            0      0    m+M 0                 0    2   M+m                                                                T
                                                                                       рехода. Так как для A = A имеем λ(P (A)) = P (λ(A)), то минимизаци-
                                                                                                                                     N           N
 k       k        0                                                                    онную задачу можно переписать следующим образом:
При этом kx−x k2 ≤ q kx−x k2.
         0                                                                                                                      N
    Замечание. Минимизационная задача по сути означает, что требуется                                                                           Y
                                                                                                                min    max |       (1 −τ λ)| = q :
                                                                                                                 τ                       j         N
найтиполиномпервойстепени,наименее уклоняющийсяотнулянаотрезке                                                                      j   λ∈[m;M] j=1
[m;M], имеющий ровно один корень и равный единице свободный член.                                        Данная задача сводится к нахождению многочлена P (λ) степени N, наи-
                                                                                                                                                      N
                                                       ˜[m;M]
Ее решением является нормированный многочлен Чебышева T1                         (λ) =                   менее уклоняющегося от нуля на [m;M] в классе P(0) = 1. Решением яв-
T (2λ−M−m)                                                                                                                                                                    T (2λ−M−m)
  1  M−m                                                                                                                                                       ˜[m;M]          N   M−m
 T (−M+m) .                                                                                              ляется нормированный многочлен Чебышёва TN                   (λ) = T (−M+m) , где
   1  M−m                                                                                                                                                                       N   M−m
    Оптимальный линейный N-шаговый метод. Будем считать, что в                                           TN(x) = cos(N arccosx). Отсюда следует, что τ−1 равны корням многочлена
итерационном алгоритме                                                                                                                                         j
                                                                                       Чебышёва на отрезке [m;M], т.е. {τ−1}N            ={m+M + M−mcosπ(2j−1)}N ,
                                                                                                                                 j   j=1        2        2         2N     j=1
               k+1     k                                                               а скорость сходимости алгоритма характеризуется величиной
             x     −x           k
                 τ       +Ax =b                                                                                                                    √       √
                  k+1                                                                                            2           2qN                     M− m
                                                                                                     q   =              =      1    ≤2qN; q = √            √ :
допускается циклическое изменение (с периодом N) параметра τ в зависи-                                                  N     q−N +qN        1+q2N         1    1      M+ m
                                                                                                             1       1          1
мости от номера итерации
                                                                                       Теорема доказана.
            τ ;τ ;::: ;τ ;τ ;τ ;::: :                                                      ПричисленнойреализацииN-шаговогопроцессадляустойчивостинеоб-
             1   2       N 1 2
                                                                                       ходимо специальным образом перемешивать значения параметров τ . На-
                                                                                                                                                                        j
Вэтом случае после N итераций для вектора ошибки имеем:                                                  помним алгоритм для N = 2p.


                                 m+M       M−m       π(2j−1) −1
                                                                                           Пусть τ          =(         +        cos        )   , т.е. нумерация τ ведется
  N
 N
                     N+1−j         2         2         2N                            j
    k+N     Y              k       k+N
Y
     k                               "от большего к меньшему". Тогда



  z      =     (I −τ A)z ;      kz     k ≤        (I −τ A)      kz k :
           j                  2              j            2


            для N = 2 устойчивая последовательность имеет вид (2;1);



 j=1                               j=1             2                                                          p−1
                                                                                           пусть для N = 2         имеем: (j ;j ;:::;j p−1);
                                                                                                                             1   2      2
Будемискатьнаборτ ,j = 1;:::;N,изусловияминимуманормыоператора                                               тогда для N = 2p: (2p +1−j ;j ;:::;2p +1−j p−1;j p−1).
      j                                                                                                                      1  1                 2     2
перехода.                                                                                                Например: (3;2;4;1), (6;3;7;2;5;4;8;1).
   Раздел 3.                                                                                                      85                         86                                      Лекция 15. Вариационные методы решения слау
 Отметим, что мы построили неулучшаемый по скорости сходимости ме-                                                                      Лекция15.Вариационныеметодырешенияслау
   тод в данном классе. Однако указанное уменьшение погрешности будет по-
   лучено только через N итераций, а реализация метода требует знания гра-
   ниц спектра m;M.                                                                                                                          Данныйклассметодовстроитсякакметодыминимизациинекоторогофунк-
 Дляоценкиграницспектрачастоиспользуетсяследующееутверждение.                                                                         ционала, минимум которого достигается на решении исходной системы ли-
                                                                                                                           нейныхуравнений.Конкретныйвидфункционалаиалгоритмминимизации
   Утверждение 14.1 (ТеоремаокругахГершгорина).Всесобственныезна-                                                                            определяют параметры итерационного процесса.
                                                                                                                                Метод наискорейшего градиентного спуска. Основная цель  по-
   чения матрицы A принадлежат объединению кругов                                                                                            строить оптимальный одношаговый метод, не требующий для реализации
                                                                                                                           информации о границах спектра.
                 |z −aii| ≤ X|aij|;              i = 1; ::: ;n:                                                                                                        T
                                 j6=i                                                                                      Лемма 15.1 Пусть A = A > 0 и F(x) = (Ax;x) − 2(b;x)  квадра-
                                                                                                                                                                              ∗
                                                                                                                           тичная функция. Равенство F(x ) = minF(x) выполнено тогда и только
   Если указанное объединение кругов распадается на несколько связных ча-                                                                                                                                 x
                                                                                                                                                 ∗
   стей, то каждая такая часть содержит столько собственных значений,                                                                        тогда, когда x  решение системы Ax = b.
   сколько кругов ее составляют.                                                                                                                                                                  ∗
                                                                                                                                Доказательство.Пустьx=x +∆.ПреобразуемвыражениедляF(x).
                                                                                                                                               ∗
 Отметим, что первая часть теоремы следует из покоординатной записи                                                                   Сучетом Ax =b имеем
   определения собственного вектора (Ax) = λx , i = 1; :::; n:                                                                                                                        ∗    ∗             ∗                                         ∗
                                              i        i                                                                          (Ax;x)−2(b;x)=(Ax ;x )−2(Ax −b;∆)+(A∆;∆)−2(b;x )=
                                                                                                                                                                     ∗    ∗                              ∗
             n                                                                                                                                              =(Ax ;x )+(A∆;∆)−2(b;x ):
           Xa x =λx; (λ−a )=Xa x =x:
                  ij   j        i              ii             ij  j    i                                                   Если A > 0, то (A∆;∆) > 0 при ∆ 6= 0, поэтому функция F(x) имеет
            j=1                                        j6=i                                                                единственный минимум при ∆ = 0.
   Так как равенство выполняется для всех i, то искомая оценка для фикси-                                                                         Замечание.СправедливаформулаgradF(x)=2(Ax−b),проверяемая
                                                                                                                           покомпонентным дифференцированием ∂F(x)=∂x .
   рованного λ верна для i = i(λ) : |x | ≤ |x |.                                                                                                                                                                         i
                                     j         i                                                                                Замечание.ВдольвектораgradF(x)происходитнаискорейшееизмене-
 Полная информация о собственных числах позволяет формально по-                                                                       ниефункцииF(x).Действительно,пустьeнекоторыйединичныйвектор.
   строить следующий точный метод.                                                                                                           Разложим в ряд F(x+δe) при условии малости величины δ ∈ R1, имеем
                                                                                                                                                                                         n
                                                                                                                                F(x +δe ;:::;x +δe ) =F(x)+δ P ∂F (x)e +O(δ2)∼
   Лемма 14.1 Пусть для невырожденной матрицы простой структуры                                                                                         1        1         n        n                          ∂xi        i
   A порядка n × n известны все собственные значения λ. Тогда в точной                                                                                                                                    i=1
                                                                                               −1                               ∼F(x)+δ(gradF(x);e)=F(x)+δcos(α)kgradF(x)kkek:
   арифметике итерационный метод с переменными параметрами τ = λ ,
                                                                                       k       k                                Отсюда следует, что в точке x наискорейшему убыванию соответствует
   k = 1;2;:::;n, не более чем за n шагов приведет к точному решению си-                                                                     α=−π,т.е. e=−gradF(x)=kgradF(x)k.
   стемы Ax=b.
                                                                                                                                                                       T                                              ∗
                                                                                                                           Лемма 15.2 Пусть A = A > 0 и решение системы Ax = b ищется
                                                                      k
 Доказательствоследует из разложения ошибки x−x при k = 0;1;:::;n                                                                     как точка минимума функционала F(x) = (Ax;x)−2(b;x) по следующему
   по базису из собственных векторов матрицы A.                                                                                              алгоритму:
 Отметим, что метод имеет теоретическое значение, так как требует n                                                                                                         k+1         k                        k
   умножений на матицу A и весьма чувствителен к вычислительной погреш-                                                                                                          x       =x −δk+1gradF(x );
                                                                                                                                                                                                                                      k+1
   ности. При этом задача нахождения собственных чисел в общем случае                                                                        где параметр δk+1 выбирается из условия минимума величины F(x                                                   ):
                                                                                                                                                    k    k         k   k
   существенно сложнее задачи решения системы линейных уравнений.                                                                            Тогда 2δk+1 = (r ;r )=(Ar ;r ).
Раздел 3.                                                                           87                   88                             Лекция 15. Вариационные методы решения слау
    Доказательство. Подставляя gradF(x) = 2(Ax−b) в выражение для                                            Доказательство.Параметрτ                минимизируетна(k+1)-мшагенорму
                                                                                                                              k+1
  k+1                                                                                                       k+1
x    , получаем                                                                                          kz     k , следовательно, с параметром τ оптимального линейного одноша-
                                                                                               A                                      0
  k+1      k              k           k         k                                      гового метода оценка не лучше:
 x     =x −2δ         (Ax −b)=x +τ             r ;
                  k+1                      k+1
                                                                                                        ′     k+1                       k                   k
                                                                                                   min      kz    k =k(I−τ          A)z k ≤k(I−τ A)z k ≤
   k            k                                                                                      τk+1        A            k+1       A            0       A
где τ     =2δ      ; r =b−Ax .Далее
      k+1      k+1                                                                                                                     k        M−m       k
                                                                                                   ≤kI−τ Ak kz k =                    kz k :
                                                                                                            0   A      A      M+m          A
 k+1           k         k     k          k           k
    F(x     ) = (A(x +τ        r );(x +τ       r )) −2(b;x +τ          r ) =
         k+1              k+1                    k+1 k
    k   k               k  k                k     2       k  k           k                            Здесь A-норма оператора перехода вычислена следующим образом:
    =(Ax ;x )+2τ          (Ax ;r )−2τ         (b;r )+τ       (Ar ;r )−2(b;x ):
     k+1                k+1            k+1
                                                                                                               (A(I−τ A)x;(I−τ A)x)         ((I−τ A)A1=2x;(I−τ A)A1=2x)
         ′     k+1                            k   k      k   k                                                  2                0        0                 0             0
Из условия F        (x    ) = 0 находим τ        =(r ;r )=(Ar ;r ).                                         kI −τ Ak =sup                              =sup                                 =
        τk+1                         k+1                                                                    0   A                (Ax;x)                        (A1=2x;A1=2x)
    Замечание. Найденные расчетные формулы можно переписать в виде                                                          x6=0                          x6=0
                                                                                                  ((I−τ0A)y;(I−τ0A)y)               2     M−m 2
                                                                                          =sup                        =kI−τ Ak =(              ) :
    k+1     k                             k  k                                                           (y;y)                 0    2     M+m
  x     −x          k                  (r ;r )                                               y6=0
              +Ax =b; τ            =             :
                               k+1        k   k
     τ                                (Ar ;r )
      k+1                                                                              При этом мы применили следующее
Соответствующий метод называется методом наискорейшего градиентного                                                                                                          T
                                                                                       Утверждение 15.1 Для произвольной матрицы A = A > 0 найдется
спуска.                                                                                                                                         T
                                                                                                            ˜         ˜     ˜           ˜˜                      ˜
                                                                                       такая матрица A, что A = A > 0, AA = A. Матрицу A называют
    Расчетные формулы данного метода также могут быть получены следу-                                                                                      1=2
                                                                                       квадратным корнем из A и обозначают A                .
ющим образом. Будем минимизировать на каждом шаге A-норму вектора
    k+1          k+1                                                                                                                                         T
ошибки z       =x−x .Напомним,чтовоптимальномлинейном одноша-                                                Метод минимальных невязок. ПустьA=A >0.Будемминимизи-
                                                                                                                       2                             k+1           k+1
говом методе минимизировалась норма оператора перехода kI −τAk2.                                         ровать на (k +1)-м шаге A -норму вектора ошибки z                  =x−x .
                                                                                                      k+1                   k
                                                                                           Так как z       =(I−τ        A)z ; то
              T                                                                                                     k+1
Лемма 15.3 ПустьA=A >0.Тогданаk-мшагеметоданаискорейшего
                                       k      p k k                                                       k+1 2                       k                  k
градиентного спуска минимизируется норма kz k =                    (Az ;z ) вектора                                      kz    k 2 = (A(I −τ        A)z ;A(I −τ        A)z ) =
                                         A                                                                     A              k+1                k+1
    k          k                                                                                                       k 2               2 k     k     2      2 k   2 k
ошибки z =x−x , где x  точное решение.                                                                                  =kz k 2 −2τ         (A z ;Az )+τ         (A z ;A z ):
                                                                                                               A       k+1                  k+1
               k+1                   k                                                                                                            k            k      k
    Действительно, так как z          =(I−τ        A)z ; то                                                  Отсюда, дифференцируя по τ              с учетом Az = b − Ax = r нахо-
                             k+1                                                                                              k+1
                                                                                                                 k+1 2                                     k  k       k    k
                                                                                       дим, что минимум kz           k 2 достигается при τ          = (Ar ;r )=(Ar ;Ar ).
k+1 2                      k                k                                                                         A                        k+1
        kz     k =(A(I −τ         A)z ;(I −τ       A)z ) =
     A             k+1              k+1                                                Итерационный процесс с таким набором параметров называется методом
    k   k              k     k      2        k     k
        =(Az ;z )−2τ          (Az ;Az )+τ         (AAz ;Az ):                                                                            k+1 2           k+1     k+1       k+1 2
               k+1                 k+1                                                 минимальных невязок, так как kz            k    =(Az       ; Az    ) = kr    k . Нами
                                                                                                                                    A2                                2
Отсюда, дифференцируя по τ            , находим, что на (k +1)-м шаге минимум                            доказана
                k+1
   k+1 2                                   k     k        k     k                  k
kz    k   достигается при τ         = (Az ;Az )=(AAz ;Az ). С учетом Az =                                                                   T
 A                      k+1                                                                       Теорема 15.2 Пусть A = A > 0. Тогда на k-м шаге метода минималь-
 k     k                   k   k      k   k                                                                                                              p
b−Ax =r имеемτ               =(r ;r )=(Ar ;r ).                                                                                                         k
       k+1                                                                                                                                           k    k
                                            k+1      p k+1 k+1                         ных невязок минимизируется норма kz kA2 =                 (Az ;Az ) вектора ошиб-
    Замечание. Минимизация евклидовой нормы kz                   k2 =     (z    ; z   )                       k          k
вектора ошибки приводит к неконструктивным формулам для параметра                                        ки z =x−x .
   k   k     k  k
τ     =(r ;z )=(r ;r ).                                                                                      Имеетместоследующаятеоремаобоценкескоростисходимостиметода.
 k+1
                  T                                                                                                       T
Теорема 15.1 Пусть A = A > 0 и λ(A) ∈ [m;M]. Тогда для систе-                                            Теорема 15.3 Пусть A = A > 0 и λ(A) ∈ [m;M]. Тогда для системы
мы Ax=bметод наискорейшего градиентного спуска сходится с любого                                         Ax=bметодминимальных невязок сходится с любого начального при-
начального приближения со скоростью геометрической прогрессии, и для                                     ближениясоскоростьюгеометрическойпрогрессии,идля вектора ошибки
вектора ошибки имеет место следующая оценка:                                                             имеет место следующая оценка:

  M−m k                                                                                                   M−m k
    k                       0            k          k      2                                               k                        0             k          k     2
 kz kA ≤     M+m kzkA; гдеz =x−x ; kzkA=(Az;z):                                                         kz kA2 ≤     M+m kzkA2; гдеz =x−x ; kzkA2 =(Az;Az):
Раздел 3.                                                                           89                   90                             Лекция 15. Вариационные методы решения слау
                                                                                                   −1                                                                (Cx;x)
    Доказательствосовпадает с доказательствомтеоремы о скорости сходи-                                        ˜        2
                                                                                       где x = B      x. Отсюда и из условия теоремы имеем оценку m1 ≤ (x;x) ≤
мости наискорейшего градиентного спуска, т.к. kI −τ Ak 2 = kI −τ Ak .
                                            0    A           0    2                    M1, следовательно, λ(C) ∈ [m1;M1]. Поэтому можно применить теорему о
    Скорость сходимости рассмотренных вариационных методов по поряд-                                     скорости сходимости оптимального одношагового метода и получить тре-
                                                           2
ку не хуже, чем у линейного одношагового метода, но в A- и A -нормах                                     буемую оценку для нормы вектора
соответственно. При этом для практической реализации данных методов
                                                                                                                  k 2       1  k    1 k         k   k
не требуется знание спектральных границ m;M матрицы A.                                                                           ky k2 = (B2z ;B2z ) = (Bz ;z ):
    Метод спектрально-эквивалентных операторов. Скорость сходи-
мостирассмотренныхитерационныхпроцессовзависелаототношенияm=M                                            Теорема доказана.
                  T                                                                        Аналогичностроятсянеявныеметодытипаминимальныхневязокиско-
границспектраматрицыA=A >0,тоестьотсвойствконкретнойзадачи.
Для"улучшенияисходнойзадачи"можноперейтикнекоторойэквивалент-                                            рейшего градиентного спуска.
ной системе B−1Ax = B−1b при условии невырожденности B:                                                      ПриудачномвыбореоператораB можно принципиально улучшить ско-
                                                                                       рость сходимости соответствующих итерационных процессов, однако необ-
          k+1     k                                                                                                                                   −1
        x     −x         −1    k      −1                                               ходимо учитывать трудоемкость нахождения y = B                    f. Например, при
            τ        +B Ax =B b:                                  (1)
             k+1                                                                       B = A, τ = 1 метод (2) сойдется за одну итерацию, но потребует решения
               −1                                                                      исходной задачи Ax = b.
Если явный вид матрицы B             не известен, то (1) удобно переписать в ка-                             Докажем общий результат о сходимости методов с предобусловливате-
нонической (по Самарскому) форме:                                                                        лем.
                k+1     k
              x     −x          k                                                      Теорема 15.5 Пусть
            B τ           +Ax =b:                                 (2)
                  k+1
                                                                                                                      T                        τ
Данныйметодтакженазываютметодом с предобусловливателем B.Неяв-                                                                  A=A >0; τ>0; B−2A>0:
ныйдвухслойныйитерационныйпроцесс(2)требуетна каждомшагереше-
ниязадачвидаBy =f исовпадаетсрассмотреннымиметодамиприB =E.                                              Тогда обобщенный метод простой итерации
                T              T                (Ax;x)                                                                   k+1      k
Теорема 15.4 Пусть B = B >0, A=A >0иm1 ≤ (Bx;x) ≤M1.Тогда                                                                                 x     −x          k
                                                                                                                     B       τ      +Ax =b
для τ =      2    метод сходится со скоростью геометрической прогрессии
   m +M
     1   1
     M −m
с показателем q =       1    1, и для вектора ошибки имеет место следующая                                                                   0
     M +m                                                                              сходится для произвольного x .
      1    1
оценка:
               1  k+1           1 k
            kB2z      k2 ≤ qkB2z k2.                                                       Доказательство. Отметим, что det(B) 6= 0. Докажем сходимость ме-
    Доказательство. Выпишем уравнение для вектора ошибки:                                                тода. Перепишем уравнение для вектора ошибки
                                                                                                                          k+1     k
    k+1                k      1 k+1       1 k        −1     −1   1 k                                                                z    −z          k
 Bz      =(B−τA)z ⇒B2z               =B2z −τB 2AB 2B2z ⇒                                                                         B      τ      +Az =0
  k+1             −1     −1   k                 1                                      в виде
y     =(I−τB 2AB 2)y ;              где y = B2z:                                                                 τ                    τ
                                                                                                                        k+1     k          k+1      k
Такимобразом, для вектора yk данный метод соответствуетлинейному од-                                                         (B− 2A)(z        −z )+ 2A(z          +z )=0;
                             −1     −1        T
ношаговому методу с матрицей C = B 2AB 2 = C . Оценим границы                                                                        2   k+1     k
спектра C. Имеем                                                                                         умножим скалярно на τ(z             −z ) и, используя симметрию A, получим
                                                                                       энергетическое тождество:
                   −1     −1
                     2      2            ˜ ˜
    (Cx;x) = (B       AB x;x) = (Ax;x);                                                       k+1 2       k 2     2        τ      k+1     k     k+1     k
                                         ˜ ˜                                                kz    kA−kz kA+ ((B− A)(z                 −z );(z       −z ))=0 ∀k≥0:
     (x;x)            (x;x)           (Bx;x)                                                                      τ        2
 Раздел 3.                                                                               91                    92                               Лекция 15. Вариационные методы решения слау
  k+1       k                                                           k
 Если z       = z , то из уравнения для вектора ошибки имеем z = 0, т.е.                                           Доказательство. Отметим, что условие строгого диагонального пре-
             k+1      k
 решение найдено. Если z            6=z , то из энергетического тождества и усло-                              обладания влечет (см. теорему Гершгорина) невырожденность матрицы A.
    τ                                                                      k+1                                                                                        k+1       k
 вия B− 2A>0следует монотонное ограниченное убывание 0 ≤ kz                           kA <                     Запишем уравнение для вектора ошибки (D+L)z                       +Rz =0.Выпишем
   k                                                              k
 kz kA и существование предельного значения для kz kA при k → ∞. По-                                           i-е уравнение
k
 кажем, что kz kA → 0 при k → ∞. Перейдем к пределу в энергетическом                                                                  i−1                            n
 тождестве. Получим                                                                                                                   Paijzk+1+aiizk+1+ P aijzk =0
                                                                                                                             j           i                  j
                                                                                                                    j=1                         j=i+1
           τ      k+1      k     k+1      k
      (B− 2A)(z         −z );(z        −z ) →0:                                              и разрешим его относительно zk+1 :
                                                                                                                                    i
              τ                        k+1     k
 ОтсюдаиизусловияB− A>0следует,чтоz                           −z сходитсякнулевому                                                                 i−1                n
 k+1      k   2                 k       1   −1     k+1      k                                                         zk+1 = − P aij zk+1 − P aij zk:
 вектору, т.е. kz       −z kA → 0. Далее z = −τA B(z                      −z ), поэтому                                                  i         j=1 aii   j      j=i+1 aii   j
   k         1    −1             k+1      k                                  k
 kz kA ≤ τkA kAkBkAkz                 −z kA → 0. Таким образом kz kA → 0, и
 метод сходится. Теорема доказана.                                                                             Отсюда получим
     Метод Зейделя. Представим матрицу системы Ax = b в виде A =
                                                                                                                             i−1                   n
 L+D+R,гдеDдиагональнаяматрица, L и R  соответственно левая                                                                        |zk+1| ≤ P |aij||zk+1| + P |aij||zk| ≤
 нижняя и правая верхняя треугольные матрицы с нулевыми диагоналями                                                                    i            aii    j              aii    j
                                                                                                                             j=1                 j=i+1
 (строго нижняя и строго верхняя треугольные матрицы). Итерационный                                                                               i−1                    n
 метод (2) при B = D + L, τ = 1 называется методом Зейделя (Гаусса–                                                                  ≤kzk+1k∞ P |aij|+kzkk∞ P |aij|:
                                                                                                                                     aii                    aii
 Зейделя)                                                                                                                                         j=1                  j=i+1
                  k+1      k        k
      (D+L)(x          −x )+Ax =b; т.е.                                                      Так как соотношение верно для всех i, следовательно, оценка верна и для
                 k+1        k                                                                            k+1
      (D+L)x          +Rx =b:                                                                нормы kz        k∞. В результате имеем
                  T                                                                                                       P aij       k+1           k    P aij
 Теорема 15.6 Пусть A = A > 0. Тогда метод Гаусса–Зейделя сходится                                                                    (1 −j<i|aii|)kz       k∞≤kz k∞j>i|aii|:
 с любого начального приближения.
                                  τ                                                          По условию теоремы
     Доказательство. Проверим, что B− A>0. С учетом LT =R имеем:
                                  2                                                                                 P|aij| ≤ q − P |aij| ≤ q(1− P |aij|);
                                                                                                                         aii              aii                aii
                                                                                                                    j>i              j<i                j<i
((D+L−1A)x;x)= 1(Dx;x)+ 1(Lx;x)− 1(Rx;x)= 1(Dx;x):
  2             2            2             2             2                                                         k+1             k          k            k−1                 k   0
                                                                                             следовательно, kz         k∞ ≤ qkz k∞ и kz k∞ ≤ qkz               k∞ ≤ ::: ≤ q kz k∞:
 Так как (Ax;x) > 0, то (Ae ;e ) = a > 0 и (Dx;x) > 0.                                                         Теорема доказана.
                i  i      ii                                                                     МетодЯкоби.ПустьA=D+L+R.Рассмотримитерационныйпроцесс
 Теорема 15.7 ПустьматрицаAобладаетсвойствомстрогогодиагональ-                                                 (2) с матрицей B = D и τ = 1:
 ного преобладания, т.е. справедливо                                                                                                            k+1     k         k
                                                                                                                         D(x      −x )+Ax =b; т.е.
                                                                                                                            k+1               k
      X                                                                                                                  Dx      +(L+R)x =b:
          |aij| ≤ q|aii|; i = 1;:::;n;     q < 1:                                            Теорема 15.8 Пусть матрица A обладает свойством диагонального пре-
      i6=j
                                                                                             обладания с коэффициентом q. Тогда метод Якоби сходится с любого на-
 Тогда метод Гаусса–Зейделя сходится с любого начального приближения,                                          чального приближения, и для вектора ошибки верна оценка
 и для вектора ошибки верна оценка:
                    k        k         0                                                                                          k         k         0
            kx−x k∞≤q kx−x k∞:                                                                                             kx−x k∞≤q kx−x k∞:
    Раздел 3.                                                                                                              93                           94                                         Лекция 16. Проекционные методы решения слау
                                                     k+1                      k
   Доказательство. Из уравнения Dz                                    +(R+L)z = 0 для вектора                                                          Определим K = L = {ei} для i = 1;:::;n, где ei  естественный i-й
             k+1           k                                                                                                                                                                n
    ошибки имеем z                   =Sz , где                                                                                                          базисный вектор пространства R , и выполним n шагов. Последовательно
                                                                                                                                                 ˆ                                                                   P
                                                                                                                                    имеемx=x+ce,(b−A(x+c e );e )=0,т.е.b −                                              a x −xˆ a = 0.Отсюда
                                                                                                                                                              i  i                   i  i     i                  i          ij  j     i  ii
                  0          a12=a11        a13=a11               : : :        a1n=a11                                                                                                                               j6=i
                                                                                                                                    находим xˆ при известных компонентах x , j = i;i + 1;:::;n и найденных
             a21=a22              0         a23=a22               : : :        a2n=a22                                                                 i                                                   j
        S =−                                                                                           :
                                                                                                                                    x , j = 1;2;:::;i − 1. Таким образом, за n шагов проекционного алгоритма
                  :               :               :                :                 :                                                  j
                                                                                                                                                                       n
            an1=ann         an2=ann             : : :      ann−1=ann                0                                                              k+1          k     P
                                                                                                                                      имеем x             =x +             ciei, что соответствует шагу метода Гаусса–Зейделя:
                                                                                                                                                                      i=1
    Отсюдаиусловиятеоремынаходимоценкудлянормыоператораперехода:                                                                                                       k+1           k
                                                                                                                                      (D+L)x               +Rx =b:
    kSk∞ ≤q <1.                                                                                                                                               Экстремальное свойство проекционного алгоритма. Нам потре-
   Метод верхней релаксации. Методомверхней релаксации называет-                                                                                 буется следующая проекционная теорема.
    ся итерационный процесс (2) с матрицей B = (D +ωL):
                                                                                                                                                                                                                             ˆ
                                                                                                                                      Теорема 16.1 Дляпроизвольного вектора z вектор k являетсярешением
                                        k+1         k
                                      x       −x               k                                                                      следующей задачи минимизации
                      (D+ωL)                 τ         +Ax =b:
                                                                                                                                                                                      min(z−k;z−k)
    Здесьитерационныйпараметрωназываетсяпараметромрелаксации(обыч-                                                                                                                                      k∈K
    ноω=τ).МетодыЯкоби(ω=0;τ =1)иГаусса–Зейделя(ω =τ =1)также                                                                                                                                                   ˆ
    являются методами релаксации.                                                                                                                       тогда и только тогда, когда (z−k;v) = 0 для ∀v ∈ K.
                                   T
    Теорема 15.9 Пусть A = A > 0. Тогда метод верхней релаксации при                                                                                          Доказательство. Рассмотрим разложение z = Pz+(z−Pz), где Pz ∈
    0 < ω = τ < 2 сходится с любого начального приближения.                                                                                             K, z − Pz ∈ K⊥ (в этом случае P называют оператором ортогонального
   Доказательство следует из оценки B − τA > 0.                                                                                                  проектирования на K). Тогда
                                                            2
                                                                                                                                         (z−k;z−k)=kz−kk2=kz−Pz+Pz−kk2=kz−Pzk2+kPz−kk2;
      Лекция16.Проекционныеметодырешенияслау                                                                                                            т. е. kz − kk2 ≥ kz−Pzk2, равенство возможно лишь при k = Pz.
                                                                                                                                                                                        T                                                    ˆ
    Эффективнымиметодамирешениясистемылинейныхалгебраическихурав-                                                                                       Теорема 16.2 Пусть A = A > 0 и L = K. Тогда вектор x является
  ∗                                                                                                                                   результатом проекционного алгоритма тогда и только тогда, когда
    нений Ax =b большой размерности являются итерационные методы про-
    екционноготипа.Накаждомшагетакогометодареализуетсяпроекционный                                                                                                                                                              ∗            ∗                 ∗
                                                                                                                                                     ˆ                     ˜                  ˜                     ˜            ˜
    алгоритм:                                                                                                                                                     E(x) = ˜min E(x);                   где E(x) = (A(x −x);x −x) ; Ax = b:
   в зависимости от текущего приближения x ∈ Rn и номера итерации                                                                                                       x∈x+K
    выбирают два m-мерных (m ≤ n) подпространства K и L; следующее при-                                                                                       Доказательство. Из проекционной теоремы следует, что решение за-
   ˆ                                     ∗                      ˆ                                                                                                                            ∗
    ближениеxкточномурешениюx ищутввидеx=x+k,k∈Kизусловия                                                                                               дачи min(z−k;z−k) для z = x −x, где (u;v) = (Au;v) эквивалентно
                                                                                                                                               k∈K                        A                                            A
                   ˆ
    r ⊥ L, где r = b−Ax.                                                                                                                                нахождениювектораkизусловия(z−k;v) =0 ∀v∈K,чтосоответствует
   Таким образом, основная идея данного подхода заключается в постро-                                                                                                                                                  A
    ении вектора поправки k из подпространства K, обеспечивающего ортого-                                                                               определению проекционного алгоритма:
    нальность вектора невязки r подпространству L. Различные правила выбо-                                                                                                                        ∗                                      ˆ
                                                                                                                                                  (z−k;v) =(A(x −(x+k));v)=(b−Ax;v)=0 ∀v∈K:
    ра подпространств K и L приводят к различным расчетным формулам.                                                                                                               A
                                                                                                                                                                                                         ∗                  ˆ
    Пример 16.1. Покажем, что метод Гаусса–Зейделя решения систем ли-                                                                                   Такойподходкаппроксимациивектораx векторомxназываетсяметодом
                                                                                                                                                                    ˆ
    нейных уравнений является проекционным методом.                                                                                                     Галеркина: (b−Ax;v) =0 ∀v ∈ K.
    Раздел 3.                                                                                                              95                           96                                         Лекция 16. Проекционные методы решения слау
                                                                                          ˆ                                                                                          (m)
    Теорема 16.3 ПустьAневырожденаиL=AK.Тогдавекторxявляется                                                                                            (при этом формально{ci = ci                         }, т.е. коэффициенты могут изменяться при
    результатом проекционного алгоритма тогда и только тогда, когда                                                                                     увеличении m). Рассмотрим эквивалентную, но более удобную с практиче-
         ˆ                      ˜                 ˜               ∗     ˜          ∗     ˜            ∗                                          ской точки зрения реализацию этого алгоритма.
     E(x) = min E(x);                   где E(x) = (A(x −x);A(x −x)) ; Ax = b:                                                                         ПустьвпространствеKm =span{k ;:::;k }известенA-ортогональный
      ˜                                                                                                                                                                                             1           m
      x∈x+K                                                                                                                                                                                                                                       m
                                                                                                                                                                                                               0                m          0     P
                                                                                                                                      базис, т.е. (Ak ;k ) = 0 при i 6= j и k = r . Тогда x                                         = x +             α k и
    Доказательствосовпадаетсдоказательствомпредыдущейтеоремысточ-                                                                                                               i    j                                  1                                                 i   i
                                                                                            T                                                                                                                                                    i=1
    ностью до замены скалярного произведения на (u;v) T                                              = (A Au;v) =                                                                                        m
                                                                           A A
                                                                                                                                        m                  m                     0     P                                                            m         m
    (Au;Av). При этом по условию v ∈ K, Av ∈ L. Такой подход к аппрок-                                                                                  r     =b−Ax =b−A x + αk .Вэтомслучаеизусловияr ⊥L
                                                                                                                                                                                              i  i
                 ∗                  ˆ                                                                                                                                                  i=1
    симации вектора x вектором x называется методом Петрова–Галеркина:                                                                                  имеем формулы для определения коэффициентов
        ˆ
    (b−Ax;v)=0 ∀v∈AK.                                                                                                                                                                                                                    0
   Одномерные проекционные методы. В простейшем случае в каче-                                                                                                                                                                 (r ;k )
                                                                                                                                                 m                0                                                          j
                                                                                                                                              (r ;k ) = (r ;k )−α (Ak ;k ) = 0; α =                                               ; j = 1;:::;m:
    стве базовых пространств K и L выбирают одномерные подпространства.                                                                                                   j               j        j       j    j             j      (Ak ;k )
                                                                                                                                                                                                                         j    j
    Лемма 16.1 Проекционный алгоритм при K = L = {r}, где r = b−Ax,                                                                                     Таким образом, коэффициенты α ;α ;::: не зависят от выбора m, поэто-
                                                                                                                                                                                              1    2
    соответствует методу наискорейшего градиентного спуска.                                                                                                                                                                                       m          m−1
                                                                                                                                      му могут быть найдены последовательно из условия x                                            =x            +α k .
                                                                                                                                                                                                                                                        m m
                                                                                                                                                                      m        m−1                                     m−1
                                                                                                                                      Отсюда получаем r =r                            −α Ak иα =(r                           ; k    )=(Ak ;k ). Для
                                                                                                       ˆ                                                                                    m m              m                   m           m m
   Доказательство. Пространства K и L одномерны, следовательно, x =                                                                              вычислений такая рекуррентная форма записи предпочтительнее.
    x+τr, и τ определяется из условия ортогональности (b−A(x+τr);r) = 0.                                                                                      Построим соответствующий рекуррентный алгоритм для определения
    Отсюда имеем (r−τAr;r) = 0 и τ = (r;r)=(Ar;r).                                                                                                      {k }, т.к. стандартная процедура типа Грама–Шмидта, требующая хране-
                                                                                                                                          i
                                                                                                                                      ниявсехэлементовбазиса{k }m ,вданномслучаеоказываетсясуществен-
    Лемма 16.2 Проекционный алгоритм при K = {r} и L = {Ar}, где r =                                                                                                                                   i i=1
                                                                                                                                                                                          m+1          m+1
    b−Ax, соответствует методу минимальных невязок.                                                                                                     но менее эффективна. Имеем K                               =L            =
   Доказательство. В терминах предыдущей леммы находим, что τ =                                                                                               n           0            m−1 0	           m 0o                n                                        o
                                                                                                                                         =span span r ;:::;A                        r     ; A r        =span span{k ;:::;k };k                               :
                                                                                                                                                                                                                                1          m        m+1
    (Ar;r)=(Ar;Ar).
   Проекционные методы в пространствах Крылова. Пусть про-                                                                                                                                                     m
                                                                                                                                                                                        m 0        P˜
                                                              1         2                  m                                          Отсюда следует, что k                       =A r +                β k . Заметим, что
    странства L зависят от номера итерации и L ⊂ L ⊂ ::: ⊂ L                                                      ⊂ ::: ⊂                                                                    m+1                            i  i
n        n                                                                                                                                                                                                    i=1
    L =R .Тогдаточноерешениесистемыбудетполученонепозже,чемзаn                                                                                                                                           m                              m
                             m                                                                                                                                      m        0         P i−1 0                 0      P i 0
    шагов. Если же цепочка L                       задается некоторым оптимальным образом, то                                                                                       r     =r −Ai=1ciA                   r =r −i=1ciA r ;
                                                                 ∗        m                       ∗                                                                      m
    можно расчитывать, что требуемая точность kx −x k ≤ ε, где Ax = b,                                                                                  следовательно, при r                    6= 0 и c          6= 0 вектор k                  можно искать в ви-
                                                                                                                                                                                           m                           m+1
                                                                                                                                                                   m
    будет достигнута значительно раньше.                                                                                                                                     m      P
                                                                                                                                      де k           =r +              β k . Умножим данное соотношение на Ak . С учетом
   Эффективные алгоритмы удается построить, если в качестве простран-                                                                                   m+1                         i  i                                                                j
        m                                                            m                                 m−1                                                                   i=1
    ства K          выбрать пространство Крылова K                               = span{r;Ar;:::;A                  r} по-                                                                                             m
                                                                                                                                      (k ;Ak ) = 0 при i 6= j, получим 0 = (r ;Ak )+β (k ;Ak ). Покажем, что
                                                                                                                                          i      j                                                             j        j    j       j
                            0                                             m                                                              m                                                                                        m
    рядка m для r = b − Ax . При этом пространство L                                            определяется либо                                       (r ;Ak ) = 0 для i < m. По построению пространства L                                            имеем
                                                                                                                                                  i
       m         m               m           m
    как L =K , либо L =AK .                                                                      T
   Метод сопряженных градиентов. Пусть A = A > 0. Построим
                                                                                                                                                                                                        0        0           m−2 0
                                                                                                                                                           span{k ;:::;k                 } = span r ;Ar ;:::;A                       r    ,
    проекционный метод для пары пространств                                                                                                                                              1           m−1                    0         0           m−2 0
                                                                                                                                                    A(span{k ;:::;k                   }) = A span r ;Ar ;:::;A                          r       =
                                               	                                                                                                                   1           m−1
m                 0       0           m−1 0               m         m        0                 0                                                                                     0     2 0             m−1 0	            m
        K =span r ;Ar ;:::;A                           r     ;    L =K ; r =b−Ax ;                                                                                              =span Ar ;A r ;:::;A                         r     ⊂L .
                                                                       m
                                                                       P                                                                                                     m                                                                      m         m
                                                      m         0                i−1 0                                                Следовательно,Ak ∈L приi=1;:::;m−1.Отсюдаиизусловияr ⊥L
    очередное приближение найдем в виде x                                   = x +             ciA       r , а коэффи-                                                                  i
                                                                                                                                                    m                                                                                          m
                                                                      i=1                                                             имеем (r ;Ak ) = 0 для i < m, т.е. β = 0 при i < m и k                                             =r +β k .
                                         m                    m          m                                                                                   i                                    i                               m+1                   m m
    циенты c определим из условия r                            =(b−Ax )⊥L .Такаяформаалго-                                                                                                                                         m
 i                                                                                                                                                                                                            (r ;Ak )
                                                                                                                                      Из данного представления находим β                               =−                 m .
    ритма для нахождения {ci} требует решения системы линейных уравнений                                                                                                                                             m          (Ak ;k )
                                                                                                                                                                                                                    m m
 Раздел 3.                                                                                       97                      98                                      Лекция 17. Задачи на собственные значения
                                                                                                                                   Q
                                                                                                               N             N        N                0
      Таким образом расчетные формулы имеют вид:                                                                         Для z      имеем z       =         (1 −τ A)z и следующую оценку:
                                                                                                               ch            ch       i=1        i
                             m−1
                          (r      ; k  )
m       m−1                                     m
      x =x           +α k ; α =                           ;                                                                                          N                              N
        m m         m
                          (Ak ;k )                                                                                                Y                               Y
                               m m                                                                                    N                                0                              0
                              m                                                                                    kz k ≤k           (1 −τ A)k kz k =k               (1 −τ A)k kz k ≤
                            (r ;Ak )                                                                                  ch A                   i    A       A                 i     2      A
m                                    m              0
      k      =r +β k ; β =−                                ; k =r :                                                                                 i=1                            i=1
m+1               m m         m       (Ak ;k )          1
                                m m                                                                                                                                       √        √
 Замечание. На шаге m данного метода минимизируется A-норма вектора                                                                                2                                           M− m
                                      m                                                                                                    0          N 0                 √
                                                                                                                        ≤               kz k ≤2q kz k ;             q =            √ :
 ошибки на подпространствах Крылова K , поэтому с точки зрения проек-                                                                        q−N +qN           A        1       A      1       M+ m
 ционныхметодовметодсопряженныхградиентовявляетсяобобщениемме-                                                                                1        1
 тода наискорейшего градиентного спуска. Метод сопряженных градиентов                                                    Теорема доказана.
 минимизирует значение функционала F(x) = (Ax;x)−2(b;x) на векторах                                                      Утверждение 16.1 В методе сопряженных градиентов необходимыми и
      m
   m       0    P i−1 0                                                                                                                                                                      m            m m
 вида x      =x +          ciA     r относительно ci.                                                                    достаточными условиями минимума функционала F(x ) = (Ax ;x )−
     i=1                                                                                                       m                                                               m j
                                                                                                       2(b;x ) для любого m ≥ 1 являются равенства (r ;r ) = 0 при j =
                      T                                                                                0;1;:::;m−1.
 Теорема 16.4 Пусть A=A >0. Тогда метод сопряженных градиентов
 сходится с любого начального приближения, и имеет место следующая                                                       Утверждение 16.2 В методе сопряженных градиентов для любого m ≥
 оценка скорости сходимости                                                                                                                                                                      m j
                                               √        √                                              2 имеют место соотношения ортогональности (Ar ;r ) = 0 при j =
      N               2         0                 M− m                                                 0;1;:::;m−2.
    kz k ≤                   kz k ;     q = √           √ ;
          A     q−N +qN           A       1       M+ m
                 1        1
 N       ∗     N       ∗                                                                                            Лекция 17. Задачи на собственные значения
 где z     =x −x ,Ax =bиλ(A)∈[m;M].
      Доказательство. Сравним задачи минимизации ошибки, соответству-
 ющие методу сопряженных градиентов и оптимальному линейному N-ша-                                                       Напомним, что ненулевой вектор e, удовлетворяющий условию Ae = λe
 говому методу, принимая во внимание, что оптимальный N-шаговый про-                                                     называется собственным вектором, при этом λ называется собственным
 цесс представляет собой метод простой итерации с чебышёвским набором                                                    числом. Многочлен P(λ) = det(A − λI) называется характеристическим
                                            k                                                          многочленом матрицы A, его корни суть собственные числа. Матрица A
 параметров. Для нахождения приближения x                        имеем
                                            ch                                                         называется матрицей простой структуры, если ее собственные вектора
         k      k−1                                                                                    e ;e ; ::: ;e     образуют базис в Cn.
       x −x                 k−1                                                                          1   2         n
         ch     ch    +Ax         =b; k=1;:::;N:
             τ              ch                                                                             ПустьSпроизвольнаяневырожденнаяматрица.Говорят,чтоматрицы
              k                                                                                        одинаковой размерности A и B = S−1AS подобны, а матрица S осуществ-
 Отсюда следует                                                                                                          ляет подобие.
      k       k−1         k−1       k      k−1           k−1
    x =x           +τ r       ;   r    =r       −τ Ar                                                                                                                                                n×n
      ch      ch       k ch         ch     ch       k    ch                                            Утверждение 17.1 Дляпроизвольной вещественнойматрицыA∈R
                                                              P                                        найдется вещественная ортогональная матрица Q ∈ Rn×n такая, что
                                                 N       0       N       i−1 0
 при k = 1;2;:::;N. По индукции получаем, что x                       =x +             cˆ A    r :
                                                 ch              i=1 i
    N                                                                                                                                                                          
 Приближение x            метода сопряженных градиентов по определению имеет                                                                                         R       R      : : :  R
    sg                                                                                                                                                11     12            1m
    P
  N       0       N        i−1 0                                            N       N
 вид x      =x +             c A      r : Отсюда следует, что вектора x                и x     при-                                                               0         R      : : :  R      
  sg              i=1 i                                                     ch      sg                                                  QTAQ=R=                        22            2m ;
 надлежат одному и тому же подпространству Крылова и могут отличаться                                                                                             :         :      : : :  :      
                                          N                                                                                                        0       0      : : :  R
 только коэффициентами. Так как вектор x                        является решением задачи                                                                                                     mm
                                          sg
                 N N             N       ∗      N
 минимизации           min      Az ;z       , где z     = x −x , то справедливо нера-
  xN∈x0+K                                                                                              где каждый диагональный блок R (m ≤ n) представляет собой либо ве-
 венство                                                                                                                                                               ii
       N N                       N N  N N                                                        щественное собственное значение, либо 2 × 2-матрицу, отвечающую со-
    Az ;z        = min Az ;z ≤ Az ;z :
        sg   sg     xN∈x0+K                          ch   ch                                           пряженной паре комплексных собственных значений.
 Раздел 3.                                                                               99                    100                                  Лекция 17. Задачи на собственные значения
    Матрицу R называют действительной формой Шура, из которой мож-                                             Теорема 17.1 Пусть A  матрица простой структуры. Пусть |λ | >
                                                                                                                                                                                   1
 но легко определить собственные векторы и собственные числа исходной                                          |λ | ≥ |λ | ≥ ::: ≥ |λ | и L  линейная оболочка e ;e ;:::;e : Тогда для
                                                                                               2        3               n                                     2  3       n
                                                                                                                                        0                                   k
 матрицы.                                                                                                      степенного метода при условии x ∈= L справедлива оценка λ = λ +
                                                                                                                                                                                    1
                                                                                             O(|λ =λ |k):
 Лемма 17.1 Пусть B = S−1AS, т.е. матрицы подобны. Тогда λ = λ ,                                                    2   1
                                                                B      A
 e =S−1e .                                                                                                                                          0    Pn
  B          A                                                                                                     Доказательство. Пусть x =               i=1 ciei. Тогда
    Доказательство. Собственные значения B находим из условия                                                                           n                                   n
                                                                                                     k        k      X k            k+1        k+1       X k+1
                                                                                                    x =c1λ e1+           ciλ ei; x       =c1λ      e1 +      ciλ     ei; c1 6= 0:
 0 = det(B −λI) = det(S−1AS −λS−1S) = det(S−1(A−λI)S) =                                                                  1              i                 1                 i
          −1                                                                                                                    i=2                                 i=2
 =det(S      )det(A−λI)det(S) = det(A−λI):                                                              Отсюда следует, что
 Собственные значения матриц A и B совпадают, так как равны характери-

                                                                                                                    n
                                                                                                                                                                  k
 стические многочлены. Из условия Ae = λe имеем                                                                           k   k      P         k k              2k 2          λ
                                                                                                     (x ;x ) =          c c λ λ (e ;e ) = λ c 1+O               2      ;
                                                                                                                         i j i j    i  j      1   1          λ
                                                                                                                  i;j=1                                         1
   S−1ASS−1e=λS−1e; BS−1e=λS−1e;                                                                                       n                                               k
                                                                                                        k+1    k      P         k+1 k               2k+1 2          λ
                                                                                                     (x     ; x ) =       c c λ     λ (e ;e ) = λ        c  1+O         2      :
                                                                                                                           i j i     j   i   j      1     1          λ
 т.е. собственные векторы e         и e   связаны соотношением e =S−1e .                                                               i;j=1                                              1
               A     B                                B          A
 Лемма 17.2 Пусть A  симметричнаяматрица размерности n×n, λ∈                                                                k+1    k
                                                                                             Поэтому (x        ; x ) = λ +O |λ =λ |k : Теорема доказана.
 R1; x ∈ Rn  соответственно произвольное число и вектор, причем                                                              k   k        1          2   1
                                                                                                          (x ;x )
 ||x||  = 1: Тогда существует собственное значение λ матрицы A; для
     2                                                              k                                          Следствие 17.1 Если в условии Теоремы 1 матрица A является сим-
 которого |λ −λ| ≤ ||Ax−λx|| :
        k                      2                                                                                                                                                       k
                                                                                             метричной, то для степенного метода справедлива оценка λ                          = λ +
                                                                                                                                                                                    1
    Доказательство. Пусть {ek}; k = 1;:::;n  полная ортонормирован-                                           O(|λ =λ |2k):
                                               n                                                  2   1
 ная система собственных векторов матрицы A, x = Xckek. Тогда                                                      Доказательство в точности повторяет доказательство предыдущей тео-
                                              k=1                                            ремы. Более сильная скорость сходимости получается из-за ортонормиро-
                 n                                                                           ванности (ei;ej) = δij базиса {ei}.
           2    X            2 2                  2     2
         ||Ax−λx|| =           (λ −λ) c ≥min(λ −λ) kxk :
           2          k         k     k    k            2                                    Следствие 17.2 ПустьматрицаAразмерностиn×nимеетnразличных
                k=1
                                                                                                                                                                    0
    Так как малые изменения элементов матрицы могут приводить к суще-                                          по модулю собственных значений. Предположим, что x принадлежит
                                                                                             линейной оболочке некоторых собственных векторов ei , ei , :::, ei , но не
 ственным изменениям собственных значений и определителя (см. пример                                                                                                               1   2         t
 для матрицы Уилкинсона), то задача нахождения собственных значений                                            принадлежит никакой их линейной подоболочке. Тогда итерации степен-
 относится к числу неустойчивых, а алгоритмы ее решения, основанные на                                         ного метода в точной арифметике сходятся к максимальному по модулю
                                                                                             λ из λ ; 1 ≤ k ≤ t.
                                                                                                     i
 приближенном построения характеристического многочлена и вычислении                                                   k
 его корней, на практике обычно не применяются.                                                                Причисленныхрасчетахкакправило(конечно,возможноисключение:A =
    Степенной метод. Алгоритм вычисления максимального по модулю                                                2 0            0         T
 собственного значения λ матрицы A имеет вид                                                                      0 1      ;   x =(0;1) ) имеется ненулевой (возможно близкий к машин-
                                                                                                                                                         0
                      k+1    k                                                               нойпогрешности)коэффициентc1 вразложенииx повекторамei,поэтому
         k+1        k     k    (x    ; x )    k
        x     =Ax ; λ =                    ; x 6= 0; k = 0;1;2;::::                                     методсходитсякλ кмаксимальномупомодулюсобственномузначению.
                        k   k                                                                                      1
                     (x ;x )                                                                 Сходимость к следующему по абсолютной величине λ можно обеспечить
                                                                                                                                                               2
 При его практической реализации на каждом шаге нормируют текущий                                              только постоянным исключением каким-либо способом вектора e1 из оче-
     k      k     k                                                                                                                  k                                       ˜
 вектор: x := x =kx k2.                                                                                        редного приближения x . Например, можно вычислить e1  собственный
Раздел 3.                                                                       101                  102                               Лекция 17. Задачи на собственные значения
                  T
вектор сопряженной матрицы A , соответствующий λ , и ортогонализовы-                                 (например, графически), что оптимальное значение c = (λ +λ )=2. Ана-
                                          1                                                                                                    1      2    n
k   ˜
вать x к e .                                                                                         логично c = (λ +λ           )=2. Скорость сходимости степенного метода при
     1                                                                                                   n       1    n−1
   Метод обратной итерации. Этот метод, по сути соответствующий                                      оптимальном сдвиге зависит от λ ;:::;λ и не может стать сколь угодно
                                                                                                                         1       n
                    −1                                                             высокой за счет параметра сдвига.
степенномуметодудляматрицыA ,применяютдлявычислениянаимень-
шего по модулю собственного значения λ:
                                        k   k+1                                    Теорема 17.5 Пусть собственные значения симметричной матрицы A
          k     k    k        k+1     k    k     (x ;x    )
        x :=x =kx k2; Ax          =x ; λ =        k+1   k+1 :                                 удовлетворяют цепочке неравенств λ < λ < ::: < λ . Тогда метод об-
                                    (x    ; x    )                                                                            1      2           n
                                                       k+1     k                   ратной итерации со сдвигом
ПриэтомнакаждомшагеалгоритматребуетсярешатьсистемуAx                         =x .
                                                                                                                                          k   k+1
Теорема 17.2 Пусть A  матрица простой структуры. Пусть |λ | ≥                                                                     k+1     k   k         (x ;x     )
                                                             1                                        (A−cI)x        =x ; λ =c+ k+1 k+1
|λ | ≥ |λ | ≥ ::: ≥ |λ   | > |λ | и L  линейная оболочка e ;e ;e ;:::;e           :                                                                    (x    ; x   )
  2      3            n−1       n                             0  1   2  3      n−1
Тогда для метода обратной итерации при условии x ∈= L справедлива                                    в зависимости от параметра c сходится к λ , для которого справедливо
  k                       k                                                                                                                       t
оценка λ = λ +O(|λ =λ           | ):                                                                                                                                 2n
        n        n   n−1                                                                      |λ −c| = min|λ − c|. Скорость сходимости равна O(q ), где q = |λ −
                                                                                     t           i    i                                                            t
                                                                                   c|=min|λ −c|. Процесс в зависимости от значения c может сходиться к
   Степенной метод и метод обратной итерации можно также применять                                       i6=t  i
к матрице A − cI, что позволяет влиять на сходимость. Например, если                                 любому λ . При этом q → 0, если c → λ .
                                ˜                                                             t                                 t
с высокой точностью известно приближение λ к некоторому собственному
                                                  ˜                                Скорость сходимости метода обратной итерации со сдвигом можно значи-
значению λ, то метод обратной итерации с параметром c = λ обычно схо-
дится за 1-2 итерации. Скорость сходимости существенно замедляется при                               тельно повысить, если изменять значение сдвига от шага к шагу. Рассмот-
вычислении одного из группы близких собственных значений.                                            рим функцию R (x) = (Ax;x), называемую отношением Рэлея.
                                                                                                     A         (x;x)
Теорема 17.3 Пусть собственные значения симметричной матрицы A                                                                        T
удовлетворяют цепочке неравенств λ < λ < ::: < λ . Тогда итерацион-                                  Теорема 17.6 Пусть A=A : Тогда
                         1     2           n
ный процесс                                                                                                          λ     (A) = maxR (x);       λ    (A) = minR (x):
                                    k+1   k                                                          max        x6=0  A         min        x6=0  A
   k+1              k    k        (x    ; x )
  x    =(A−cI)x ; λ =c+              k   k   :
                                   (x ;x )                                             Доказательство. Пусть λ  i-е собственное значение и Ae = λ e . Из
                                                                                                                     i                                    i    i  i
в зависимости от параметра c сходится к такому λ , для которого спра-                                                T
                                          s                                        условия A = A следует, что собственные векторы образуют ортонормаль-
ведливо |λ −c| = max|λ −c|. Процесс сходится к λ при c > (λ +λ )=2                                                                  (Aei;ei)
    s          i    i                               1             1     n                     ный базис. При этом λ =                  =(Ae;e). Представив произвольный
                                                                                                             i     (e ;e )         i  i
или к λ при c < (λ + λ )=2. Скорость сходимости равна O(q2n), где                                                                      i  i
  n              1     n                                                                      вектор x в виде разложения по собственным векторам, получим требуемый
q = max|λ −c|=|λ −c|.
     i6=s  i        s                                                                                результат.
                                                                                                                   T                   n             1
Теорема 17.4 В условиях теоремы итерационный процесс сходится к λ                                    Лемма 17.3 Пусть A = A : Тогда ∀x ∈ R и ∀µ ∈ R имеет место
                                                                1
с наилучшей скоростью при c = (λ +λ )=2, сходится к λ с наилучшей                                    свойство минимальности невязки
               1      2     n                    n
скоростью при c =(λ +λ            )=2.
n      1     n−1
                                                                                                         k A−R (x)I xk ≤k A−µI xk :
                                                                                                                  A          2                 2
   Доказательство.Изтеоремыследует,чтооптимальноезначениеcs для                                          Доказательство.Минимумквадратичнойпоµфункцииk(A−µI)xk2 =
s = 1;n является решением следующей минимаксной задачи: minmax|λ −                                                                                                                   2
                                                    c   i6=s  i                    (Ax;Ax)−2µ(Ax;x)+µ2(x;x) достигается при µ =R (x).
                                                                                                                                               A
c|=|λ − c|. Рассматриваемая функция линейна по λ , поэтому принимает
     s                                                     i                                             Неравенствоиз леммы показывает,что наилучший сдвиг для метода об-
максимальное значение в граничных точках. Например, при s = 1 это со-                                                                                                                   k
                                                                                   ратнойитерации, который можно получить из найденного приближения x
ответствует minmax{|λ − c|=|λ − c|;|λ − c|=|λ − c|}. Можно показать                                                                                             k
        c          2         1        n         1                                             к собственному вектору, есть отношение Рэлея RA(x ). При таком выборе
   Раздел 3.                                                                                             103                         104                                        Лекция 17. Задачи на собственные значения
                                                                                                                    n
   сдвига сходимость к собственному вектору, если она есть, является кубиче-                                                         Pb x . Если же m = n, то B = X−1AX и матрицы подобны. Если
           3                                                                                                             ji  j
   ской: lim |ϕ          =ϕ | ≤ 1, где ϕ  угол между собственным вектором e и                                                       j=1
    k→∞ k+1 k                           k
                                                                                                                   Ax =λx,тоB=diag(λ ;:::;λ ).
              k                                                                                                        i      i  i                     1         m
   его приближением x .                                                                                                                  Ортогональнаяитерация(Методитерированияподпространств).Рас-
   Теорема 17.7 Пусть метод обратной итерации со сдвигом сходится к                                                                  смотрим следующий итерационный алгоритм нахождения m-мерного инва-
                                                T                                                                  риантного подпространства матрицы A, образованного линейной комбина-
   собственному значению λ матрицы A=A . Тогда
                      c
                                             1                                                                     цией собственных векторов, отвечающих m наибольшим по модулю соб-
                                 k                                                                                 ственным значениям. Возьмем произвольную матрицу V ∈ Rn×m с m ор-
                        |λ −λ | ≤                   ;                                                                                                                                               0
                          c                 k+1
                                        kx      k2                                                                 тонормированными столбцами;
         k+1 −1                                                                                                    для k = 0;1;::: вычислим
   т.е. величина kx             k2    характеризует скорость сходимости итерацион-                                                       W =AV;
   ного процесса.                                                                                                                           k+1          k
                                                                                                                       W =V R ,т.е.проведемортонормировкустолбцовW                                                   ;
                                                                                                                          k+1        k+1 k+1                                                                    k+1
                                              k     k+1
Доказательство. Для приближений x , x                                метода обратной итера-                                   пока V и V            значительно отличаются.
                                                                                                                            k      k+1
   ции справедливо выражение                                                                                                             Замечание. При |λ | > |λ                        | и естественных условиях на V ме-
                                                                                                                                                     m           m+1                                                  0
                                                                                                                   тод сходится, и столбцы матрицы V                         задают базис в искомом инвари-
                         k+1     k+1                  k   k+1                                                                                                            ∞
         k+1        (Ax       ; x     )            (x ;x       )        k                                          антном подпространстве. Скорость сходимости характеризуется величиной
  R (x        ) =                       =c+                        =λ :
    A                   k+1     k+1                 k+1     k+1
                     (x      ; x     )           (x      ; x     )                                                 |λ      =λ |.
                                                                                                                     m+1 m
   Отсюда и из леммы получаем, что                                                                                                       QR-алгоритм.Модифицируемметодортогональнойитерациитак,что-
      k                       k+1                         k+1       k+1                                            бы он (как и метод обратной итерации) допускал сдвиги и обращения мат-
        1 = kx k2 = k(A−cI)x                 k2 ≥ k(A−RA(x                )I)x      k2 =                                      рицы. Это приводит к QR-алгоритму  наиболее популярному методу вы-
           k     k+1                        k     k+1                                                              числения всех собственных значений и векторов матрицы A ∈ Rn×n не
        =k(A−λ I)x               k ≥min|λ −λ |kx                  k :
                       2             i                  2                                                          слишком большой размерности. Положим A =A;
                               i                                                                                                                                                  0
                                                 k               k                                                 для k = 0;1;2;::: вычислим
   Итаккакметодсходится к λ , то min|λ −λ | = |λ −λ |. Отсюда следует
                           c              i               c                                                            A =Q R ,где Q ортогональная(в комплексном случае
                                    i                                                                                     k       k k            k
   искомая оценка. Теорема доказана.                                                                                                     унитарная) матрица, R  верхняя треугольная матрица;
                                                                                                                                                            k
Рассмотрим методы нахождения нескольких (всех) собственных значе-                                                                 определим A             =R Q .
                                                                                     n                                                    k+1        k   k
   ний и поиска инвариантных подпространств. Подпространство H ⊂ R на-                                                               пока A         значительно отличается от верхней треугольной матрицы.
                                                                                                                            k+1
   зывается инвариантным подпространством матрицы A, если AH ⊂ H.
   В качестве H можно взять, например, подпространство span{ei1;:::;eim},                                                            Лемма 17.4 Собственные значения матриц A и A из QR-алгоритма
                                                                                                                                                                                                k
   являющееся линейной оболочкой собственных векторов ei .
                                                                    j                                              при k = 1;2;::: совпадают.
   Теорема 17.8 Пусть A  матрица размерности n×n и X = span <                                                                       Доказательство. Так как A                      =R Q =QT(Q R )Q =QTA Q ,тоиз
   x ; ::: ;x      >, x ∈ Rn  подпространство, задаваемое линейно независи-                                                                                                   k+1        k   k       k     k k      k       k   k   k
    1           m        i                                                                                                           Q−1 =QT следует, что матрицы A                         и A ортогонально подобны и имеют
   мыми столбцами, X = (x ::: x )  соответствующая матрица. Под-                                                                      k         k                                    k+1        k
                       1        m                                                                                  одинаковые собственные значения.
   пространство X тогда и только тогда является инвариантным отно-                                                                       Отметим,чтовслучаеневырожденнойматрицыQR-разложениесполо-
   сительно A, когда найдется такая матрица B размерности m×m, что                                                                   жительными элементами r треугольной матрицы R единственно, поэтому
   AX=XB.Вслучаеm=nсобственные значения матрицы B будут соб-                                                                                                               ii
                                                                                                                   в дальнейшем будем полагать r ≥ 0 для каждой верхней треугольноймат-
   ственными значениями матрицы A.                                                                                                                                               ii
                                                                                                                   рицы.
Действительно, инвариантность подпространства означает, что суще-
                                             m
                                            P                                                                      Лемма 17.5 Пусть A  матрица из QR-алгоритма, а V  из метода
   ствуют константы c такие, что Ax =                             c x . В данном случае Ax =                                                                          k                                                    k
              j                      i            j  j                                 i                           ортогональной итерации для m = n, V = I. Тогда A = VTAV .
                                           j=1                                                                                                                             0                   k       k     k
         Раздел 3.                                                           105               106                          Лекция 17. Задачи на собственные значения
 Доказательство. Проверим равенство A = VTAV по индукции. Для                          При практическом использовании метода сначала проводят масштаби-
                       k    k   k
         QR-алгоритма имеем: A = A = Q R , A = R Q = QTAQ . Для метода                         рование (уравновешивание) матрицы A, сближающее ее норму со спек-
        0    0  0   1    0  0    0    0
         ортогональной итерации имеем: W = AI = A = V R . Отсюда V = Q ,                       тральнымрадиусом,азатемприводяткверхнейформеХессенбергаH(h =
             1                1 1           1     0                                                                                   ij
         A =VTAV .Базаиндукциипроверена.Шагиндукции:пустьA =VTAV .                             0 при i > j+1), которая инвариантна относительно QR-итераций. Само же
1    1   1                                                k    k    k
         Тогда для QR-алгоритма имеем                                                          разложениеприменяюткматрицамвидаA −c I.ПолноеобоснованиеQR-
                                                                                                           k  k
                                                                  алгоритма на данный момент отсутствует, однако для практических задач
        A     =QTA Q ; A        =QTVTAV Q :
          k+1    k  k  k    k+1     k k    k k                               метод работает стабильно.
         Т.е. для доказательства леммы необходимо показать, что V    =V Q .
                                    k+1    k  k
 Согласно шагу индукции AV = V A . Так как для QR-алгоритма име-
          k    k k
         ем, что A = Q R ; то AV = V Q R . Но для метода ортогональной ите-
k     k k       k    k  k k
      ˜
         рации W     =AV =V R .Всилуединственности QR-разложения с
      k+1      k     k+1 k+1
                                       ˜
         положительными элементами r получим V Q = V         , R =R      . Лемма
          ii          k k    k+1   k     k+1
         доказана.
         Утверждение 17.2 Пустьвсе собственные числа матрицы A по модулю
         различны. Тогда QR-алгоритм сходится к действительной форме Шура
         "почти верхней треугольной" матрице A , для которой собственные
         значения вычисляются явно.                 ∞
         Пример 17.1. Для матрицы A =  0         1  применение QR-алгоритма
         дает: A = A =::: =A       ∀k:        −1 0
     0    1          k
 QR-алгоритмсосдвигом.СкоростьсходимостиQR-алгоритмаможно
         существенно повысить, если применять разложение к матрицам вида A −
                                                k
         c I. Положим A =A;
          k              0
         для k = 0;1;2;::: вычислим
 A −c I =Q R ;
   k   k      k k
 A    =R Q +c I.
   k+1    k  k   k
         пока A    значительно отличается от верхней треугольной матрицы.
     k+1
 Если ck выбрать равным некоторому собственному значению, то у мат-
         рицы Rk на диагонали появится нуль, поэтому можно найти соответству-
         ющий собственный вектор, и задачу для A      сформулировать как задачу
                     k+1
         на единицу меньшей размерности.
         Лемма 17.6 Собственные значения матриц A и A из QR-алгоритма со
                              k
         сдвигом при k = 1;2;::: совпадают.
 Доказательство. Покажем, что матрицы A и A          подобны:
                           k    k+1
  A    =R Q +c I =QT(Q R +c I)Q =QTA Q :
   k+1     k k    k     k   k k    k   k     k k  k
         Лемма доказана.
                                                                                            108                                   Лекция 18. Полиномиальная интерполяция
         4. Приближение функций                                                                        МногочленLn(x)называетсяинтерполяционныммногочленомвформеЛагран-
                                                                                            жа. Так как интерполяционный многочлен единственен, то Ln(x) есть ре-
  Лекция 18. Полиномиальная интерполяция                                                                      шение поставленной задачи. Если в точной арифметике привести подобные
                                                                                            слагаемые, то будут получены те же значения коэффициентов, что и при
                                                                                            решении системы. При численных расчетах этого делать не рекомендуется,
Пусть a = x < x < ::: < x = b  набор различных точек (узлов)                                                 таккаквычислительнаяпогрешностьвслучаебольшихnможетсуществен-
          1      2               n
на отрезке [a;b], в которых заданы значения достаточно гладкой функции                                        но исказить ответ.
f(x) так, что f = f(x ), i = 1;:::;n. Требуется построить многочлен L (x),                                        Отметим, что если коэффициенты многочлена известны, то можно при-
i       i                                                          n
принимающийвточкахx значенияf ,иоценитьпогрешностьприближения                                                 менить следующую схему вычисления Ln(x):
             i             i
на всем отрезке [a;b] в равномерной норме.                                                                                   L (x) = (:::((c       x+c       )x+c       )x+:::)x+c :
Пример 18.1. Для функции Рунге f(x) =                       1     на отрезке [−1;1] на                                        n                n−1       n−2        n−3                  0
                                         2
                                     25x +1                                                 Такая форма записи имеет неулучшаемое по порядку число арифметиче-
равномернойсеткеx = x              +hбудемиметь            max       |f(x)−L (x)| → ∞
       i     i−1                     0:726:::≤|x|<1          n                              ских действий O(n), необходимое для нахождения Ln(x).
при n → ∞.                                                                                                    Теорема 18.2 Пусть f(x) ∈ Cn[a;b]. Тогда для любой точки x ∈ [a;b]
Пример18.2. НаравномернойсеткетакженетсходимостивC-нормедля                                                   существует такая точка ξ(x) ∈ [a;b], что справедливо равенство
функции |x| на [−1;1].                                                                                                                                                             n
                                                                                                                           (n)
                                                         n       n                                                       f    (ξ(x))                            Y
Теорема 18.1 Для любой таблицы узлов интерполяции (x ;:::;x ), за-
                                                         1       n                                    f(x)−L (x)=                     ω (x);    где ω (x) =        (x−x):
данной на отрезке [a;b], существует такая непрерывная на этом отрезке                                                             n             n!       n               n                  i
функция f(x), что погрешность ||f(x) − L (x)|| в равномерной норме не                                                                                                            i=1
                                    n                                                           Доказательство. Если x = x , то равенство очевидно. Для фиксиро-
стремится к нулю при n → ∞.                                                                                                                             i
                                                                                            ванного x ∈ [a;b], x 6= x построим функцию ϕ(t) = f(t) − L (t) − Kω (t),
    Замечание. Построение L (x) формально эквивалентно задаче нахож-                                                                       i                                            n           n
                   n                                                                        где K = f(x)−Ln(x). Тогда ϕ(t) обращается в нуль в точках x;x ;:::;x ;
                                       n−1                                                                  ω(x)                                                            1        n
                                       P i                                                                          ′                                                         (n)
дениякоэффициентовciизсистемыуравнений                       cix = fj приj = 1;:::;n.
                                               j                                            по теореме Ролля ϕ (t) равна нулю в некоторых n точках, и т.д., ϕ                    (t)
                                       i=0                                                                                                   (n)
Поэтому существование и единственность многочлена Ln(x) степени n−1,                                          в некоторой ξ(x) ∈ [a;b]. Из условия ϕ              (ξ(x)) = 0 и выбранного для K
                                                                                                                                f(n)(ξ(x))   f(x)−L (x)
принимающего в n различных точках заданные значения, следует из невы-                                         представления находим K =                     =          n   .
                                                                                                                                    n!           ω(x)
рожденности данной системы  определитель задачи является отличным                                            Следствие 18.1 Имеет место следующая оценка погрешности в равно-
от нуля определителем Вандермонда. Однако при больших n система близ-
ка к вырожденной. Действительно,можно считать,что узлы интерполяции                                           мерной норме
                                                 n−2     n−1
принадлежат отрезку [0;1]. Тогда сеточные функции x                    , x      при боль-
                                                 j       j
шихnпочтинеотличимы, т.е. базис из данных многочленов почти линейно                                                                       kf(n)(x)k
зависим, а соответствующие столбцы матрицы почти равны.                                                             kf(x)−Ln(x)k ≤            n!      kωn(x)k;     где   kf(x)k = sup |f(x)|:
    Поэтому при численном построении Ln(x) обычно не вычисляют коэф-                                                                                                                x∈[a;b]
фициенты c , а поступают следующим образом.                                                                                                   n
        i                                                                                                  Величина λ = max P|Φ (x)| называется константой Лебега интер-
    Интерполяционный многочлен Лагранжа.Приведемвявномвиде                                                                      n                  i
вспомогательные многочлены Φ (x) степени n−1, удовлетворяющие усло-                                                                  x∈[a;b] i=1
                     i                                                                      поляционного процесса. Значение λ зависит от взаимного расположения
                                                                                                                                        n
виям Φ (x ) = 1;        Φ(x ) = 0 при j 6= i, и далее с их помощью запишем
  i   i            i  j                                                                                узлов, а скорость ее роста при увеличении n влияет на скорость сходимости
формулу для искомого интерполяционного многочлена:                                                            многочлена Ln(x) к функции f(x) в равномерной норме и на оценку для
             n                           n                                                  вычислительной погрешности интерполяции.
            Yx−x                       X
  Φ(x)=                j ;   L (x) =        f Φ (x):                                            Например,длясистемыравноотстоящихузловλ растетэкспоненциаль-
    i           x −x           n             i  i                                                                                                         n
            j=1   i    j               i=1                                                  но, т.е. C 2n=n3=2 ≤ λ ≤ C 2n, а построенный на такой равномерной сетке
            j6=i                                                                                       1              n      2
                          107
      Раздел 4.                                                                                                                         109                                110                                                  Лекция 19. Задачи наилучшего приближения
      интерполяционный полином Ln(x) при большом числе узлов может прин-                                                                                                   Результат оптимизации на классе F всегда не лучше, чем результат опти-
                                                                                                                                                                                                                                                                           An n
      ципиальноотличатьсяотприближаемойфункции.Например,дляфункции                                                                                                         мизации на конкретном элементе f0 ∈ F. Поэтому для f0(x) = n! x имеем
      Рунге на [−1;1] имеем kf(x) − Ln(x)k ≥ εpn, ε > 0;p > 1. В этом случае
                                                                                                                                                                                                                                           A
      принято говорить, что алгоритм имеет насыщение.                                                                                                                                                                                                           n             n 1−2n
                                                                                                                                                                                 inf l(F;{x }) ≥ inf l(f ;{x }) =                                (b −a) 2               ;
     Для чебышёвских узлов верна оценка λ ≤ C lnn. И если f, например,                                                                                                                     {x }               i         {x }        0       i          n!
                                                                  n         3                                                                                                       i                            i
      функция Рунге или произвольная аналитическая в каждой точке отрезка
      функция, то для чебышёвских узлов имеет место оценка kf − Lnk ≤ Cqn,                                                                                                 т.е. найденная для класса оценка сверху достигается на функции f0(x), т.е.
      q < 1, где величины q;C не зависят от n. Следовательно, погрешность убы-                                                                                             является точной.
      вает с ростом n, и алгоритм является алгоритмом без насыщения.                                                                                                             Таким образом, интерполяция по узлам Чебышёва оптимальна на клас-
     Минимизацияостаточногочленапогрешности.Запишемполучен-                                                                                                         се F. Напомним, что для произвольной аналитической функции f интер-
      ное ранее представление погрешности                                                                                                                                  поляционный полином, построенный по чебышёвским узлам, сходится к f
                                                                                                                                                         в непрерывной норме.
                                                        f(n)(ξ(x))
                           f(x)−Ln(x)=                         n!        ωn(x):
                                                                                                                                                            Лекция 19. Задачи наилучшего приближения
      Рассмотрим класс функций F = {f : f ∈ C(n)[a;b];kf(n)k                                                            ≤ A }. Для
                                                                                                  C           n
      набора узлов {x }n определим соответственно погрешность интерполяции
                  i 1                                                                                                                                    Наилучшее приближение в линейном нормированном простран-
      для функции f и для класса F:                                                                                                                                        стве.ПустьLлинейное(векторное)нормированноепространство.Требу-
            l(f;{x }) = kf −L k;                       l(F;{x }) = supl(f;{x }):                                                                         ется найти наилучшее приближение для f ∈ L в виде линейной комбинации
                       i                     n                    i                           i
                                                                            f∈F                                                                          элементов линейно независимой системы g(1);:::;g(n) ∈ L:
      Нас интересует оптимальный набор узлов {x¯ }:                                                                                                                                                                                               n
                                                                      i
                                                                                                                                                                                                            inf      kf −Xcig(i)k:
                           inf l(F;{x }) = l(F;{x¯ }) = l(F):                                                                                                                                            c1;:::;cn
                                             i                     i                                                                                                                                                          i=1
                          {xi}
                                                                                                                                                                                                            n
      Возьмем некоторый набор {x }. Тогда                                                                                                                                  Соответствующее решение P cfg(i) (если существует) называется элемен-
                                         i                                                                                                                                                                        i
                                                                                                                                                                                                           i=1
                                               f(n)(ξ(x))                         A                                                                      том наилучшего приближения.
               l(F;{x }) = sup k                                ω (x)k ≤             nkω k:
                           i                                       n                        n                                                                                                                    N                                        (i)           i−1              i−1
                                                     n!                            n!                                                                    Пример 19.1. Пусть L = R , f = (f1;:::;fN), g                                                          = (x          ; : : : ; x     ),
                                     f∈F                                                                                                                                                                                                                                1                N
                                                                                                                                                         kfk = max |fi|.
                                                                   A                                                                                                i=1;:::;N
     Отсюда следует, что inf l(F;{x }) ≤                                         n inf kω k: Решением задачи
                                                     i              n!              n
                                   {xi}                                  {xi}                                                                            Теорема 19.1 Элемент наилучшего приближения (т.е. соответствую-
inf kω k = inf max |(x − x ):::(x − x )| является нормированный мно-
          n                                        1                    n                                                                                           щий набор {cf}) в линейном нормированном пространстве существует.
      {xi}                  {xi}x∈[a;b]                                                                π(2i−1)                                                                                     i
      гочлен Чебышёва, x  его корни: x = a+b + b−a cos                                                            . При этом
                        i                             i        2          2              2n                                                                                                                                                                                      n
                                                                                                                                                             Доказательство.РассмотримфункциюF (c ;:::;c ) =kf−P c g(i)k.
                                             2x−(a+b)                                                                                                                                                                                       f     1           n                        i
                         n 1−2n                                                                      n 1−2n                                                                                                                                                                    i=1
         ωn(x) = (b −a) 2                       Tn            b −a               ;     kωnk=(b−a) 2                         :                                       По неравенству треугольника имеем:
                                                                                                                                                                                                                         n                              n
      Это приводит к оценке                                                                                                                                                                                                              P (i)                         P (i)
                                                                                                                                                                                                   ˜
                                                                                                                                                                             |F (c)−F (c)| = kf −                            c g      k−kf−                 c˜ g     k ≤
                                                                                                                                                                                 f              f                              i                             i
                                                                                                                                                                                                                       i=1                            i=1
                                                                                                                                                                                      n                               n
                                                        A                                                                                                                            P                               P
                                                           n             n 1−2n                                                                                              ≤k (c −c˜)g(i)k≤                             |c −c˜ |kg(i)k:
                           inf l(F;{x }) ≤                   (b −a) 2                :                                                                                                       i      i                        i       i
                                             i          n!
                          {xi}                                                                                                                                                      i=1                             i=1
Раздел 4.                                                                             111                    112                                 Лекция 19. Задачи наилучшего приближения
Таким образом F (c) непрерывна по c для любого f ∈ L (в том числе                                                Доказательство. Для линейно независимой системы имеем
    f
для f ≡ 0). Рассмотрим в n-мерном пространстве коэффициентов шар
   s                                                                                                           n                        n          n               n
      n          	                                                                                           X (i) (j)               X (i) X (j)                 X (i) 2
      P 2                                                                                        (G c;c) =         (g  ; g   )c c = (      c g  ;     c g   ) = k     cig   k ;
D = c : |c| =               c  ≤ R . Функция F (c) непрерывна, следователь-                                           n                          j i          i          j
   R                         i                       f
      i=1                                                                                                     i;j=1                    i=1        j=1             i=1
           f
но, в некоторой точке c ∈ DR достигает точной нижней грани. При этом                                         т.е. (G c;c) > 0 при c 6= 0.
      f                                                                                                              n
F (c ) ≤ F (0) = kfk. Покажем, что если R достаточновелико, то вне шара
  f          f                                                                                               Пример 19.2. Пусть в пространстве L (0;1) выбрана система {g(i)}n                       =
DR оценка заведомо хуже. Вне шара имеем |c| > R, следовательно,                                                                                              2                                   i=1
                                                                                                                                  1
                                                                                                    n−1        i−1   j−1     R i+j−2            1
  n                                                                                        {1;x;:::;x       } и (x    ; x    ) =   x       dx =         .
F (c) ≥ k P c g k−kfk = |c|F             c    −kfk>RF           c    −kfk:                                                                  0                i+j−1
  f              i i                0   |c|                 0  |c|                                    Требуется решить задачу наилучшего приближения
 i=1
                                    (1)              (n)              c                                                        1
                         ˜                                      ˜                                                            Z         n
Так как непрерывная функция F (c) = kc˜ g                 +:::+c˜ g       k при c =
                       0          1               n
                                                s                    |c|                                                              X i−1 2
                                                                                                                          inf   (f −      cix    ) dx:
                                                    n                                                                      c
                                                  P 2        	                                                              0        i=1
                                     ˜    ˜
рассматривается на единичной сфере S1 = c : |c| =                        c˜ = 1 , то на
                                                        i
                                                   i=1
                                                     ˜          0                          Задача при всех n имеет единственное решение, а набор коэффициентов ci
S функциядостигаетсвоейточнойнижней грани: inf F (c) = F (c ): При
  1                                                           ˜     0         0
                                            c∈S1                                           можно найти из указанной системы уравнений. Однако матрица G в дан-
     0                                            0         0                                                                                                                          n
этом F (c ) > 0, так как 0 ∈= S , а условие F (c ) = 0, c 6= 0 означает, что
 0                            1                0                                                      ном случае является матрицей Гильберта, обусловленность которой растет
g(i) линейно зависимы.                                                                                                                −1          1       √ 4n
                                                                                           экспоненциально: kG         k∞ ∼ √ (1+ 2) . Следовательно, при n & 20 ко-
      kfk                                                                                                           n           n
    ВыберемR=2               . ТогдавнерассматриваемогошараD имеемF (c) >
         0                                             R           f                       эффициенты c могут быть найдены с большой погрешностью.
    F (c )                                                                                                   i
      0
   0
  kfkF (c )
0                                                                                f                        Отметим, что при неудачном выборе базиса (как в данном примере) вы-
2           −kfk=kfk;следовательно,найденный на шаре минимум F (c )
 0                                                                           f
    F (c )
     0                                                  n                                                    числительная погрешность для больших n может достигать катастрофиче-
доставляет минимум по всему пространству R .                                                                                                                              (n+1)   (n+2)
    Наилучшее приближение в гильбертовом пространстве. Пусть                                                 скихразмеров,ипридобавленииновыхфункцийg                          , g      , : : : качество
                             1=2                                                           приближения будет только ухудшаться.
в пространстве H с нормой k·k = (·;·)              задан элемент f и линейно неза-                                                                                                            n
висимая система {g(i)}n         ∈ H. Требуется найти коэффициенты {ci}n                 из                                                                          (i)  (j)      j         X (i)
          i=1                                                    i=1                           Есливыбраннаясистемаортонормальна(g ;g )=δ ,тоg =                              c g   ,
условия минимума функционала Φ(c) = kf − Pn cig(i)k2, т.е. требуется                                                                                                              i               i
                                          i=1                                                                                                                              i=1
найти элемент g ∈ H вида g = Pn cig(i), наилучшим образом приближа-                                          где c = (f;g(i)). При этом
                       i=1                                                                       i
ющий f:
                        n               n                                                                               n               n                       n
           ˜           X (i)          X (i)                                                                 2          X (i)           X (i)                  X (i) 2
    inf Φ(c) = (f −        cig   ; f −     cig  ):                                                  kf −gk =(f −           cig   ; f −     cig   ) = (f;f)−       (f;g    ) :
      ˜
     c
                       i=1             i=1                                                                             i=1             i=1                     i=1
                                ∂Φ                                                                                                                                P
Вточкеминимумавыполняютсяусловия                       =0,чтоприводитклинейной                                                                                                        n        (i) 2
                                ∂cj                                                        Отсюда в том числе следует неравенство Бесселя: (f;f) ≥                  i=1(f;g    ) .
системе уравнений                                                                                                Многочлен наилучшего равномерного приближения.ПустьF
                                                                                           пространство ограниченных вещественных функций, определенных на от-
         n                        n
        X                        X
      −2(f −       c g(i);g(j)) = 0 ⇒       c (g(i);g(j)) = (f;g(j)); j = 1;:::;n                            резке [a;b] вещественной оси с нормой kf(x)k = sup                f(x) . Для элемента
  i                        i                                                                                                                         x∈[a;b]
        i=1                      i=1                                                                                                                                  0       Pn          j
                                                                                           f ∈ F отыскивается наилучшее приближение вида Qn(x) =                      j=0aj x ; яв-
              (i)  (j)            T                                                      ляющееся решением следующей задачи:
с матрицей Грама G = (g ;g ) , G =G .
       n                     n      n
                                                                                                                            n
Теорема 19.2 Еслиg(1);:::;g(n) линейнонезависимы,тоG положитель-                                                                            X j                                     0
                                                      n                                                inf max |f(x)−          aj x | = inf kf − Qnk = kf −Qn(x)k:
но определена, и задача G c = b имеет единственное решение при всех b.                                                    aj x∈[a;b]                       aj
             n                                                                                                             j=0
Раздел 4.                                                                          113                   114                                             Лекция 20. Сплайн-интерполяция
Определение 19.1 МногочленQ0(x)называетсямногочленомнаилучше-                                            Пример 19.3. Для функции f(x) = sin100x многочленом наилучше-
                      n
го равномерного приближения для функции f(x), если для любого много-                                     го равномерного приближения степени n = 98 на отрезке [0;π] являет-
члена Qn(x) степени n справедливо неравенство kf −Q0k ≤ kf −Qnk:                                         ся Q0 (x) ≡ 0. В данном случае имеем точки чебышёвского альтернанса
                                                n                                            98
                                                                                                      k
                                                                                       f(x ) = (−1) для 100x = π=2+πk, k = 0;:::;99.
Такой многочлен существует всегда (по теореме об элементе наилучшего                                         k                      k
приближения в линейном нормированном пространстве), а его единствен-                                     Теорема 19.5 Многочлен наилучшего равномерного приближения непре-
ность (см. далее) имеет место для непрерывных функций f(x).                                              рывной функции единственен.
                                                                                           Доказательство. Пусть Q1(x) 6= Q2(x), kf −Q1k = kf −Q2k = kf −
Теорема 19.3 (Валле–Пуссен).Пусть существует (n+2) точки a ≤ x <                                                                             n          n             n              n
                                                                 0                     Q0k=E.Тогда
: : : < x   ≤bтакие, что                                                                                   n
 n+1
                                 i                                                                             1     2              1             2
     sign f(x )−Q (x ) ·(−1) = const,
               i      n  i                                                                                     Qn+Qn           f −Qn         f −Qn
т. е. при переходе от точки к точке разность f(x )−Q (x ) меняет знак.                                                     kf −            k ≤ k          k+k           k = E:
                                         i     n i                                                                 2               2             2
Тогда                                                                                                                                      1   2
          0                                                                                                            Q +Q
  kf −Q k≥µ= min |f(x)−Q (x)|:                                                         Отсюда следует, что Qn =          n   n является многочленом наилучшего рав-
          n          i=0;:::n+1    i      n   i                                                                            2
                                                                                       номерного приближения, и для Qn существуют точки чебышёвского аль-
                                                                                       тернанса x < ::: < x         :
    Доказательство. Если µ = 0, то утверждение очевидно. Пусть µ > 0                                                  0           n+1
и kQ0 − fk < µ. Тогда полином Qn(x) − Q0(x) отличен от нулевого. При                                                       1          2
      n                                            n                                                                      Q (x )+Q (x )
      0                                       0                                                      n i        n  i
                                                                                                                           −f(x ) =E; i=0;:::;n+1:
этом sign Q (x ) − Q (x ) = sign (Q (x ) − f(x )) − (Q (x ) − f(x )) =                                                                              i
       n   i      n   i               n   i        i        n   i        i                                                  2

sign Q (x )−f(x ) ; так как модуль первой разности всегда больше µ, вто-
 n   i       i                                                                                    Но в этом случае
рой не превосходит kQ0 − fk и, по предположению, µ > kQ0 − fk. Таким
         n                                           n
образом,ненулевоймногочленQn(x)−Q0(x)степениnменяетзнакв(n+2)                                                                  |Q1(x )−f(x )+Q2(x )−f(x )| = 2E:
                             n                                                                                 n   i        i      n   i       i
точках, что невозможно. Теорема доказана.
                                                                                       Итаккак|Qj(x )−f(x )| ≤ max |Qj(x)−f(x)| = E;                  j = 1;2; то равенство
                                                                                                      n i         i         x    n
Теорема 19.4 (Чебышёв П.Л.) Чтобы многочлен Q (x) был многочле-                                          возможно только при Q1(x )−f(x ) = Q2(x )−f(x ) = ±E. Это означает,
                                               n                                                                   n   i        i      n   i        i
ном наилучшего равномерного приближения непрерывной функции f(x),                                        чтоQ1(x ) = Q2(x ) в(n+2)точках,тоестьмногочленыQ1;2 тождественно
                                                                                              n   i      n i                                               n
необходимо и достаточно существования на [a;b] по крайней мере (n+2)                                     равны.
точек x <:::<x            таких, что
  0            n+1                                                                                Пример19.4. Вклассеразрывныхфункцийприn≥1теоремыЧебышёва
                                 i                                                     и единственности могут нарушаться:
      f(x )−Q (x ) = α(−1) kf −Q k;
          i      n   i                   n                                                              f(x) = signx на [−1;1]; Q1(x) = αx; α ∈ [0;2].
где i = 0;:::;n+1; α = 1 или α = −1 одновременно для всех i.                                             Следствие 19.1 Если f(x)  непрерывная симметричная (кососиммет-
                                                                                       ричная) относительно (a+b)=2 функция, то Q0(x) симметричный (косо-
                                                                                                                                               n
    Точкиx ;:::;x        , удовлетворяющиеусловиютеоремы,называютсяточ-
      0       n+1                                                                                 симметричный) относительно (a+b)=2 многочлен.
ками чебышёвского альтернанса.
                                                                                           Доказательство может быть получено с учетом единственности Q0
    Доказательстводостаточности.Поусловиютеоремы,азатемпотео-                                                                                                                                  n
реме Валле–Пуссена имеем:                                                                                методом от противного.
        kf −Q0k≥         min    |f(x ) − Q (x )| = kf −Q k:
     n     i=0;:::;n+1    i      n   i             n                                     Лекция 20. Сплайн-интерполяция
Таким образом, имеющийся многочлен Qn приближает f не хуже, чем оп-
тимальный Q0. По определению Q0 это означает, что Q является много-                                      Пусть на отрезке [a;b] вещественной оси задана сетка: a = x < x < ::: <
         n                        n                        n                                                                                                             0     1
членом наилучшего равномерного приближения.                                                              x =b,P множествомногочленовстепени не выше m(m≥1), C(r)[a;b]
                                                                                         n        m
Раздел 4.                                                                             115                    116                                              Лекция 20. Сплайн-интерполяция
множествофункций,имеющихна[a;b]непрерывныепроизводныедоr-го                                                     Кубический интерполяционный сплайн на каждом из отрезков
                                                                                                                                                                3       2
порядка включительно (r ≥ 0).                                                                                [x    ; x ] является полиномом третьей степени S (x) = a x +b x +c x+d ,
                                                                                             i−1    i                                                3        i       i      i     i
                                                                                           проходит через точки (x ;f(x )), i = 0;:::;n (два условия на каждом от-
Определение 20.1 Функцию S                 (x) называют полиномиальным сплай-                                                              i     i
                     m;k                                                                   резке) и имеет непрерывные первую и вторую производные в точках x ,
ном степени m дефекта k (1 ≤ k ≤ m) с узлами {x }; i = 0;1;:::;n для                                                                                                                                 i
                                               i                                           i = 1;:::;n−1 (два условия для каждой внутренней точки). Формально из
функции f(x) ∈ C[a;b], если выполнены следующие условия:                                                     этих условий для нахождения 4n неизвестных коэффициентов имеем 4n−2
    1) на каждом из отрезков [x             ; x ]; i = 1;:::;n она является много-
                       i−1   i                                                             уравнений, еще два уравнения необходимо дополнительно задать.
членом, т.е. S        (x) ∈ P [x      ; x ];
m;k         m i−1 i                                                                                                             ′′
    2) на всем отрезке [a;b] обладает непрерывностью производных, т.е.                                       Теорема 20.2 Пусть M = S (x ), i = 0;1;:::;n. Тогда M удовлетворя-
                                                                                                                          i     3   i                              i
Sm;k(x) ∈ C(m−k)[a;b].                                                                                       ют системе линейных уравнений CM = d с прямоугольной матрицей C
    Сплайн называется интерполяционным, если в узлах {x } справедливы                                        размерности (n−1)×(n+1), где C и d соответственно имеют вид:
                                                      i
равенства S       (x ) = f(x ); i = 0;1;:::;n; иначе  аппроксимационным.
        m;k   i        i
    Далее рассматривается только случай k = 1, поэтому термин "дефекта                                               h1      h1+h2    h2    0       :         :      :         :        0 
                                                                                                       6      3       6
k" будем опускать. Также далее задача интерполяции рассматривается на                                                :         :       :    :       :         :      :         :        :   
                                                                                                                         hi    hi+hi+1    hi+1                            
единичном отрезке [0;1] на сетке x = 0, x = x                +h; i=1;:::;n, x =1.                                    0         :      0                              0         :        0 ;
                        0        i     i−1     i                 n                                                        6       3        6                              
    Линейный интерполяционный сплайн на каждом отрезке [x                             ; x ]                          :         :       :    :       :         :      :         :        :   
                                                                i−1    i                                                                          h       h    +h     h
являетсяполиномомпервойстепениS1(x) = aix+bi ипроходитчерезточки                                                         0      0       :    :       :        0       n−1     n−1   n     n
(x ;f(x )), i = 0;:::;n (как следствие непрерывен на всем отрезке интер-                                                                                              6         3        6
   i     i
                                                                                             f −f     f −f        f   −f     f −f          f −f         f   −f
полирования [x ;x ]). Его коэффициенты a ;b однозначно находятся из                                             2  1     1   0       i+1   i    i   i−1       n   n−1      n−1   n−2 T
 0   n                              i  i                                                   (       −        ; : : : ;      −         ; : : : ;       −             ) :
условий S (x ) = f(x ).                                                                                         h2        h1          hi+1        hi             hn          hn−1
     1   i        i
                      (2)                                                                      Доказательство. По определению S′′(x)  линейная на каждом отрез-
Теорема 20.1 Пусть f(x) ∈ C                [0;1]. Тогда линейный интерполяцион-                                                                               3
                                                                                           ке [x    ; x ] функция. В силу ее непрерывности в точках x имеем представ-
ный сплайн на отрезке [x           ; x ] имеет вид                                                                 i−1   i                                                        i
             i−1    i                                                                      ление:
                                                                                                                                    x −x          x−x
                      x−x                x−x                                                                         ′′              i                  i−1
  S (x) = f(x      )        i   +f(x )         i−1 ;                                                               S3(x) = Mi−1             +Mi             :
   1            i−1 x     −x           i x −x                                                                                         hi              hi
                      i−1     i           i     i−1                                        ДвукратноинтегрируяиучитываяусловияS (x ) =f ;S (x                          ) = f    , по-
и верна оценка                                                                                                                                                     3   i     i   3   i−1      i−1
                                         1                                                 лучиманалитическоепредставлениекубическогоинтерполяционногосплай-
                            ′′                       2                                     на на отрезке [x       ; x ] :
          kf(x)−S1(x)kC[0;1] ≤ kf (x)kC[0;1]            max hi :                                                         i−1    i
                                         8 i=1;:::;n
                                                                                                                                   3                   3
                                                                                                                          (x −x)            (x−x )
   Доказательство. Из оценки погрешности для интерполяционного мно-                                                         S3(x) = Mi−1       i       +Mi           i−1   +
                                                                                                                             6hi                6hi
гочлена Лагранжа первой степени следует неравенство для каждого отрез-                                                               M h2x −x                    Mh2x−x
ка [x     ; x ] и, следовательно, для [0;1] в целом.                                                                          fi−1 −     i−1 i     i      + fi− i i                i−1 :
      i−1   i                                                                                                                             6         hi                6          hi
Утверждение 20.1 ПустьS множествонепрерывных,кусочнонепре-
                   1                                                                       Отсюда вычислим производную сплайна S′(x) слева в точке x :
рывно-дифференцируемых функций s(x), удовлетворяющих условиям                                                                                                   3                       i
                                       Z 1                                                                      S′(x −0)=M           hi +M hi + fi −fi−1 :
                                             ′    2                                                              3   i           i−1 6        i 3        h
     s(x ) = f(x );     i = 0;:::;n;     I (s) =     (s (x)) dx < ∞:                                                                                                 i
         i        i                       1
                                        0                                                  Аналогично найдем представление S (x) на [x ;x                ] и вычислим производ-
Тогда решением задачи                                                                                                                                    3          i   i+1
                                                                                           ную сплайна S′(x) справа в точке x :
                       inf I (s)                                                                             3                        i
                      s∈S   1
                          1                                                                                                      hi+1           hi+1     fi+1 −fi
                                                                                                            S′(x +0)=−M                −M             +            :
является линейный сплайн S1(x).                                                                                                 3  i              i  3        i+1   6        h
                                                                                                                                                             i+1
          Раздел 4.                                                                    117                  118                                         Лекция 20. Сплайн-интерполяция
          Непрерывность S′(x) в точках x ;i = 1;:::;n−1, т.е. S′(x −0) = S′(x +                             Утверждение 20.3 Пусть f(x) ∈ C(4)[0;1], kf(4)(x)k                ≤ A , задана
3               i                        3   i         3  i                                                                                C[0;1]    4
          0), порождает искомую систему из (n−1) уравнения относительно (n+1)                               сетка с постоянным шагом hi = h, и дополнительные условия для опреде-
          неизвестных. Теорема доказана.                                                                    ления кубического интерполяционного сплайна имеют следующий вид
   Имеются три стандартных способа доопределения системы.                                                           ′             ′        ′             ′
          ′′              ′′                                                                               S (x +0)=f (x );        S (x −0)=f (x ):
   1-й способ: S (x ) = M = S (x ) = M = 0  естественный сплайн.                                                   3  0            0      3   n            n
         3   0      0     3  n       n
   2-й способ: S′(x +0) = f′(x ), S′(x −0) = f′(x ).
         3   0            0    3  n             n                                         Тогда справедлива оценка погрешности
   3-й способ: строим параболу L0(x) по точкам x ;x ;x , два раза диф-                                           (l)
                  3                  0  1   2                                               kS (x)−f(l)(x)k          ≤CAh4−l; l=0;1;2;3:
                0    ′′                      n                                                 3               C[0;1]    l 4
          ференцируя, находим M0 = (L3(x)) ; строим параболу L3(x) по точкам
                                             n    ′′
          x ;x     ; x   , два раза дифференцируя, находим M = (L (x)) .
 n  n−1   n−2                                           n      3                                 Используюттакжелокальные (аппроксимационные) сплайны, значе-
          Утверждение 20.2 Пусть S  множество непрерывных, непрерывно-                                     ния которых в узлах, как правило, не совпадают со значениями f(x). Это
              2                                                                обстоятельство не принципиально, так как значения f(x) обычно известны
          дифференцируемыхидваждыкусочнонепрерывно-дифференцируемыхфунк-                                    приближенно. Рассмотрим построение локального сплайна третьей степени
          ций s(x), удовлетворяющих условиям                                                                на сетке с постоянным шагом h = x         −x; i=0;1;:::;n−1, для отрезка
                                                                                                                     i+1     i
                               Z 1 ′′     2                                    [0;1]. Возьмем стандартный сплайн B(x), определяемый соотношениями
  s(x ) = f(x );   i = 0;:::;n;   I (s) =     (s (x)) dx < ∞:
      i       i                    2
                                 0                                                                     2      2   1   3
                                                                                                       −x + |x|           при    |x| ≤ 1;
                                                                                                      
          Тогда решением задачи                                                                                                     3          2
                 inf I (s)                                                                    B(x) =     1          3
                      2                                                                                    (2 −|x|)        при    1 ≤ |x| ≤ 2;
                                                                                                      
                 s∈S2                                                                                  6
          является кубический сплайн S (x) с условиями S′′(x ) = S′′(x ) = 0.                                                       0                  при    2 ≤ |x|:
               3                   3   0     3   n
                                                                                                                 3
          Теорема 20.3 Пусть M0 = Mn = 0. Тогда решение системы CM = d                                      Представление B(x) = C(2−|x|) при 1 ≤ |x| ≤ 2 следует из непрерывности
          удовлетворяет неравенству                                                                         функции и первых двух ее производных в точках x = ±2. Если значение
                         max |d |                                              C задано, то представление B(x) при |x| ≤ 1 следует из непрерывности
                        1≤i≤n−1 i                                              функции, двух ее производных в точках x = ±1 и условия B(−x) = B(x).
        max |Mi|≤3                  :                                          Величина C определяется из условия нормировки B(0)+B(1)+B(−1) = 1.
      1≤i≤n−1             min hi                                                                                             (1)        (2)
                         1≤i≤n                                                    Локальные сплайны третьей степени B2 (x) и B2 (x) записываются в
   Доказательство. Пустьmax|Mi|=|Mj|;1≤j ≤n−1.Рассмотримj-е                                      виде
              i                                                                                             n+1
          уравнение системы                                                                                                     (k)      X (k)        x−ih
                                                                                                 B2 (x) =       α B               ;  k = 1;2
                                                                                                                  i        h
          d =M hj +M hj+hj+1 +M                  hj+1 ;                                                                i=−1
j      j−1 6      j    3          j+1   6                                      и отличаются выбором коэффициентов.
          из которого следует неравенство:                                                                     При k = 1 доопределяют значения f−1 и fn+1 линейной интерполяцией
                                                                                                                                                 (1)
                                                                             по значениям f0;f1 и fn;fn−1 соответственно и полагают α              = fi, где
        hj +hj+1              hj           hj+1          hj +hj+1                                                                                           i
    |d | ≥ |M |           − |M | +|M |                   ≥|M |             ;                     f =f(x ) при 0 ≤ i ≤ n.
     j       j     3             j−1 6       j+1   6          j     6                             i      i
                                                                                  При k = 2 доопределяют значения f−2, f−1 и fn+1, fn+2 кубической
          так как |Mj±1| ≤ |Mj|. Оценивая левую часть неравенства сверху через                              интерполяцией по значениям f0, f1, f2, f3 и fn, fn−1, fn−2, fn−3 соответ-
          max|d | и множитель в его правой части снизу как                                                                          (2)
      i                                                                                          ственно, и полагают α      =(8fi−fi+1−fi−1)=6.
 i                                                                                                                       i
                                                                                                (k)                       (k)
                                                                                  Прилюбыхα ; k=1;2,функцииB2 (x)являютсясплайнамитретьей
            h +h         1                                                                      i
        min i      i+1 ≥    minh ;                                             степени, причем они тождественно равны нулю вне отрезка [−3h;1 + 3h].
         i      6        3   i   i
                                                                               Значения полученных сплайнов в узлах сетки равны некоторому среднему
          приходим к искомой оценке.                                                                        значений функции в ближайших узлах.
          Раздел 4.                                                              119                120                     Лекция 21. Интерполяция Чебышёва, Фурье, Паде
          Утверждение 20.4 Пусть f(x) ∈ C(2)[0;1], kf(2)k            ≤ A и задана                   кQ (x), поэтомупереходотQ (x) кQ          (x) осуществляетсяоптимальным
                                  C[0;1]    2                              n                         n       n−1
          сетка с постоянным шагом hi = h. Тогда                                                    образом.
                                                                        Наданной идее основан следующий телескопический метод. Пусть по-
(1) (l)   (l)             2−l
                                                                                                     N
      k B        −f k        ≤CAh ; l=0;1:                                                                      P
2            C[0;1]   l 2                                                                                   m
                                                                       лучено приближение f(x) ≈        c x =P (x), например, на основе ряда
                                                                                                         m        N
          Утверждение 20.5 Пусть f(x) ∈ C(4)[0;1], kf(4)k            ≤ A и задана                                                m=0
                                  C[0;1]    4                          Тейлора, но степень N излишне велика. Построим разложение P (x) =
                                                                                                                                          N
          сетка с постоянным шагом h =h. Тогда                                                       N
           i                                                            Pc T (x), определив коэффициенты c         рекуррентно, и заменим P (x)
                                                                            m m                                  m                           N
       (2)(l)    (l)             4−l                                            m=0                                       n
    k B        −f k        ≤CAh ; l=0;1;2;3:                                                                                P
         2            C[0;1]   l 4                                                на частичную сумму P (x) ≈ Q (x) =           c T (x). Так как на каждом
                                                                                              N         n            m m
                                                                                                                m=0
                                                                       шаге цепочки P (x) ≈ Q       (x) ≈ ::: ≈ Q (x) имеем наилучшее приближе-
Лекция 21. Интерполяция Чебышёва, Фурье,                                                                 N        N−1              n
                                                                       ние в равномерной норме, то при такой замене обычно удается значительно
   Паде                                                                                  понизить степень N с малой погрешностью.
                                                                          Сделаем следующее замечание. Задача приближения функции по мно-
                                                                                                     n
          Пусть требуется приблизить функцию f(x) на отрезке [−1;1] многочлена-                     гочленам Чебышёва f(x) ≈ P cmTm(x), x ∈ [−1;1] заменой переменных
            n                                                                                       m=0
          ми. Так как система {1;x;:::;x ;:::} при больших n близка к линейно за-                   x = cost сводится к задаче тригонометрической интерполяции f(cost) ≈
          висимой, то в качестве базисных функций возьмем многочлены Чебышёва                        n                  n
          {Tn(x)}.                                                                                   PcmTm(cost)= P cmcos(mt): Даннаязамена также сводит задачу при-
                                                                       m=0               m=0
          Пример21.1. Рассмотримзадачуприближения f(x) в гильбертовомпро-                           ближения f(x) по узлам Чебышёва x = cos(πj) к задаче интерполяции
                                                                                                              j        n
          странстве L (−1;1):                                                                                  n
   2                                                                              f(cost) ≈ P cmcos(mt) по равноотстоящим узлам tj = πj.
                       1                                                                                                        n
                                                                                 m=0
       kfk2 = (f;f) ;   (f;g) = Z p(x)f(x)g(x)dx:                                    Таким образом тригонометрическая интерполяция в некотором смысле
p        p        p                                                    оптимальна для системы равноотстоящих узлов.
                     −1                                                   Дискретное преобразование Фурье. Если на [0;1] известна 1-пери-
          Вкачествевесовойфункцииудобновзятьp(x) = √ 1          , так как в этом слу-               одическая функция f(x), f(0) = f(1), то в качестве базиса можно взять
   √            √              1−x2
      1         2            2              ˜                                     систему
          чаесистема{√ T0(x); √ T1(x);:::; √ Tn(x);:::} = {Tn(x)} ортонормальна,
      π        π            π                                                                    {1;cos2πx;sin2πx;:::;cos2πmx;sin2πmx;:::}
                               n
                              P ˜
          и искомые коэффициенты в разложении f(x) ≈ m=0cmTm(x) определяют-                         и построить ряд Фурье для f(x). Рассмотрим конечномерные аналоги та-
        ˜
          ся явно cm = (f;Tm). Согласно доказанным ранее результатам построенное                    кого разложения.
          приближение является наилучшим для выбранного пространства.                               Пример 21.3. Пусть на [0;1] известна функция f(x), f(0) = f(1) = 0.
          Пример21.2. Рассмотримзадачуприближенияf(x)впространствеC[−1;1],                          Рассмотрим fj = f(jh), h = 1=N, 0 ≤ j ≤ N. На пространстве дискретных
          kfkC = max |f(x)|: Пусть                                                                  функций fj, f0 = fN = 0 определим скалярное произведение (fj;gj) =
      x∈[−1;1]                                                                              N−1
          n                                                             1 X                          (m)   √
         X                                                                    fjgj. Тогда система {ϕ    = 2sinπmjh;m=1;:::;N −1} полна и
    f(x) ≈ Q (x) =      c T (x) = Q     (x) +c T (x):                             N                             j
  n           m m         n−1       n n                                   j=1
         m=0                                                                                                 N−1
                                                                                                              P      (m)             (m)
                                                                       ортонормальна. Следовательно, fj =        cmϕ    , cm = (fj;ϕ    ) и можно
          Тогда Q (x) −Q      (x) = c T (x). Так как c T (x) является многочленом                                                                 j               j
n       n−1        n n              n n                                                                                 m=1
                        n−1   n                                                                   N−1
          наименее уклоняющимсяот нуля в классе 2       cnx +:::, то частичная сум-                                             P      (m)
          ма Qn−1(x) является многочленом наилучшего равномерного приближения                       предположить, что f(x) ≈ m=1cmϕ       (x).
Раздел 4.                                                                           121                    122                         Лекция 21. Интерполяция Чебышёва, Фурье, Паде
    Отметим, что формально любую последовательность f = f(x ), j =                                         иимеетсявзаимнооднозначноесоответствиемеждузначениями{f }N−1
                                                    j         j                                                                                                           j j=0
1;:::;N −1 можно дополнить нулями f0 = fN = 0 и построить разложение                                       и коэффициентами {A }N−1.
N−1                                                                                                                           m m=0
fj = P bmsin(πmjh): Однако, если f(0);f(1) 6= 0, то полученная непре-                                         В общем случае преобразование Фурье {f } ↔ {A } невозможно вы-
m=1                                                                                                                                                       j         m
           N−1                                                                           числить менее, чем за O(N), и не сложно реализовать за O(N2) арифмети-
   ˜        P
рывнаяфункцияf(x)=                bmsin(πmx) может плохо приближатьf(x) вне                                ческих действий.
           m=1                                                                              Быстрое преобразование Фурье (БПФ). Метод требует при N =
точек x , j = 1;:::;N −1.
  j
                                                ′        ′                               n2 порядка O(N3=2), а при N = 2n порядка O(Nlog N) арифметических
Пример21.4. Пустьна[0;1] известнафункция f(x), f (0) = f (1) = 0. На                                                                                                     2
пространстве дискретных функций fj определим скалярное произведение                                        действий. Это дает следующий выигрыш:
                 N−1                                                                        N=32; N2=1024; Nlog N =160;
                                                                                                                        2
   (fj;gj) = 1    Pfjgj+1(f0g0+fNgN) :                                                      N=128; N2 =16384; Nlog N =896;
              N               2                                                                                             2
                  j=1                                                                       N=1024; N2 =1048576; Nlog N =10240.
Тогда система                                                                                                                                     2
                     √                                                                   Отметим, что алгоритм БПФ принято включать в десятку важнейших чис-
      {ψ(m)} = {1;cosπNjh; 2cosπmjh;m = 1;:::;N −1}                                                 ленных алгоритмов двадцатого века (современный подход основан на алго-
         j
                                                                                         ритме Кули–Тьюки, хотя основная идея была известна Гауссу).
полна и ортонормальна. Следовательно,                                                                         Построим расчетные формулы для случая N = n1n2. Для m-го коэф-
    N                                          N
    fj = Xcmψ(m), cm =(fj;ψ(m)) и f(x) ≈ X cmψ(m)(x).                                                      фициента имеем:
 j                 j                                                                                                             N−1
                                                                                                                               1 P       −2πim j
   m=0                                        m=0                                                                                 A =            f e       N:
                                                                                                                         m     N       j
Пример 21.5. Пусть f(0) = f(1), fj = f(jh), h = 1=N, 0 ≤ j < N. На                                                                                  j=0
дискретном пространстве N-периодических функций (f = f ) определим                                            Запишем результат деления с остатком для m;j:
                                                0     N
скалярное произведение                                                                                                              m=m +mn; j=j +j n :
                            N−1                                                                                           1     2 1          1     2 2
                (f;g) = 1 P f g¯
                         N        j j
                            j=0                                                          Тогда
                                                                                                                    n −1n −1
    и выберем следующую базисную систему:                                                                                               2    1
                                                                                                                      P P                     (m +m n )(j +j n )
                                                                                                                 1                       −2πi   1   2 1  1  2 2
                                                                                                        A =                    f        e             N         :
                                                                                                          m                     j +j n
                                                                                                               n n               1  2 2
        (m)      2πimj	                                                                                        1 2 j =0 j =0
        gj    =e N ;m=0;:::N−1:                                                                                      1     2
                                                                                                                                                                       mj       m j
                                                                                                    (m +m n )(j +j n )      mj    m j                 −2πimj      −2πi   1 −2πi 1 2
                                                                                            Далее      1   2 1   1  2 2 =      1 + 1 2+m j ;т.е.e          N =e        N e       n1 :
                                                                                                                                            2 2
                             	                                                                             n n              N      n
Теорема 21.1 Система функций g(m) ;m = 0;:::;N −1, ортонормаль-                                                                1 2                     1
                          j                                                              Следовательно, можно переписать выражение для A                 в виде
                                                                                                                                                      m
на, т.е. (g(m);g(n)) = δ      .
         mn                                                                                                      n −1      n −1                m j !
                                                                                                                  2         1
                                                                                                                  P         P                    1 2        mj
                                                                                                              1          1                −2πi n        −2πi   1
    Доказательство.                                                                                                     A =                       f        e       1    e      N =
                                                                                                        m                         j +j n
                                                                                                              n         n         1   2 2
                                                                                                               2 j =0    1 j =0
                                                                                                                  1         2
  (m)   (m)                                                                                                 n −1
m=n; (g         ; g   ) = 1:                                                                                            2
                                                                                                             P                    mj
                                                                                                          1                  −2πi   1
                  N−1                                                                                 =          A(j ;m )e         N :
                                                                                                                     1    1
                   P       (m−n)j                                                                        n
  (m)   (n)     1       2πi                                                                               2 j =0
m6=n; (g        ; g   ) = N       e      N    =                                                                         1
                  j=0
   1                  N−1      1 1−qN                2πi(m−n)                            ТакаяформазаписипозволяетвыделитьслагаемыеA(j ;m ),j =0;:::;n −
= N(1+q+:::+q             ) = N 1−q = 0;       q = e      N :                                                                                            1   1    1            2
Следствие 21.1 Каждаядискретнаяфункцияf ,j =0; :::,N−1может                                                1, m1 = 0;:::;n1−1.Дляихподсчетатребуетсяпорядкаn1(n1n2)арифмети-
                                        j                                                ческих действий; для вычисления A           принайденныхA(j ;m )потребуется
                                                                                                                                  m                        1    1
быть представлена в виде                                                                                   порядка n2(n1n2) ар. действ.; в результате имеем O(n1(n1n2) + n2(n1n2))
     N−1                            N−1                                                  арифметических действий.
      X 2πimj                    1 X −2πimj                                                 Рекурсивная реализация для N =2n.РассмотримполиномP (x) =
f =       A e      N ;   A =            f e      N ;                                                                                                                    N
 j          m              m     N        j                                                              2                 N−1
                                                                                         f +f x+f x +:::+f               x     . Вычисление коэффициентов A             по сути
     m=0                            j=0                                                   0    1      2              N−1                                             m
Раздел 4.                                                                          123                   124                         Лекция 21. Интерполяция Чебышёва, Фурье, Паде
соответствуетвычислениюзначенийполиномаP (x)вкорняхN-ойстепени                                           ется без изменений, однако вне узлов интерполяции ее непрерывный аналог
                                     N
из единицы, т.е. в точках {x       =e−2πim=N; m = 0;:::;N−1}. Так как корни                              обычно обеспечивает существенно лучшее качество приближения для f(x).
              m
                                       2           2
x    обладают симметрией x          = −x          , то x         = x , т.е. {x } ⊃                             Интерполяция Паде–Якоби.Длярешениямногихприкладныхза-
 m                               m        m+N=2          m+N=2       m           m
   2        4                N=2        N                                                                дач интерполяции успешно применяется следующий подход. Будем искать
{x } ⊃ {x } ⊃ ::: ⊃ {x          } ⊃ {x } = {1}, m = 0;:::N −1. При этом на
   m        m                m          m                                                                представление функции f(x) в окрестности точки x в виде отношения
каждом шаге число различных элементов в множестве уменьшается в два                                                                                                     0
                 e     2           o    2                                              двух полиномов. Для этого построим отрезок ряда Тейлора в точке x :
раза. Представим P (x ) = P            (x )+x P         (x ), где                                                                                                                              0
     N m         N=2   m       m N=2 m                                                 f(x) = P∞ c zi, z = (x−x ) и найдем коэффициенты искомого приближе-
      e                                  N=2−1                                                                      i=0 i                0
    P    (x) = f0 +f2x+:::+fN−2x                ,
     N=2                                                                                                 ния из условия
                                                                                                                                     p
      o                                  N=2−1                                                                            P∞       i    a0+a1z+:::+apz         p+q+1
    P    (x) = f1 +f3x+:::+fN−1x                .                                                                               c z =                    +O(z         ); b = 1:
     N=2                                                                                                                    i=0 i       b +b z+:::+b zq                   0
Таким образом, вычисление полинома P (x) степени (N − 1) в N точках                                                                      0   1      q
                              N                                                            Это означает, что первые p + q + 1 слагаемые ряда Тейлора для по-
сведено к вычислению двух полиномовPe;o (x) степени (N=2−1)в N=2 точ-
                             N=2                                                       строенной дробно-рациональной функции совпадают с первыми слагаемы-
                      e     2          o     2 ). Так как Pe      (x)
ках и последующему сложению P              (x )+x P          (x                                          мирядадляf(x).Умножимданноеравенствоназнаменательиприравняем
                      N=2   m       m N=2 m                   N=2
и Po (x) имеют ту же структуру, что и P (x), следовательно, к каждо-                                     коэффициенты при 1;z;:::;zp+q. В результате получим систему линейных
    N=2                                            N
му из них можно рекурсивно применить аналогичную процедуру разложе-                                      уравнений для {b0 = 1;b1;:::;bq}, решив которую можно вычислить коэф-
ния. Найдем вычислительную сложность алгоритма. Пусть D(N)  число                                       фициенты {ai}.           x    12+6x+x2
арифметических действий, требуемых для вычисления P (x ) для N то-                                             Пример. Для e ≈                   , p = q = 2, при |x| ≤ 1 точность прибли-
                                                 N m                                                                 12−6x+x2
          o;e   2
чек. Тогда вычисляем P         (x ) за 2D(N=2) арифметических действий; вы-                              жения порядка 1=6! ≈ 0:0014.
          N=2   m
                                          e     2           o    2                            Многоточечная интерполяция Паде (Рациональная интерполя-
числяем P (x ) с учетом x           =−x           в виде P      (x ) ±x P        (x ),
     N m                  m        m+N=2             N=2   m       m N=2 m
m=0;:::;N −1, за N=2+(N=2+N=2) арифметических действий; в итоге                                          ция). Рассмотрим задачу построения
      2                                                                                                                                   a +a x+:::+a xp
                                                                                                                      R(x) = 0      1       p
имеем:                                                                                                                                            b +b x+:::+b xq
                                                                                                                                0   1       q
           D(N)=2D(N=2)+3N=2:                                                          из условийR(x ) = f(x ), b = 1, i = 1;:::;n при n = p+q+1. Данныеравен-
                                                                                                         i        i   0
При этом D(2) = 3, D(1) = 0. Покажем по индукции, что отсюда следу-                                      ства образуют систему линейных алгебраических уравнений относительно
                         3N                                                            неизвестных коэффициентов:
ет аналитическая формула D(N) =                log2 N. Действительно, для N = 2                                                   p                 q
                          2                 3N                                                                  P j               P j
                                                                                                      b =1;        a x −f(x )        b x =0;      i = 1;:::;n:
формула верна. Пусть верна для N=2, т.е. D(N=2) = 4 log2(N=2). Тогда                                                      0           j i        i      j i
          D(N)=2(3N log N − 3N)+3N=2= 3N log N.                                                                           j=0               j=0
            4     2       4                2     2                                     Ее решение может быть получено численно стандартными методами.
    Припрактическойреализациидляускоренияработыпрограммырекур-                                               Если же p = q (т.е. n = 2q + 1) или p = q + 1 (т.е. n = 2q + 2), то
сиязаменяетсянавложенныециклы,акоэффициенты{f }полиномаP (x)
                                                j               N                      R(x) удается выписать в явном виде методом обратных разностей Тиле.
специальным образом упорядочиваются.Отметим, что имеются эффектив-                                       Определим
                                      n     n     n
ные обобщения данного алгоритма для N = 2 1 · 3 2 · 5 3:::, если число                                         −                 −                  x −x
                                                                                           f (x ) = f(x ), f (x ;x ) =              2    1      ;
                                                                                                 1        1        1   2     f−(x )−f−(x )
простых множителей в разложении не слишком велико.                                                                                                   2         1
                                   2πim1j      2πim2j                                  и далее для k > 2 рекуррентно:
    Замечание.Пустьm1 =m2+mN,тогдаe N                       =eN        , т.е. гармони-
                                                                                             −                                x −x                       −
киm иm насеткесшагом1=N совпадают(посутиэтосоответствуетрабо-                                                f (x ;:::;x ) =                     k     1               +f (x ;:::;x         ):
      1    2                                                                                                       1       k     f−(x ;:::;x )−f−(x ;:::;x            )         2       k−1
тестробоскопакратныегармоникивидныодинаково).Отсюдаимеем,что                                            Докажем, что R(x) =          2        k          1       k−1
низкочастотнаяфункцияf(x) = e−2πix на сеткевидна каквысокочастотная                                       f(x )+                                       x−x1                                      :
   2πi(N−1)x                                                                                           1     −                                        x−x
f(x) = e            . В связи с этим разумно удается восстановить коэффи-                                         f (x ;x )+                                       2
                                                                                                      1   2    f−(x ;x ;x )−f−(x )+:::+                     x−xn−1
циенты только при гармониках до частоты Найквиста m ≤ N. Поэтому                                                                       1  2   3          2          f−(x ;:::;x )−f−(x ;:::;x  )
                                                        2                                                                                              1    n       2    n−1
для повышения качества численной интерполяции непрерывной функции                                        Действительно, явно проверяется, что
f(x) по дискретному набору значений {f(x );x = j ;j = 0;1;:::;N − 1}
                                 j    j    N                                                                                            x−x
лучше выбирать дискретный базис {g(m) = e2πimxj;m = 0;±1;:::;±(N=2−                                                     f(x) = f(x )+                           1                :
                          j                                                                                       1                            x−x
                                                                                                                       f−(x ;x )+                    2
1);N=2}. В этом случае в узлах сетки дискретная функция восстанавлива-                                                                         1   2    f−(x;x ;x )−f−(x )
                                                                                                                                              1   2          1
   Раздел 4.                                                                                                  125
   Далее для k ≥ 2 имеем                              x       −x                                                                                        5. Численное интегрирование
   f−(x;x ;:::;x             ) =                        k+1                            +f−(x ;:::;x ):
      1          k+1        f−(x ;:::;x           ) −f−(x;x ;:::;x )                       1         k
                        1         k+1                  1         k                                                        Лекция 22. Численное интегрирование
   Отсюда выражаем f−(x;x ;:::;x ), подставляем в предыдущее тождество
                        1          k
   и по индукции получаем
                                                                                                                                                                            b
                                               x−x                                                                                                                          R
          f(x) = f(x )+                                           1                                                                Рассмотрим интеграл вида I(f) =                        p(x)f(x)dx; где [a;b]  конечный или
               1                                         x−x
                      f−(x ;x )+                                2                                                                                                           a
                             1    2      f−(x ;x ;x )−f−(x )+:::                                                        бесконечный промежуток числовой оси, и f(x)  произвольная функция
                                                1    2   3             2
                                                                                          :                             из некоторого класса F. Заданная функция p(x) называетсявесовой. Будем
                                      x−x                                                                               предполагать, что на [a;b] функция p(x) измерима, тождественно не равна
  : : : +   −                        −                  n−1                   x−x
          f (x ;:::;x )−f (x ;:::;x                      ) +                       n                                               нулю, и ее произведение на любую f(x) ∈ F суммируемо.
      1          n             2         n−1        f−(x;x1;:::;xn)−f−(x1;:::;xn−1)                                          ДляприближенноговычисленияинтегралаI(f)строятсялинейныеквад-
   Из данного представления для функции f(x) следует, что R(x ) = f(x )                                                                                                                                                                   n
                                                                                 i            i                         ратурные формулы (квадратуры) следующего вида: S (f) = P c f(x ):
   при i = n;n − 1;:::;2;1, т.к. в указанных точках x обнуляются послед-                                                                                                                                                     n                 i      i
                                                                i                                                                                                                                                     i=1
   ние слагаемые цепной дроби как для f(x), так и для R(x). Утверждение                                                                   Постоянные c называются коэффициентами (весами) квадратуры, а x
                                                                                                                                            i                                                                                      i
   доказано.                                                                                                                              ее узлами.
 Применение дробно-рациональной интерполяции по подходящим обра-                                                                        Для каждой функции f(x) ∈ F погрешность квадратурной формулы
   зом выбраннымузлам для функций с нерегулярным характеромповедения                                                                      S (f) определяется как R (f) = I(f)−S (f). При этом оценкой погрешно-
                                                                                                                          n                                   n                      n
   часто оказывается целесообразнее тригонометрической интерполяции и ин-

                                                                                                                        сти на классе F называют величину R (F) = sup                                    R (f) . На практике
                                                                                                                                                                                  n               f∈F      n
   терполяции многочленами.                                                                                                               часто используют оценки сверху для |R (f)|, которые будем обозначать че-
                                                                                                                                                                                   n
                                                                                                                        рез Rn.
                                                                                                                             Метод неопределенных коэффициентов.
                                                                                                                        Дано: n;{x ;:::;x };p(x);[a;b].
                                                                                                                                        1          n
                                                                                                                        Найти: набор {ci} из условия точности квадратуры для многочленов наи-
                                                                                                                                                                                                       k
                                                                                                                        более высокой степени, т.е. I(P ) = S (P ), P (x) = x , k = 0;1;:::n−1.
                                                                                                                                                                      k        n    k      k
                                                                                                                             Постановка задачи корректна, т.к. система
                                                                                                                                  1            : : :  1        c1   b1                                 b
                                                                                                                                  x            : : :  x        c   b                                 Z
                                                                                                                                       1                 n               2               2                             i−1
                                                                                                                                                                         = ; bi= p(x)x dx
                                                                                                                                  : n−1        : : :  : n−1  :                  :                    a
                                                                                                                                      x         : : :  x               cn              bn
                                                                                                                                       1                 n
                                                                                                                        имеет и при том единственное решение c1;:::;cn в случае различных узлов.
                                                                                                                        Пример 22.1. Пусть p(x) ≡ 1. Тогда можно получить следующие квадра-
                                                                                                                        туры:
                                                                                                                                                             S (f) =(b−a)f(a);
                                                                                                                                                             1
                                                                                                                                                            
                                                                                                                                           b                
                                                                                                                                         Z                   S (f) =(b−a)f(b);
                                                                                                                                             f(x)dx ≈  S1(f) = (b−a)f(a+b);
                                                                                                                                                                   1                        2
                                                                                                                                                                            b−a
                                                                                                                                                             S (f) =             (f(a)+f(b));
                                                                                                                                         a                   2
                                                                                                                                                                              2
                                                                                                                                                             S3(f) = b−a f(a)+4f(a+b)+f(b)
                                                                                                                                                                               6                     2
                                                                                                                        (формулы прямоугольников (по крайним и центральной точкам), формула
                                                                                                                        трапеций, формула Симпсона (парабол)).
                                                                                                                                                                             126
      Раздел 5.                                                                                                                        127                                128                                                              Лекция 22. Численное интегрирование
     Оценка погрешности. Нас интересует величина |R (f)| = |I(f) −                                                                                                       Интерполяционные квадратуры. Имеется большая группа квадра-
                                                                                              n
      Sn(f)|. Пусть квадратура точна для многочленов некоторой степени m. То-                                                                                             турных формул, построенных на основе замены f(x) алгебраическим ин-
      гда R (f) = R (f − P ) для всякого многочлена P . Обозначим g(x) =                                                                                                  терполяционным многочленом.
         n                n             m                                                      m
      f(x)−P (x), будем иметь                                                                                                                                                   Дано: n;{x ;:::;x };p(x);[a;b].
   m                                                                                                                                                                             1            n
                                                                                                                                                              Найти: набор {c˜}, заменив подынтегральную функцию f(x) многочле-
                                                                                                                                                                                           i
                  b                                                           b
                Z                             n                             Z                        n                                                  ном Лагранжа L (x) степени n−1, построенным по точкам x
                                                                                                                                                                                      n                                                                                 i
                                           X                                                    X

        |R (g)| =               g(x)p(x)dx −                  c g(x ) ≤ kgk                 |p(x)|dx +               |c | ;
 n                                                  i      i                                                i                                                                                      n                                             n
                                            i=1                                                     i=1                                                                                          X                                             Yx−x
                a                                                            a                                                                                                    L (x) =               f(x )Φ (x);             Φ(x)=                           j :
                                                                                                                                                                                     n                        i     i              i                  x −x
                                                                                                                                                                                                  i=1                                           j=1     i       j
      где kgk = max|g(x)|. Далее также используется равномерная норма.                                                                                                                                                                                            j6=i
       [a;b]
     Данная оценка верна для произвольного P (x). Возьмем в качестве                                                                                                                                   b
                                                                           m                                                                                                             Z
      P (x) интерполяционный многочлен L                                           (x), построенный по нулям мно-                                                                            ˜
 m                                                                   m+1                                                                                           Положим Sn(f) =                        p(x)Ln(x)dx: Отсюда получаем явные формулы для
      гочлена Чебышёва, тогда
                                                                                                                                                                                          a
                                                    (m+1)                  m+1                                                                          набора коэффициентов:
              kgk = kf −P k ≤ kf                             k(b−a)                21−m−1:
                                     m                                 m+1                                                                                                                              b
                                                (m+1)!               2                                                                                                                        c˜  =Z p(x)Φ (x)dx; i = 1;:::;n:
      Таким образом,                                                                                                                                                                                             i                      i
                                                                                                                                                                                                      a
                                                                            b
                                        (m+1)                   m+1 Z                             n                                                           Квадратурныеформулыинтерполяционноготипа,построенныевслучае
                                    kf            k(b−a)                                       X
|R (f)| = |R (g)| ≤                                                           |p(x)|dx +               |c | :                                           весовой функции p(x) ≡ 1 для системы равноотстоящих узлов, называются
    n                 n              (m+1)!              22m+1                                            i
                                                                          a                      i=1                                                    формулами Ньютона–Котеса.
      Пусть p(x) > 0 п.в., а все ci > 0. Тогда                                                                                                                            Лемма 22.1 Набор {ci}, найденный методом неопределенных коэффици-
                                                                                                                                                        ентов, совпадает с {c˜ }.
                                                                                                                                                                                                i
                                                                             b
                     n               n                                     Z
                   X|ci|=Xci=S(1)=I(1)=                                         p(x)dx:                                                                 Доказательство. Пусть квадратура Sn(f) с набором {ci} точна для мно-
                                                                                                                                                                                                                                                       b
                   i=1              i=1                                    a                                                                            гочленов степени n−1. Тогда по определению c˜ = R p(x)Φ (x) = I(Φ ) =
                                                                                                                                                                                                                                               i                     i                  i
                                                                                                                                                                                                                                                      a
      Вэтом случае                                                                                                                                                                                                                        n
                                                                                                                                                        (т.к. degΦ (x) ≤ n−1 ) = S (Φ ) = P c Φ (x ) = c . Утверждение доказано.
                                                                         b                                                                                                i                            n      i               j   i    j         i
                                     (m+1)                   m+1 Z                                                                                                                                                    j=1
                      R =kf                    k(b−a)                2      p(x)dx:
                         n        (m+1)!              22m+1                                                                                                   При вычислении коэффициентов квадратуры на отрезке [a;b] полезно
                                                                        a                                                                               сделать замену переменных x = a+b + b−at и перейти к [−1;1]:
                                                       (m+1)                   m+2                                                                                                                                    2             2
      Если к тому же p(x) ≡ 1, то R = kf                                          k(b−a)                :
                                           n                               2m                                                                                                    b                                                          1
                                                   (m+1)!                2                                                                                                     Z              n                                       Z                  n
                                                                                                                                                                                             Yx−x                             b −a                       Yt−t
                                                                                                                                                                       c =          p(x)                     j dx =                            p0(t)                    j dt:
      Пример 22.2. Для формул трапеций и прямоугольников по центральной                                                                                                                   i                          x −x                          2                              t −t
      точке m = 1, следовательно,                                                                                                                                                                              j=1      i       j                                          j=1 i          j
                                                                                                                                                                               a             j6=i                                        −1              j6=i
                3                                     3
     R = (b−a) kf′′k;                      R = (b−a) kf′′k:
        1                                     2                                                                                                                    Здесь
          8                                     8                          5                                                                                                  a+b b−a                                 a+b           b −a
                                                                (b −a)            (4)                                                                         p0(t) = p                    +            t   , x =                 +            t , i = 1;:::;n.
      Для формулы Симпсона m=3, т.е. R =                                                       kf       k:                                                                                                                         i                               i
                                                        3         1536                                                                                                              2             2                        2              2
 Раздел 5.                                                                                                                                       129                                   130                                                                      Лекция 22. Численное интегрирование
       Оценка погрешности интерполяционных квадратур. Таккаквы-                                                                                                                        Теорема 22.1 Пустьp(x)четнаяотносительносерединыотрезка[a;b]
 полняется тождество S (f) = I(L ), то                                                                                                                                                 функция, и узлы x расположены симметрично относительно a+b, т.е.
                                    n                    n                                                                                                                                                         j                                                                                               2
                                                                                                                                                                             a+b −x =x                            −a+b. Тогда c = c                               .
                                                                                  b                                                                                            2           j         n+1−j               2                    i         n+1−i
                                                                                Z                                                                                                Доказательство.
 Rn(f) = I(f)−Sn(f) = I(f)−I(Ln) =                                                    p(x) f(x)−Ln(x) dx:
                                                                                a                                                                                                                                                                 1
                                                                                                                                                                                                                                                Z                n
  Далее, для произвольной точки x имеем оценку                                                                                                                                                                                    ci = b−a                    p0(t) Y t−tj dt;
                                                                                                                                                                                                                                       2       −1              j=1 ti − tj
                        kf(n)k                                                                                                                                                                                                                                 j6=i
 |f(x) −Ln(x)| ≤                               |ωn(x)|; следовательно,                                                                                                                                                                                 1
                            n!                                                                                                                                                                                                            Z                    n
                                   b                                                                         1                                                                                        cn+1−i = b−a                         p0(t)         Y t−tj dt=
                   kf(n)k Z                                            kf(n)k           b −a n+1Z                                                                                                                                2       −1                  j=1        tn+1−i −tj
 R (f) ≤ R =                                     |p(x)ω (x)|dx ≤                                                              |p0(t)ω0(t)|dt;                                                                                                                        j6=n+1−i
    n                 n           n!                         n                        n!               2                                   n
                                 a                                                                          −1                                                              (так как tn+1−i = −ti, tj = −tn+1−j)
                                                                                                                                                                                                                                  1
0                                                                                                                                                                                                                               Z                    n
 где ω (t) = (t − t1):::(t − tn).                                                                                                                                                                                      =b−a p0(t) Y                                        t +tn+1−j                dt =
 Пример22.3. Дляформулыпрямоугольниковпоцентральнойточкеиме-                                                                                                                                                                      2                                      −(ti −tn+1−j)
                                                                                                                                                                                                                               −1                  j=1
 ем n = 1;p(x) ≡ 1, следовательно,                                                                                                                                                                                                                        j6=n+1−i
                                                               1                                                                                                            (заменим j 6= n+1−i на n+1−j 6=i и переобозначим n+1−j :=j)
                                                          2 Z                                        2
                         R =kf′k(b−a)                             |t|dt = kf′k(b − a) :                                                                                                                                                  1
                            1
                                                   4                                           4                                                                                                                                       Z                n
                                                            −1                                                                                                                                                     =b−a p0(t)Y −t−tj dt=ci;
                                                                                                                                                                                                                              2       −1               j=1 (ti − tj)
 Данную оценку можно улучшить. Действительно,                                                                                                                                                                                                                     j6=i
                                                                                                                                                                                               1                     1
      b                       b                                                                                                                                                      так как Z g(t)dt = Z g(−t)dt. Теорема доказана.
    Z                       Z            a+b                 ′  a+b                   a+b              f′′(ξ)               a+b 2
         f(x)dx =                   f( 2 )+f ( 2 )(x− 2 )+ 2 (x− 2 ) dx:                                                                                                                               −1                    −1
    a                       a                                                                                                                                                          Следствие 22.1 Пусть узлы квадратуры и вес p(x) симметричны отно-
                                                ′′   (b−a)3                                                                                                                 сительносерединыотрезка. Тогда интерполяционнаяквадратура с числом
 Отсюда следует, что R1 = kf k 24 .                                                                                                                                                    узлов 2q −1 точна для многочленов степени 2q−1.
       Формула трапеций: n = 2;p(x) ≡ 1, следовательно,                                                                                                                                Доказательство.ДляпроизвольногополиномаимеемразложениеP                                                                                           (x) =
                                                            1                                                                                                                                    a+b 2q−1                                                                                                             2q−1
                                                   3      Z                                                 3                                                               a2q−1(x− 2 )                          +Q2n−2(x). Интеграл и квадратура для первого слагае-
                 R =kf′′k(b−a) 1                               |t2 − 1|dt = kf′′k(b − a) :                                                                                  мого равны нулю, а для второго совпадают по построению.
                     2                      8         2                                              12                                                                            Составные квадратурные формулы. Пусть h = (b−a)=N и x =
                                                        −1                                                                                                                                                                                                                                                                 k
                                                                                                                                                                            a+kh, k =0;1;:::;N. Введем следующие обозначения:
       Формула парабол (Симпсона): n = 3;p(x) ≡ 1, следовательно,                                                                                                                                                   xk+1


    4                                                                                                I(k)(f) = Z                p(x)f(x)dx; S(k)(f) = S[xk;xk+1](f); k = 0; ::: ;N −1:
                                                         (3)            (b −a)                                                                                                                                                              n                   n



                                         R = f (x)                                      :
                                             3                                                                                                                                                           x
                                                                            192                                                                                                                            k
 Раздел 5.                                                                                131                     132               Лекция 23. Квадратуры Гаусса. Ортогональные многочлены
N−1
 Тогда I(f) = P I(k)(f), и для его вычисления можно применить состав-                                             весьма нетривиальна для n ≥ 3. Поэтому, следуя Гауссу, поступают следу-
k=0                                                                                             ющимобразом.
                                N−1
 ную квадратурную формулу SN(f) = P S(k)(f) с оценкой погрешности                                                     Ортогональные многочлены. Важную роль при построении квадра-
                      n                n                                                        турных формул Гаусса играют ортогональные многочлены на отрезке [a;b]
                                 k=0                                                            с весом p(x) > 0 почти всюду.
       N−1
 |RN(f)| ≤ P |R(k)(f)|:
    n                 n                                                                                               Пусть H  пространство комплекснозначных функций, определенных
       k=0                                                                                                 на [a;b], с ограниченным интегралом (нормой):
     Например, для составной формулы прямоугольников
                                                                                                                        b
                             N−1                                                                                    Z
          SN(f)= b−a Xf x +h                                                                                 (f;g) =      f(x)g¯(x)p(x)dx; p(x) > 0 п.в.;        kfk2 = (f;f):
            1           N               k    2
                             k=0                                                                                       a
 для погрешности на отрезке [x ;x              ] имеем неравенство                                                                                                n
                     k   k+1                                                                    Напомним, что система функций {ψ }                   называется ортогональной, если
                                                                                                                                              j j=0
                                  3                            3                              (ψ ;ψ ) = 0;называетсялинейнонезависимой,еслиPn                        c ψ =0возможно
                      (x     −x )                        (b −a)                                    i   j                                                          j=0 j j
     (k)          ′′             k+1      k          ′′
    R (f) ≤kf k                                  =kf k                       ;
     1               [xk;xk+1]       24                 [xk;xk+1]  24N3                                  только при cj = 0, j = 0;1;:::;n.
                                                                                                    Построение.
                                                          3                                         1-й метод. Система ортогональных многочленов может быть получе-
 следовательно, для всего отрезка [a;b]: RN = kf′′k                  (b −a) :                                                                                                                            n
                                  1           [a;b]      2                                      на из произвольной линейно независимой системы многочленов {ϕ }                             в
                                                    24N                                                                                                                              j j=0
                                                                                                результате стандартной процедуры ортогонализации типа Грама–Шмидта.
                                                                                                                                                                                     k
    Лекция 23. Квадратуры Гаусса. Ортогональ-                                                                     Например, в качестве исходной можно выбрать систему {1;x; :::; x ;:::}.
                                                                                                    2-ой метод. Не сложно доказать, что многочлен ψ (x) является ортого-
ные многочлены                                                                                                                                                                n
                                                                                                нальным многочленом тогда и только тогда, когда ψ (x) ортогонален про-
                                                                                                                                                                  n
                                                                                                извольному многочлену P              (x). Таким образом, коэффициенты ψ (x) =
                                                                                                                                 n−1                                                 n
                                                                                                                        n−1     n                                                     j
                                                                                                a +a x+:::+a           x    +x можнонайтиизсистемыуравнений(ψ ;x )=0,
 Для приближенного вычисления интеграла                                                                             0   1           n−1                                                            n
                                                                                                j = 0;:::;n−1. В данном случае коэффициент an = 1 выбирается из сооб-
                 b                                                                              ражений удобства нормировки.
       I(f) = Z p(x)f(x)dx;          p(x) > 0 п.в.                                                  Впрактических расчетах наиболее употребительны следующие ортого-
                                                                                                нальные многочлены:
               a
                                                                                                    Лежандра [−1;1]; p(x) = 1 ,
 построим при заданном n квадратурную формулу вида                                                                                                                      √ 1
                             n                                                                      Чебышёва первого рода            [−1;1]; p(x) =             2  ,
                            X                                                                                                      −x                  1−x
                 S (f) =        c f(x );                                                            Лагерра [0;∞); p(x) = e             ,
                   n              i    i
                            i=1                                                                     Эрмита (−∞;∞); p(x) =e−x2.
 точную для многочленов наиболее высокой степени. Такие квадратуры на-                                                Замечание. Длястандартныхсистем{ψ (x)} удаетсяпостроитьявные
                                                                                                                                                        n
 зываются квадратурами Гаусса. Таким образом, имеем следующую задачу.                                             формулы. Например,
     Дано: p(x);[a;b];n.                                                                                              для многочленов Лежандра:
     Найти: набор {x ;c }n           из условия точности квадратуры для много-
        i  i i=1                                                                                                                               n
                                                                    k                                                                    1    d      2      n
 членов наиболее высокой степени, т.е. I(P ) = S (P ), P (x) = x , k =
                                     k        n   k      k                                                                   ψ (x) =                (x −1) ;
                                                                                                                              n          n      n
 0;1;:::;n−1;:::;m.                                                                                                                                      2 n!dx
     Так как число свободных параметров квадратуры равно 2n, то можно                                                                                2n+1                   n
                                                                                                                      ψ     (x) =          xψ (x)−            ψ     (x);
 надеяться, что m = 2n−1. Однако, соответствующая нелинейная система                                                                     n+1          n+1       n        n+1 n−1
         Раздел 5.                                                           133               134           Лекция 23. Квадратуры Гаусса. Ортогональные многочлены
 для многочленов Чебышёва:                                                          т.е. все α = 0 при j < n − 2 (здесь Q    = xψ (x) обозначает многочлен
                                                                           j                           j+1      j
                                                                  степени j +1 ). Таким образом,
     ψ (x) = cos(narccosx);
      n
                                                                                   xψ    =α ψ +α       ψ    +α ψ ;
  ψ   (x) = 2xψ (x)−ψ     (x):                                                       n−1     n n    n−1 n−1     n−2 n−2
   n+1         n       n−1
                                                                  при этом α = 1 в силу равенства единице коэффициентов при старшей
         Теорема 23.1 Ортогональный многочлен степени n имеет ровно n раз-                                n
         личных корней на отрезке [a;b].                                                       степени x. Отсюда следует, что
                                                                                    ψ (x) = (x−α     )ψ    −α ψ :
 Доказательство. Если ψ (x) имеет на [a;b] только r < n нулей нечет-                                    n           n−1   n−1    n−2 n−2
        n
                          r
                         Y                                        Итаккак(ψ ;ψ       ) = (ψ   ; ψ  ) = 0, то
         ной кратности, то многочлен Q     (x) = ψ (x)   (x − x ) не меняет знака                          n   n−1      n−2  n−1
          n+r        n            l
                         l=1                                                                         (xψ    ; ψ  )
                        b          r                                                                     n−1  n−1
                       R           Q                                                    b :=α      =              :
         на этом отрезке, что противоречит свойству   p(x)ψ (x)   (x − x )dx = 0                                      n     n−1
                              n            l                                                          (ψ   ; ψ   )
                       a          l=1                                                                   n−1   n−1
         ортогональности ψ (x) всем многочленам низшей степени.
         n                                                                   Далее (ψ ;ψ    ) = 0, т.е.
                                                                           n  n−2
                              n
         Теорема 23.2 Среди многочленов вида P (x) = x + ::: минимальную
                     n                                                    0 = (xψ    ; ψ  ) −α    (ψ   ; ψ   ) −α    (ψ   ; ψ   ):
       b                                                                                    n−1   n−2     n−1  n−1   n−2     n−2  n−2  n−2
         норму kP k2 = Z p(x)P2(x)dx имеет ортогональный многочлен ψ (x) со                                                n−2
n             n                                         n                                                P
                                                                  Поскольку xψ      = ψ     +    β ψ , то (xψ   ; ψ   ) = (ψ   ; xψ   ) =
      a                                                                                    n−2     n−1   i=0 i i        n−1  n−2       n−1    n−2
         старшим коэффициентом 1.                                                              (ψ    ; ψ  ). Таким образом,
                                                                    n−1   n−1
 Доказательство. Пусть P (x)  произвольный многочлен степени n
         n                                                                                          (ψ   ; ψ   )
         со старшим коэффициентом 1. Тогда P (x) = ψ (x)+r       (x), и из ортого-                                  c :=α     = n−1 n−1 >0:
                 n       n      n−1                                                     n     n−2   (ψ   ; ψ   )
         нальности ψ (x) любому многочлену низшей степени следует                                                                  n−2  n−2
   n


2

2

2                                   Лемма 23.1 Ортогональные многочлены на симметричном относитель-







P (x)   = ψ (x)    + r    (x)   :
 n           n         n−1                                        но нуля отрезке с четным весом p(x) обладают свойством ψ (−x) =
                                                                                                                                 n
                                                                      n
                                            n                     (−1) ψ (x). При этом b = 0 для всех n.
         Теорема 23.3 Для ортогональных многочленов вида ψ (x) = x + :::                              n               n
                                   n
         справедливы рекуррентные соотношения                                                     Доказательство. Проверимбазуиндукции. Так какψ (x) = 1, ψ (x) =
                                                                                                                         0         1
   ψ (x) = (x−b )ψ     (x) −c ψ   (x); n = 2;3; ::: ;                        x, то из четности p(x) и полученной формулы для bn следует, что b2 = 0.
    n           n  n−1       n n−2                                           Шаг индукции: пусть утверждение леммы верно для полиномов степени
          (xψ    ; ψ  )         (ψ   ; ψ  )                                  до (n − 1) и коэффициентов до b включительно. Тогда из рекуррентной
     bn =     n−1  n−1 ;   cn =   n−1  n−1 >0:                                                               n
(ψ   ; ψ   )         (ψ   ; ψ  )                                  формулы для ψ получаем четность/нечетность ψ (x) и, как следствие, из
  n−1   n−1            n−2  n−2                                                  n                                n
 Доказательство. Представим многочлен xψ         (x) в виде: xψ     =               формулы для коэффициентов равенство bn+1 = 0.
          n                                              n−1              n−1
          Pαψ.Определимкоэффициентыα из условийортогональности                                 Теорема 23.4 Нулиортогональных многочленов с фиксированным на от-
   k k                             j                                                резке [a;b] весом p(x) > 0 перемежаются, т.е.
         k=0
    (xψ    ; ψ ) = α (ψ ;ψ ):                                                          (n)   (n−1)         (n−1)
       n−1   j     j  j  j                                                                                         (n)
                                                                                  a < x   <x      <:::<x        <x <b:
                                                                                       1     1             n−1     n
         При j < n−2 имеем                                                                        Доказательство.Будемстроитьдоказательствопоиндукции.Базаин-
                                                                                                                                (1)
     (xψ    ; ψ ) = (ψ  ; xψ ) = ψ   ; Q    =0;                              дукции. Проверим для ψ (x);ψ (x);ψ (x). Имеем: ψ = 1, ψ = x−x      . Так
        n−1   j     n−1    j      n−1   j+1                                                         0     1     2             0      1       1
      Раздел 5.                                                                                                                         135                                136                       Лекция 23. Квадратуры Гаусса. Ортогональные многочлены
              2                          (1)                                                                                                                   Вэтойпостановкеимеется2nсвободныхпараметров(узлыx икоэффи-
      как ψ (x) = x + ::: и a < x                                < b, то signψ (b) = 1. Рассмотрим рекур-                                                                                                                                                                                     i
         2                                          1                              2
                                                                 (1)                                                                                     циенты ci неизвестны), поэтому можно попытаться построить квадратуру,
      рентное соотношение для ψ в точке x = x                                          :
                                      2                          1
                                        (1)                       (1                                                                                     точную для многочленов степени 2n−1.
                                ψ (x         ) = −c ψ (x ) < 0;
                                   2    1               2 0       1                                                                                      Лемма 23.2 Не существует квадратуры с n узлами, точной для всех
      т.к. c > 0. Все корни ψ принадлежат отрезку [a;b], поэтому signψ (a) = 1.                                                                                            многочленов степени 2n.
        2                                2                                                                              2
      Таким образом, имеем перемены знака ψ (x) в последовательно располо-
                                                                2                                                                                                                                                                               2                       2
                           (1)                                                                                                                           Доказательство. Возьмем P (x) = (x − x ) ···(x − x ) . Тогда 0 =
      женных точках a < x                         <b, следовательно,                                                                                                                                                               2n                          1                      n
                           1                                                                                                                             S (P )6=I(P )>0.
                                                                                                                                                           n     2n               2n
                                           (2)         (1)        (2)                                                                                          Отметим, что не рекомендуется строить квадратуры Гаусса методом
                                 a < x          <x <x <b:
                                           1           1          2                                                                                      "неопределенных коэффициентов и узлов" из условия точности квадрату-
      Шагиндукции. Пусть нули перемежаются для ψ                                                     ; ψ       :                                                           рыдлямногочленовнаиболеевысокойстепени.Полученнаятакимобразом
                                                                             n−1       n−2                                                               система нелинейных уравнений весьма нетривиальна уже при n = 3.
                       (n−1)           (n−2)                     (n−2)            (n−1)                                                                        При построении квадратурных формул Гаусса ключевым является сле-
              a < x              <x              <:::<x                    <x              <b:
                       1               1                         n−2              n−1                                                                    дующее утверждение.
                     n                 (n)                                                                         (n−1)
      Так как ψ (x) = x +::: и x                               <b, то signψ (b) = 1. Подставим x = x
      n                                n                            n                                              n−1
      в рекуррентное соотношение                                                                                                                                           Теорема 23.5 Пусть узлы x ;:::;x  нули ортогонального многочле-
                                                                                                                                                                                                                1            n
                                                                                                                                                         на ψ (x) степени n на [a;b] с весом p(x), и S (f)  квадратура, точная
                      ψ (x) = (x−b )ψ                       (x) − c ψ              (x):                                                                          n                                                                            n
                         n                      n     n−1               n n−2                                                                            для многочленов степени n−1. Тогда квадратура точна для многочленов
      Имеем:                                                                                                                                                           степени 2n−1.
                                    (n−1)                                (n−1)
                          ψ x                   =−c ψ                  x             :
                             n      n−1                  n n−2           n−1                                                                                   Доказательство. Для произвольного многочлена имеем P                                                                   (x) =
                                                                                                                                                         ψ (x)q            (x) +r            (x) = F(x)+G(x). Поэтому                                                         2n−1
                                                                   (n−2)            (n−1)                                                                  n        n−1                n−1
      Напомним, что здесь cn > 0. Из условия x                                                 <x               <b следует, что
                                                                   n−2              n−1
         (n−1)                                                        (n−1)                                                                                                                                      b                                   b
      ψ           x              > 0; таким образом, ψ                          x              < 0. Аналогично показы-                                                                                                     R                                   R
  n−2        n−1                                                    n      n−1
                                                                                                                                                                                  I(P           ) =       P          (x)p(x)dx =              G(x)p(x)dx:
                    (n−1)                                                                                                                                                                 2n−1           a     2n−1                          a
      вается, что ψ                 x              > 0. И так далее. Так как многочлен имеет вид
             n      n−2
      n                          (n)                                                                                                                                                                         b
      ψ (x) = x +::: и a < x                           , и все его корни принадлежат отрезку [a;b], то
  n                            n            1                                                                                                                       Равенство нулю интеграла R F(x)p(x)dx следует из определения ортого-
      signψ (a) = (−1) . Таким образом, имеем перемены знака ψ (x) в после-
         n                                                                                                     n                                                                                                       a
                                                            (n−1)              (n−1)
      довательно расположенных точках a;x                                             ; : : : ; x         ; b, что и завершает
                                                            1                  n                                                                         нального многочлена ψ (x). Для квадратуры имеем
                                                                                                                                                                                                   n
      доказательство.
                                            m ∞                                                                                                                                                                                                  b
     Замечание. Полиномы {x }m=0 не могут быть ортогональны ни на                                                                                                                                                                                         Z
      каком отрезке [a;b] ни с каким весом p(x) > 0:                                                                                                                                              S (P             ) = S (F +G) = S (G) =                             G(x)p(x)dx:
     КвадратурныеформулыГаусса.Изполученныхранееоценокследу-                                                                                                                                  n     2n−1             n                       n
                                                                                                                                                                                                                                                a
      ет, что точность квадратуры повышается с повышением степени многочле-
      новдлякоторыхквадратураточна.Рассмотримзадачупостроенияквадра-                                                                                                       Равенство S (F) = 0 следует из условий ψ(x ) = 0, т.к. F(x ) = 0. В резуль-
                                                                                                                                                                              n                                                         j                          j
      тур Гаусса: при заданном числе узлов n построить квадратурную формулу                                                                                                тате имеем равенство I(P                              ) = S (P               ). Теорема доказана.
                                                                                                    b                                                                                                  2n−1             n     2n−1
     n                                                                                            Z                                                            Данноеутверждениепозволяетразбитьсампроцесспостроенияквадра-
      S (f) = Xc f(x ) для вычисления интегралов вида I(f) =                                                            p(x)f(x)dx;                                        туры Гаусса на два последовательных этапа:
 n                    i       i
    i=1                                                                                                                                                  нахождение нулей ортогонального многочлена ψ ,
                                                                                                  a                                                                                                                                                  n
      точную для многочленов максимально высокой степени. Весовая функция                                                                                                  нахождение весов методом неопределенных коэффициентов.
      p(x) здесь предполагается почти всюду положительной.                                                                                                                       Докажем следующее полезное утверждение.
Раздел 5.                                                                             137                    138                                           Лекция 24. Оптимизация квадратур
Лемма 23.3 Все коэффициенты квадратуры Гаусса положительны.                                                  Данную квадратуру также называют квадратурой Эрмита. Соответству-
                                                                                           ющими ортогональными многочленами являются многочлены Чебышёва,
    Доказательство.Рассмотриммногочленстепениk =2n−2видаP (x) =
                                                                  k                        поэтому корни Tn(x) задают узлы квадратуры n-го порядка. Чтобы для
  n
 Q           2                                                                                               данного набора коэффициентов квадратура была точна для произвольного
    (x−x) . Для интеграла от этого многочлена формула Гаусса дает точ-
    i
 i=1                                                                                                         многочлена P         (x) достаточно проверить, что квадратура точна для про-
 i6=k                                                                                                                        2n−1                                 n−1
ный результат:                                                                                               извольного P       (x). Представим P         (x) = P a T (x) и установим, что
                                                                                                          n−1                       n−1         m=0 m m
      b
     Z                     n                n                                                         квадратура точна для T         при m<n.
        p(x)P (x)dx = Xc P (x ) = Xc P (x )+c P (x ):                                                                             m
   k                j  k  j          j  k   j     k k k
     a                    j=1              j=1
                                j6=k                                                         Лекция 24. Оптимизация квадратур
Поскольку справедливо P (x ) = 0 при j 6= k, следовательно, имеем c =
             k   j                                                 k
 b
R p(x)P (x)dx=P (x ) > 0: Лемма доказана.
  k          k   k                                                                                    Рассмотрим задачу вычисления интеграла с оптимальными в некотором
a                                                                                                            смысле затратами. Пусть заданы область интегрирования [a;b], вес p(x),
    Так как квадратуры Гаусса точны для многочленов степени m = 2n−1                                         класс подынтегральных функций F.
и ck > 0, следовательно, верна оценка
                                                                                                                                             N
                                                                                               Погрешностью квадратуры S (f) = Pc f(x ) на классе функций F
                                       b                                                                                          N              i    i
               (m+1)           m+1 Z                                                                                                         i=1
     R ≤kf           k(b−a)         2    p(x)dx:                                           называют величину R (F) = sup|R (f)|; где R (f)  погрешность на
       n     (m+1)! 2m+1+m                                                                                            N                 N              N
                                      a                                                                                          f∈F
                                                                                           функции, т.е. R (f) = I(f)−S (f).
                                                                                                             N                  N
Имеет место следующее полезное утверждение.                                                                      Нижняя грань W (F) = inf |R (F)| называется оптимальной оценкой
                                                                                                                   N         c ;x   N
                                                                                                                              i  i
Лемма 23.4 Пусть весовая функция p(x)  четная относительно сере-                                            погрешности квадратуры на классе. Если существует квадратура, для ко-
                                                                                           торой R (F) = W (F), то такую квадратуру называют оптимальной на
дины отрезка интегрирования (a+b)=2. Тогда узлы квадратуры Гаусса для                                                  N           N
       b                                                                                   данном классе.
вычисления I(f) = Z p(x)f(x)dx расположены симметрично относитель-                                           Пример 24.1. Пусть F: |f′(x)| ≤ A; x ∈ [0;1]. Можно доказать, что опти-
     a                                                                                     мальная квадратура  составная формула прямоугольников по централь-
но (a + b)=2, а соответствующие симметричным узлам коэффициенты                                              ной точке:
                                                                                                                             N
квадратуры равны.                                                                                                               S (f)= 1 Xf j−1=2 ; R (F)≤ A :
                                                                                                               N        N              N           N        4N
Действительно, симметрия узлов квадратуры следует из симметрии (косо-                                                                         j=1
симметрии) ортогонального многочлена, а симметрия коэффициентов есть                                         Если требуется обеспечить точность интегрирования ε, а соответствующее
следствие симметрии узлов.                                                                                   N ≥ A для нас не достижимо, то можно изменить класс F и либо попы-
    Отметим, что на данный момент имеются готовые таблицы квадратур                                                4ε
     12                                                                                                      таться построить оптимальную квадратуру (что часто нетривиально), либо
до 2    с 20-ю знаками для стандартных весовых функций.                                                      для выбранного класса найти асимптотически оптимальную квадратуру, и
                      1
                    Z       1                                                              для нее решить задачу об оптимальном распределении узлов.
Пример 23.1. Для интеграла                √        f(x)dx квадратура Гаусса имеет                                Пусть F : kf′′k          ≤A,i=1;:::;q. Представим
                                                                                                                C[a ;b ]     i
                                2                                                                                   i i
                    −1    1−x
вид                                                                                                                                             b                 b
                                                                                                                                                 i
                  n                                                                                                         Z               q Z
    S (f) = π Xf(x );         x =cos2j−1π:                                                                          I(f) =      f(x)dx = X        f(x)dx:
     n        n          j      j          2n
                j=1                                                                                                          a             i=1ai
Раздел 5.                                                                          139                   140                                          Лекция 24. Оптимизация квадратур
                                                                                                                                                        2
                                                                                                                                          q     3
На каждом отрезке [ai;bi] длины Hi будем применять составную формулу                                                                                       PAiH 6µ 3
                                                                                       Подставим N в условие на R , получим                     i          =ε. Отсюда сле-
                                                                                                       i                  N                  12H2   Ai
трапеций с шагом hi = Hi=Ni:                                                                                                                              i=1     i
                                                                                                       q          1
                                                                                                    2 P      Ai3
  b                                                                                               дует, что µ3       Hi        =ε. Из данного выражения находим µ, подставим
   i
 Z f(x)dx ≈ h f(ai) +f(a +h )+:::+f(b −h )+ f(bi):                                                             i=1      48
      i    2          i    i              i    i      2                                в формулы для Ni, и результат округлим.
 ai                                                                                                   Полученныеформулыпозволяютсформулироватьработуразумногоал-
                                                                                       горитма: строим набор подотрезков [ai;bi] плавного изменения f′′(x), на
При этом                                                                                                 каждом отрезке приближенно оцениваем A = kf′′k                      , находим N по
                                                                                                                                           i          [a ;b ]             i
                                                                                                                                                       i  i
         ′′         3         3                       q               q       3                   указанным формулам и далее вычисляем по составной формуле интеграл.
      kf k[a ;b ] H      AH                         X                XAH
|R(i)(f)| ≤         i i   i  ≤ i i ; |R (f)| ≤ R =             |R(i)(f)| =        i  i :                 Отметим,чтобольшинствоалгоритмовбазируетсянакачественнойстороне
          12     N2      12N2       N          N                         12N2
        i         i                      i=1              i=1      i                   полученных результатов, а не на количественных соотношениях. В данном
                                                                                                                          1    H3       λ
                                                                                       случае найденная формула             A i =          означает, что погрешность по
    Первая постановка оптимизационной задачи.                                                                                              12 iN3         2
Дано: q;N.                                                                                                                                         i
                                                                                       каждому элементарному подотрезку интегрирования одинакова в случае
  	 Pq
Найти Ni ,        i=1 Ni = N, из условия минимума погрешности RN, т.е.                                   оптимального распределения узлов.
                                                                                           ПравилоРунгеоценкипогрешности.Пустьдляподсчетаинтеграла
        RN →min;                                                                                b
           Ψ=N +:::+N −N=0:                                                            I(f) = R p(x)f(x)dx применяется некоторая составная формула SN(f) =
                  1           q                                                                                                                                       n
                                                                                                a
                                                                                        N
Далее будем считать, что Ni  действительные числа (хотя интересуют                                       PS(i)(f). Можнодоказать,чтовслучаедостаточногладкойf имеетместо
                                                                                             n
целые). Тогда для функции Лагранжа L = RN +λΨ имеем:                                                     i=1
                                                                                       следующее представление
          3
      ∂L        AH                          A
=− i i +λ=0⇒N =H                     i 1=3; i = 1;:::;q:                                                       I(f) = S(N)(f)+Chm +O hm+1
     ∂N         6N3                  i      i 6λ                                                                                    n
         i          i
                                       q                                               с не зависящей от h константой C. По сути, это соответствует разложению
             P                        P
Подставляем N в условие           q   N =N,имеем           H Ai 1=3 =N. Из дан-                          функции ошибки по степеням h.
i               i=1   i                    i  6λ                                                                 (2N)
                                      i=1                                                  Обозначим через Sn         (f) составную формулу, полученную применени-
ного выражения находим λ и подставляем в формулы для Ni. Полученные                                      ем формулы S(N)(f) с вдвое большим числом узлов (половинным шагом).
такимобразомNi нецелые,поэтомурезультатокругляем.Найденноевито-                                                           n
ге распределение узлов несколько отлично от оптимального, но дальнейшее                                  Тогда с той же C находим:

уточнение вряд ли разумно.                                                                                                                                 m
                                                                                                            I(f) = S(2N)(f)+C        h           m+1
    Вторая постановка оптимизационной задачи.                                                                                          n               2     +O h          :
Дано: q;R     =ε.
     N
  	                                                  Pq                                                                                             m+1
Найти Ni из условия минимума числа узлов N =                    i=1 Ni, т.е.                             Следовательно, с точностью до членов O h                   справедливо следующее
                                                                                       правило Рунге:
         N =N1+:::+Nq →min;                                                                                        (2N)         (N)
           Ψ=R −ε=0:                                                                                               S     (f)−S      (f)
                   N                                                                                         C≈ n                n      ;
                                     1                                                                                   1−2−m
Для функции Лагранжа L = (N1+:::+Nq)+ µ(RN −ε), выписанной для                                                                                      S(2N)(f)−S(N)(f)
                                                                                                             I(f)−S(2N)(f) ≈ n                  n       :
удобства в терминах µ = 1 при действительных N , имеем                                                                                  n                   m
            λ                            i                                                                                               2 −1
                                                                                                                                      (N)     (2N)
         ∂L          1     AH3                          A 1=3                                     Отсюда следует, что используя значения S               и S       квадратуры с глав-
   =1+        − i i      =0⇒N =H               i     :                                                                                    n       n
        ∂N           µ      6N3               i     i   6µ                                        ным членом погрешности Chm, можно построить квадратурную формулу
 i                  i
 Раздел 5.                                                                                 141                     142                       Лекция 25. Интегрирование функций с особенностями
      S(2N) −S(N)                                                                                    ПравилоРунгепозволяетсформулироватьпринциппостроенияпрограмм
 S(N;2N) = S(2N) +        n         n    порядка точности не ниже (n+1).
   n           n            2m−1                                                                                   интегрирования с автоматическим выбором шага, учитывающих поведение
     Приприменении данного правила к формуле трапеций получается фор-                                              интегрируемыхфункций.Ихсутьзаключаетсявследующем.Пустьдляин-
 мула Симпсона, т.к. в этом случае m = 2, и на отрезке [ai;bi] имеем:                                              тегрированияприменяетсянекотораяквадратураS(f).Дляприближенного
                                                                                                 вычисления интеграла на отрезке [ai;bi] длины hi, находятся два значения
                     b −a                                                                                 [a ;b ]          [a ;a +h =2]    [a +h =2;b ]
            S(N) = i        i (f(a ) + f(b ));                                                   S1 = S i i и S2 = S i i           i   +S i i         i . С их помощьюпо правилуРун-
             n          2          i        i
 (2N)     bi − ai               ai +bi        bi − ai     ai +bi                                        ге оценивается главный член погрешности. Если погрешность мала, тогда
      Sn      =            f(ai)+f(             )   +            f(         ) +f(bi) :                             значение интеграла считается найденным. В противном случае требуется
  4                      2              4             2                                          уменьшить длину отрезка интегрирования h .
                                                                                                                                                         i
 Формула Симпсона имеет четвертый порядок точности, поэтому в данном                                                   При нахождении интеграла на большом отрезке [a;b] естественно выде-
 случае порядок главного члена погрешности увеличится на 2.                                                        ляются две процедуры, которые принято назвать вертикальной и горизон-
                                                   S(2N) −S(N)                                   тальной.
     ПроцедурапостроенияформулыS(N;2N) =S(2N)+ n                                 n    являет-                          В случае горизонтальной процедуры фиксируются два числа ε < ε
                              n            n           2m−1                                                                                                                            1      2
                        (N)      (2N)                (N;2N)                                      (точность) и начальный шаг h1. На отрезке [a1;b1], a1 = a, b1 = a1 + h1,
 ся экстраполяционной,т.е. при Sn             6=Sn       величинаSn            всегда лежит                        находятся значения S1, S2, R = |S1 −S2|.
 вне отрезка с концами S(N) и S(2N). Действительно, если S(2N) > S(N), то
              n        n                                  n          n                               Если R ≤ ε2, то точность интегрирования на данном отрезке считает-
 S(N;2N) > S(2N) > S(N). Если S(2N) < S(N), то S(N;2N) < S(2N) < S(N).
   n           n          n             n         n          n            n          n                             ся удовлетворительной, поэтому переходим к следующему отрезку [a2;b2]
     Пусть для вычисления интеграла I(f) от некоторой функции использу-                                            длины h2. Если ε1 ≤ R ≤ ε2, то h2 = h1, т.е. шаг признается оптимальным,
 ется квадратурная формула S(N), фактический порядок точности m кото-                                              если R < ε , то шаг признается излишне мелким и h = 2h .
                     n                                                                                         1                                                    2      1
 рой неизвестен для данной функции. Рассмотрим процесс Эйткена числен-                                                 Если же R > ε2, то точность считается недостаточной, поэтому пере-
 ной оценки значения порядка m, являющийся обобщением правила Рунге.                                               определяем h1 = h1=2, и метод заново применяется для [a1;a1 +h1].
 Пусть I(f)  точное значение интеграла. Вычислим значения S(N), S(2N),                                                Значение интеграла по всему отрезку [a;b] находится как сумма найден-
                                                                n      n
 S(4N). Если учитывать только главный член погрешности, то получаем си-                                            ных по подотрезкам интегралов.
   n
 стему трех уравнений                                                                                                  Вслучае вертикальной процедуры также фиксируется точность ε. Для
                        (N)                                                                      всего отрезка [a;b] находятся значения S1, S2, R. Если R ≤ ε, то считается,
              I(f) ≈ Sn (f)+Chm;                                                                 что значение интеграла по всему отрезку найдено. Иначе исходный отрезок
                                                                                                                            b−a         b−a
              I(f) ≈ S(2N)(f)+C h m;                                                             делится на два [a;a + 2 ], [a + 2 ;b], и метод применяется рекурсивно к
                        n               2
                                                                                               каждому из подотрезков.
              I(f) ≈ S(4N)(f)+C h m
                        n               4                                                            Несложнопривестипримерыфункций,длякоторыхкаждыйизметодов
 c неизвестными I(f);C и m. Формальное решение позволяет найти I(f),                                               дает плохой результат (например, исходная функция неотрицательна, а все
 C, m. Однако для конкретного N, отброшенные слагаемые O(hm+1) мо-                                                 узлы попадают в нули).
 гут оказаться порядка Chm, что существенно исказит ответ. Поэтому бо-
 лее разумным является следующий подход. Так как S(2N)(f) − S(N)(f) ≈
                                                    n             n                                 Лекция 25. Метод Монте–Карло. Интегриро-
 C(1−2−m)hm, следовательно,
                                                                                                       вание функций с особенностями
      F(lnh−1) = ln|S(2N)(f)−S(N)(f)|−1 ≈ const+mlnh−1:
                n            n
 Дифференцирование асимптотических равенств вообще говоря незаконно,                                               Рассмотрим задачу вычисления интеграла в многомерном случае:
 поэтому величину m можно попытаться найти в результате линейной ин-                                                                                  Z
 терполяции F(lnh−1) по нескольким значениям h=2k (например, в смысле                                                                        I(f) =      f(ω)dω;      Ω⊂Rd; d>1:
 наименьших квадратов).                                                                                                                               Ω
Раздел 5.                                                                          143                   144                     Лекция 25. Интегрирование функций с особенностями
Пусть f ∈ C1;:::;1(A;:::;A)| . Можно доказать, что не существует мето-                                   т.е. вероятность того, что случайная величина с такой функцией распре-
               Ω
дов интегрирования на данном классе с оценкой погрешности лучше, чем                                     деления не превосходит по модулю значения y > 0 асимптотически равна
|R(f)| ≥ cA , где d  кратность вычисляемого интеграла. И если необхо-                                   p0(y).
       1
    Nd                                                                                                Таким образом, при больших N с вероятностью близкой к p0(y) выпол-
димо обеспечить точность |R(f)| ≤ ε = cA10−3, то N ≥ 103d. Поскольку                                     няется неравенство:
нахождение каждого значения подынтегральной функции обычно требует
значительного числа арифметических действий, то уже при d = 6 такое                                                                                          p              rD(s)
условие на N может оказаться невыполнимым. В этом случае для дости-                                                  |SN −I(f)| = |SN(f)−M(SN)| ≤y D(SN) =y                     N :
жениятребуемойточностиможно попытатьсядетальнее описать класс F и                                        Данная оценка позволяет сформулировать правила 3-х сигм: y = 3, p (3) ≈
применить более точные методы.                                                                                                                                                           0
    Рассмотрим иной приближенный способ вычисления значения интегра-                                     0:997; и 5-и сигм: y = 5, p0(5) ≈ 0:99999. В правой части оценки стоит
                                                                                       неизвестная величина D(s) = D(f) = I(f2)−I2(f), которую можно оценить
ла, оценка погрешности которого гарантируется только с некоторой степе-                                  в процессе вычислений.
нью достоверности.                                                                                           ПриведемпрактическуюсхемупримененияметодаМонте–Карло.Пусть
    ПустьобластьΩ=[0;1]d.Рассмотримслучайнуювеличинуp,равномер-
но распределенную в Ω. Построим с.в. s = f(p). Тогда                                                     мера Ω равна единице. Пусть ε  требуемая точность, а 1−η  требуемая
                                                                                       мера надежности. Из условия
          M(s)=R f(p)dp=I(f)=M(f);                                                                                                             ∞
        Ω                                                                                                                          Z      2
            2       2           2     2                                                                                        2       −t
          D(s) = M(s )−M (s)=I(f )−I (f)=D(f):                                                                                     η ≤ √         e 2 dt
                                                                                                                                2π
    Пусть выбрано N случайных величин p , независимых в совокупности.                                                                                y
                                j
                                         N                                             определим y.
    Определим sj = f(pj) и построим с.в. SN = 1 Xsj: Тогда:                                                  Далее последовательно
                                     N j=1                                             для n = 1;2;::: строятся случайные точки p , находятся
                                                                                                                                           n
                                                                                           t  =t      +f(p ), d = d         +f2(p ),
           N                                                                                n     n−1        n    n     n−1     2   n
        1 X                                                                                S (f) = t =n, D (f) = d =n−S (f),
                                                                                             n        n       n        n        n
       M(SN)=             M(sj) =M(s);                                                                       p
       N                                                                                   εn = y    Dn(f)=n;
           j=1                                                                         пока ε > ε.
             N                                                                                 n
            X              X
        1                                    1                                           По окончании расчета полагаем, что |I(f)−SN(f)| ≤ ε с вероятностью
       D(SN)= N2           D(sj)+2        cov(si;sj) = ND(s):
            j=1            i<j                                                         1−η.
                                                                                           Отметим, что наибольшиепроблемыданногометодазаключены не вве-
        SN −M(SN)                                                                      роятностном подходе вычисления интеграла, а в отсутствии датчиков слу-
Рассмотримс.в.ZN =          p            . Согласноцентральнойпредельнойтео-                             чайных чисел с требуемыми характеристиками. Формально трудоемкость
             D(SN)
реме случайная величина ZN распределена асимптотически нормально с                                       метода не зависит от размерности d. Однако, типичным для практики яв-
функцией распределения                                                                                                                                                       p
                                                                                       ляется требование малости |SN −I(f)|=I(f), т.е. малости               D(f)=N=|I(f)|.
                                                                                                               p
                            y                                                          При этом величина          D(f)=|I(f)| быстро растет с увеличением кратности
                           Z      2
                       1        −t                                                     d интеграла, что приводит к возрастанию вычислительных затрат.
            Φ(y) = √           e 2 dt:
                       2π                                                                  ДляускорениясходимостиметодаМонте–Карломожнопопытатьсяпред-
                          −∞                                                           ставить подынтегральную функцию в виде суммы f(ω) = F(ω)+G(ω), где
При этом                                                                                                 F интегрируетсяявно и содержит все выстро меняющиеся компоненты, а G
                                       ∞
                                      Z      2                                         имеет малую дисперсию. Существенное ускорение можно получить за счет
                                  2       −t
  P(|ZN| ≤ y) ∼ p0(y) = 1− √             e 2 dt;                                       разбиенияисходнойобластинаподобластис малымизменениемфункцииf
                                   2π                                                  (например, задача об "Опросе" или интегрирование signx на [−1;1]). При
                                      y
Раздел 5.                                                                          145                   146                     Лекция 25. Интегрирование функций с особенностями
наличииинформацииоповеденииподынтегральнойфункциитакжеможно                                              и функции cosp и sinp вычисляются с погрешностями O(2−t) и O(p2−t)
изменить плотность распределения узлов.                                                                  соответственно, где t  длина мантиссы. Вследствие этого коэффициенты
    Быстро осциллирующие функции. Пусть требуется вычислить ин-                                          c1 и c2 приобретают погрешность O(2−t)=p. Таким образом, при малых p
теграл                                                                                                   лучше построить квадратурную формулу, не выделяя вес.
           b
  I(f) = Z exp{iωx}f(x)dx;        ω(b−a)≫1;                                                Вычислениеинтеграловотфункцийсособенностями.Существен-
                                                                                       ную часть реально встречающихся подынтегральных функций составляют
          a                                                                            функции с особенностями, причем особенность может содержаться либо в
где f(x)  гладкая функция.                                                                              функции, либо в ее производных. Если нерегулярность функции не вызва-
    Функции Re(exp{iωx}f(x)); Im(exp{iωx}f(x)) имеют на рассматрива-                                     на колебательным характером ее поведения, то для вычисления больших
емом отрезке примерно ω(b − a)=π нулей. Такие функции могут быть хо-                                     серий интегралов такого типа применяется ряд специальных приемов: вы-
рошо приближены многочленами степени n ≥ ω(b − a)=π, следовательно,                                      деление особенности в весовую функцию, разбиение интеграла на части,
для непосредственного вычисления интеграла I(f) потребуется примене-                                     аддитивное представление подынтегральной функции, замена переменных
ние квадратур, точных для многочленов очень высокой степени. Поэтому                                     и т.д.
более выгодным может оказаться использование exp{iωx} в качестве весо-                                       1. Выделение весовой функции. Пусть требуется вычислить инте-
                                                                                                        b
вой функции.                                                                                             грал I(f) = Z f(x)dx с нерегулярной функцией f(x). В этом случае при-
    Зададимсяузламиинтерполированияx ;j = 1;2;:::;n;построиммного-
                               j
член ЛагранжаLn(x) и рассмотрим квадратурнуюформулу, сделав замену                                                      a
  b +a     b −a                                                                        менение стандартных методов интегрирования недопустимо, так как оцен-
переменных x =            +        t. Будем иметь:                                                       ка погрешности выражается через f(m)(ξ). Пусть f(x) представима в виде
    2        2                                                                         f(x) = p(x)g(x), где p(x) содержит особенность, но имеет простой вид, а
b                       
          Z          n                                       n                                    g(x)  гладкая функция. В этом случае разумно применение квадратур-
   iωx   X                        b −a iω(a+b) X
                                           2                                         ных формул для интегралов с весом.
S (f) =      e          f(x )Φ (x)     dx =        e            c f(x );
  n                         j   j               2                j    j
         j=1                                     j=1                                                                           1                1
          a                                                                                                                              Z     dx         Z      1        dx
    1                                                                                           Пример 25.1. Для интеграла                √          =     √         √          с весо-
   Z                                                                                                                                                4                2         2
       ipt   Yt−tk                    b −a                                                                                              −1    1−x         −1    1−x 1+x
где cj =−1 e     k6=j tj − tkdt;      p =    2 ω:                                                      вой функцией √ 1 2 рассмотренный метод приводит к т.н. квадратуре
При этом оценка погрешности                                                                              Эрмита:             1−x
       b
      Z                                                                                                            n
    |R (f)| = |     exp{iωx}f(n)(ξ(x))(x −x ):::(x−x )dx| ≤                                                               π X                       2j −1
       n                                        1            n                                                  Sn(f) =         g(x );    x =cos           π; j = 1;:::;n:
                                                                                                               n         j      j          2n
      a                                                                                                          j=1
                   (n)              n+1
           ≤Ckf kC[a;b](b−a)                                                           Обратимвнимание, что соответствующимиортогональными многочленами
не зависит от ω.                                                                                         являются многочлены Чебышёва, и корни Tn(x) задают узлы квадратуры
    Приведем расчетную формулу для n = 2; d = −1; d = 1:                                                 n-го порядка.
                                    1          2                                           2. Явноевыделениеособенности.ПустьвычисляетсяинтегралI(f)=
         1                                                                               1
c    =Z 1∓teiptdt= sinp ± pcosp−sinpi:                                                 Z        α
 1;2         2              p           p2                                                g(x)x dx; где α ∈ (−1;1); g(x)  гладкая функция, g(0) 6= 0: Можно вы-
       −1                                                                               0         α
    Отметим, что при малых ω данные формулы могут иметь большую вы-                                      делить x в качестве весовой. Можно разбить интеграл на сумму двух по
числительную погрешность. Действительно,при малых ω величина p мала,                                     отрезкам [0;ε] и [ε;1]. Первый отрезок поделить на k частей и на каждом
 Раздел 5.                                                                              147
                                        ε                        b
                                                                  k
                                       Z               k        Z                                            6. Нелинейные уравнения
                                           α         X              α
 заменить g(x) на постоянную функцию g(x ):                 x g(x) ≈        g(x )    x dx:
                                   i                         i
                                       0              i=0      a
                                                                 k                            Лекция26.Методырешениянелинейныхурав-
 Погрешность такой замены на каждом подотрезке можно оценить, напри-
 мер, на основе метода Тейлора: g(x) = g(x ) + g′(ξ )(x − x ). Для x ∈ [ε;1]                                        нений
                                   i        i         i
 возможно применение стандартных методов интегрирования.
                       1
    При вычислении интеграла Z               lnx2dx можно представить подынте-                                 Итерационныеметодывычисленияизолированного(отделенногоотдругих)
                         1+x                                                                 корня z уравнения f(x) = 0, как правило, требуют указания какой-либо об-
                      0                                                                      ласти D, содержащей этот единственный корень, и алгоритма нахождения
 гральную функцию в виде f(x) = G(x)+g(x), где                                                                 очередного приближения x              по уже имеющимся x , :::;x            .
                                       2                                                                                      n+1                            n       n−k
          G(x) = lnx;      g(x) = −x lnx;                                                        Широкоиспользуемые способы отделения корней  графический и таб-
                                            2
                                      1+x                                                    личный  базируются на свойствах гладкости функции; в случае, когда
1                                   1                                                        f(x) является алгебраическим полиномом степени n, имеются аналитиче-
 ивычислитьZ G(x)dx вявномвиде,адляZ g(x)dxпостроитьквадратуру.                                                ские подходы.
                                                                                                 Если f(x)  непрерывная, то вещественный корень z принадлежит лю-
          0                                   0                                                         бому отрезку, на концах которого функция имеет значения разных знаков.
                                                                  2
 Можновыделить особенность более точно, рассмотрев G(x) = (1−x )lnx.                                           Деля отрезок пополам, получаем универсальный метод вычисления корня
    3. Заменапеременных.Длярассматриваемойподынтегральнойфунк-
 ции f(x) особенность также можно устранить, сделав замену переменных                                          (методбисекции).Этотподходнетребуетзнанияхорошегоначальногопри-
 x=tk:                                                                                                         ближения. Если оно имеется, то для гладких функций используются более
       1                1                                                                    эффективные методы.
     Z    lnx dx =Z k2tk−1lntdt;            k > 2:                                               Пусть отыскивается единственный на отрезке [a;b] корень z уравнения
               2                 2k
         1+x                1+t                                                              f(x) = 0 в предположении непрерывности функции f(x). Если в его окрест-
     0                 0                                                                                                                                   p
    В этом случае, увеличивая степень k, можно повысить гладкость ин-                                          ностифункцияпредставляетсяввидеf(x)=(x−z) g(x),гдеpнатураль-
 тегрируемой функции, следовательно, степень квадратуры. Однако, при                                           ное число, а g(x)  такая ограниченная функция, что g(z) 6= 0, то число p
 увеличении k также растет норма производных полученной функции, что                                           называют кратностью корня. Если p = 1, то корень называют простым.
 приводит к ухудшению оценки погрешности (узлы при этом сгущаются к                                            При нечетном p функция f(x) меняет знак на [a;b], т.е. f(a)f(b) < 0, а при
 нулевой точке).                                                                                               четном p  нет.
    В некоторых случаях приходится совмещать несколько приемов. По-                                                Итерационный метод решения порождает последовательность прибли-
                                                                                             женийx ,котораясходитсяккорню: lim |x −z|= 0.Величинуe = |x −z|
 строим квадратурную формулу для вычисления интеграла                                                                    n                                  n→∞ n                            n      n
 ∞
 Z        x α                                              (k)                                                 называютабсолютной ошибкой наn-йитерации.Итерационныйметодиме-
    f(x)e x sin(ωx)dx; где α ∈ (−1;1); ω ≫ 1, |f              (x)| ≤ A , k = 0;1;2; :::.                       етпорядок m(илискорость сходимостиm),еслиmнаибольшееположи-
                                                     k
 0                                                                                                             тельное число, для которого существует такая конечная постоянная q > 0,
 Разобьемотрезокинтегрированияна подотрезки [0;ε], [ε;A], [A;∞[, где ε ≈                                       что                                      e
                                                                   α                                                        lim sup n+1 ≤ q < ∞:
 1=ω, A ≫ 1. На первом отрезке в качестве весовой можно взять x , на                                                                          n→∞        em
 втором  функцию sinωx. На третьем отрезке можно, например, сделать                                                                                      n
 замену переменных типа x = A=t и перейти к интегрированию функции                                             Постояннуюq называютконстантой асимптотическойошибки,еёобычно
 с особенностью на конечном отрезке. Либо за счет выбора A обеспечить                                          оценивают через производные функции f(x) в точке x = z. При m = 1(q ∈
          ∞                                                                                  (0;1)) сходимость называется линейной (иногда говорят, что в этом слу-
 выполнение условия |Z g(x)dx| ≤ δ с требуемой точностью δ и пренебречь                                        чае метод сходится со скоростью геометрической прогрессии, знаменатель
                                                                                             которой q), при 1 < m < 2  сверхлинейной, при m = 2  квадратич-
         A
 значением данного интеграла.                                                                                  ной и т.д. Из сходимости с порядком m > 1 следует оценка e                        ≤ q e ,
                                                                                                                                                                          n+1      n n
                                                                                                                                        148
         Раздел 6.                                                         149              150                  Лекция 26. Методы решения нелинейных уравнений
                  n                                                                                                       n
                 Y                                                Доказательство. Покажем,что последовательностьx = ϕ (x ) явля-
         q →0приn→∞.Приэтомe              ≤e     q . Иногда скорость сходимости                                                                   n       0
          n                           n+1    0    i                                         ется фундаментальной. Действительно,
                 i=0
         может замедляться при приближении к искомому решению, что соответ-                       n      n+m         n      m
                                                                  ρ(ϕ (x );ϕ    (x )) ≤ q ρ(x ;ϕ (x )) ≤
         ствует q → 1, но e → 0 при n → ∞. Таким свойством обладают методы                           0         0         0      0
     n          n                                                                                                                             m
                                                                  (с учетом неравенства треугольников для точек x ;ϕ(x );:::;ϕ (x ))
                                p                                                                               0    0          0

         с полиномиальной скоростью сходимости en+1 ≤ (1−αen)en с некоторыми                      n                       2             m−1      m
    p                                                                        ≤q ρ(x ;ϕ(x ))+ρ ϕ(x );ϕ (x ) +:::+ρ ϕ          (x );ϕ (x )  ≤
         p ≥ 1 и 0 < αe0 < 1.                                                                          0    0          0      0                 0       0
 Особое внимание в теории решения нелинейных уравнений уделяется                       n                        m−1    n             1
                                                                  ≤q ρ(x ;ϕ(x )) 1+q+:::+q          ≤q ρ(x ;ϕ(x ))      :
                                                                         0    0                            0    0  1−q
         методам со сверхлинейной скоростью сходимости. При практических рас-
         четах традиционно применяют методы с квадратичной сходимостью, так                                                                  n      n+m
                                                               Если взять достаточно большое n, то величина ρ(ϕ (x );ϕ    (x )) будет
         как итерационные процессы более высокого порядка (m > 2) обычно тре-                                                                   0        0
         буют серьезного увеличения вычислительных затрат.                                  сколь угодно малой независимо от m. Это означает фундаментальность по-
                                                               следовательности x и существование предела z. При этом из непрерывно-
 Отметим,чтопринахождениикратныхкорней(p>1)длябольшинства                                          n
                                                               сти ϕ имеем:
         алгоритмов характерно замедление скорости сходимости.
 Метод простой итерации. Исходное уравнение f(x) = 0 заменяют                                z = lim x = lim ϕ(x     ) = ϕ( lim x  ) = ϕ(z):
                                                                               n→∞ n    n→∞     n−1     n→∞ n−1
         эквивалентным ему уравнением
                                                               Если z1;z2  две неподвижные точки, то
          x=ϕ(x):                                                 ρ(z1;z2) = ρ(ϕ(z1);ϕ(z2)) ≤ qρ(z1;z2) ⇒ ρ(z1;z2) = 0:
                                                               Теорема доказана.
         Эту замену можно сделать положив, например,                                           Внекоторыхслучаях скорость сходимости может замедляться при при-
                                                               ближении к корню, например:
     ϕ(x) = x+ψ(x)f(x);                                                  ρ(ϕ(x );ϕ(x )) ≤ ρ(x ;x )(1−αρp(x ;x )) ≤
                                                                              1     2       1  2           1  2
                                                                              ρ(x ;x )           ρ(x ;x )
                                                                         ≤       1  2     ≤          1 2      ; α > 0; p ≥ 1:
         где ψ(x)  произвольная непрерывная знакопостоянная функция.                                   (1 +αρp(x ;x )          p        1=p
                                                                                     1  2   (1 +αρ (x ;x ))
 Выберем некоторое начальное приближение x ∈ [a;b] к корню z, даль-                                                     1  2
                         0
         нейшие приближения будем вычислять по формуле                                      Определение 26.2 Отображение y = ϕ(x) метрического пространства
                                                               H называется слабо (полиномиально) сжимающим , если ϕ(H) ⊂ H, и
x    =ϕ(x );   n=0;1;2; ::: :                                  при некоторых α > 0;p ≥ 1 выполнено условие
 n+1      n
                                                                                                   ρ(x ;x )
                                                                             ρ(ϕ(x );ϕ(x )) ≤         1  2        ∀x :
         Определение 26.1 Отображение y = ϕ(x) метрического пространства                                        1    2           p        1=p    1;2
                                                                                              (1 +αρ (x ;x ))
         Hназываетсясжимающим(экспоненциально),еслиϕ(H)⊂H ипринеко-                                                                 1  2
         тором 0 < q < 1 выполнено условие                                                  Теорема 26.2 Пусть отображение y = ϕ(x) является слабо (полиноми-
                                                               ально) сжимающим на полном метрическом пространстве H. Тогда су-
         ρ(ϕ(x );ϕ(x )) ≤ qρ(x ;x )  ∀x :                                 ществует единственная точка z такая, что z = ϕ(z). При этом для про-
   1     2         1  2     1;2
                                                                                                n                        p      −1=p
                                                               извольной x ∈ H верна оценка: ρ(ϕ (x );z) ≤ ρ(x ;z)(1+αnρ (x ;z))    .
                                                                          0                        0          0             0
         Здесь ρ(x ;x )  расстояние между точками x и x .
1  2                                1    2                                   Доказательстводанного утверждения аналогично доказательствуприн-
         Теорема 26.1 Пусть отображение y = ϕ(x) является сжимающим на                      ципа сжимающих отображений.Явно проверяется, что для полиномиально
         полном метрическом пространстве H. Тогда существует единственная                   сжимающих отображений имеет место оценка:
         точка z такая, что z = ϕ(z). При этом для произвольной x ∈ H верна                                                         ρ(x ;x )
                                      0                                           n      n                1  2
  n          n                                                                            ρ(ϕ (x );ϕ (x )) ≤                   :
         оценка: ρ(ϕ (x );z) ≤ q ρ(x ;z).                                                                         1      2            p       1=p
     0           0                                                                                           (1 +nαρ (x ;x ))
                                                                                                            1  2
         Раздел 6.                                                        151               152                  Лекция 26. Методы решения нелинейных уравнений
                                n
         Отсюда следует, что произвольная последовательность ϕ (x ) для x ∈ H                  Доказательство. Сходимость метода в окрестности x ∈ Q корня z
                                   0       0                                                                         n     δ
                              n+m       n
         является фундаментальной. Действительно, имеем ρ(ϕ    (x );ϕ (x )) ≤               следует из теоремы. Оценим скорость сходимости:
                                    0      0
    m                        m
                                                                        x    −z=ϕ(x )−ϕ(z)=ϕ z+(x −z) −ϕ(z)=
 ρ(ϕ (x );x )            ρ(ϕ (x );x )          1                                     n+1         n                  n
        0   0      ≤            0   0     ≤         ≤ε
   p   m        1=p       p  m         1=p       1=p                                                        1
   (1 +nαρ (ϕ (x );x ))      (nαρ (ϕ (x );x ))      (nα)
          0   0                  0  0                                                                  ′             2  ′′
                                                                          =ϕ(z)+(x −z)ϕ(z)+ (x −z) ϕ (ξ )−ϕ(z)=
                                                                                     n           2   n         n
                                                                              ′′
         с произвольно малым ε и всех m, если n достаточно велико.                                        ϕ (ξ )
                                                                                 n        2
                                                                          =        (x −z) ; ξ ∈[x ; z]:
 Изфундаментальностипоследовательностиследует,чтосуществуетпре-                                  2     n        n    n
   n
         дельная точка z = lim ϕ (x ). Аналогично случаю экспоненциально сжи-
        n→∞      0                                                        Теорема 26.4 Пусть на некотором отрезке Q = [a − δ;a+δ] функция
         мающего отображения доказывается, что точка z является единственной                                                             δ
                                                               ϕ(x) удовлетворяет условию Липшица |ϕ(x ) −ϕ(x )| ≤ q|x −x | с кон-
         неподвижной точкой отображения ϕ: ϕ(z) = ϕ( lim x ) = lim x     = z,                                                        1      2       1    2
                        n→∞ n      n→∞ n+1                     стантой q < 1, и в точке a выполняется неравенство
         при этом каждая точка x притягивается к ней с полиномиальной скоро-
    0
         стью. Теорема доказана.                                                                                     |a −ϕ(a)| ≤ (1 −q)δ:
 Для методов с полиномиальной скоростью сходимости число итераций
         n, необходимое для достижения ошибки порядка ε, имеет асимптотику n ≈              Тогда на отрезке Qδ уравнение f(x) ≡ x−ϕ(x) = 0 имеет единственный
          −p                                                                                корень z, и последовательность x   = ϕ(x    ) сходится к корню z для
         ε  , что существенно ограничивает их применение для расчетов с высокой             произвольного x ∈ Q .            n      n−1
         точностью.                                                                                        0    δ
 Отметим, что в случае H = R1 гарантировать сходимость метода мож-
                                                                  Доказательство. Пусть x ∈Q , т.е. |a−x | ≤ δ. Тогда
         но при условии, что соответствующие оценки сжимаемости выполняются                                             0    δ         0
         либо для всех точек x   ∈ R1, либо для точек x    ∈ [a;b], но дополни-
 1;2                       1;2                                           |ϕ(x )−a| = |ϕ(x )−ϕ(a)+ϕ(a)−a|≤
                                            n                                0           0
         тельно требуется ϕ(x ) ∈ [a;b] для ∀x ∈ [a;b], т.е. все приближения ϕ (x )
          0              0                                0                         ≤|ϕ(x )−ϕ(a)|+|ϕ(a)−a|≤q|x −a|+(1−q)δ ≤δ:
         принадлежат отрезку [a;b].                                                                         0                       0
                                                               Такимобразом,функцияϕ(x)отображаетQδ всебяиявляетсясжимающей
         Теорема 26.3 Пусть уравнение f(x) ≡ x − ϕ(x) = 0 имеет корень z, и                 с константой q. Применение принципа сжимающих отображений завершает
         для его вычисления применяется метод простой итерации x      =ϕ(x ).               решение.
                                     n+1      n
   1                               ′

         Пусть функция ϕ(x) ∈ C в открытой окрестности z, и ϕ (z) ≤ q < 1.                  Теорема 26.5 Пусть функция f′(y) непрерывна и |f(x )=f′(y)| ≤ ε для
         Тогда найдется такая окрестность Qδ = [z−δ;z+δ], что для произволь-                                                                    n
                                                               всех y ∈ [x −ε;x +ε]. Тогда для некоторого z ∈ [x −ε;x +ε] справедливо
         ного x ∈ Q метод сходится к z с линейной скоростью.                                          n     n                              n     n
   0    δ                                                                        равенство f(z) = 0:
           ′                   ′
 Доказательство. Функция ϕ (x) непрерывна и |ϕ (z)| < 1, следова-                   Доказательство.ПотеоремеЛагранжаимеемf(x +t)=f(x )+f′(y)t;
′                                                                                                                           n        n
         тельно, |ϕ (x)| ≤ q˜< 1 в некоторой окрестности Qδ. Возьмем произвольную           отсюдаследует f(x +t)=f′(y) = f(x )=f′(y)+t: Выражение в правой части
                                   ′                                            n               n
         точку x ∈ Q . По теореме Лагранжа имеем ϕ(x ) = ϕ(z)+ϕ (ξ)(x −z), где
     0    δ                              0                0                      равенства неотрицательно при t = ε и неположительно при t = −ε. Из
                          ′
         точка ξ ∈ Q . Так как z = ϕ(z), то |ϕ(x )−z| = |ϕ (ξ)(x −z)| ≤ q˜|x −z| <
  δ                       0               0         0                     условия следует, что производная функции не меняет знак при t ∈ [−ε;ε],
         |x −z|, т.е. ϕ отображает отрезок Q в себя и является сжимающим. Тео-
0                               δ                                                поэтому если оба значения f(x − ε) и f(x + ε) отличны от нуля, то они
         рема доказана.                                                                                                  n          n
                                                               имеют разные знаки. Теорема доказана.
                                                                  Замечание. Таким образом в качестве критерия остановки итерацион-
                         ′                 2
         Следствие 26.1 Пусть в условиях теоремы ϕ(z) = 0, ϕ(x) ∈ C . То-                   ного метода для нахождения простых корней уравнения f(x) = 0 условие
         гда для метода x    =ϕ(x ) в окрестности корня z верна квадратичная                |f(x )=f′(x )| ≤ ε предпочтительнее, чем условие |f(x )| ≤ ε:
       n+1      n                                                             n     n                                       n
         оценка сходимости                                                                  Пример26.1. Пустьуравнение f(x)=0 имеет корень на интервале (a;b),
                       2                                                                         ′
   |z −x    | ≤ C(z −x ) :                                     причем f(x) дифференцируема, а f (x) знакопостоянна на этом отрезке.
        n+1           n
 Раздел 6.                                                                               153                     154                         Лекция 26. Методы решения нелинейных уравнений
 Построим равносильное уравнение вида x = ϕ(x), для которого на [a;b]                                                Доказательство. Представим метод хорд как частный случай метода
        ′

 выполнено условие ϕ (x) ≤ q < 1:                      ′                              ′                          простой итерации:
     Дляопределенностибудемсчитать,чтоf (x) > 0.Пусть0 < m ≤ f (x) ≤                                                                                                  f(x)
 M: Заменим исходное уравнение f(x) = 0 равносильным                                                                                x=ϕ(x); ϕ(x)=x−                              (x−x ):
                                                                                                                                               f(x)−f(x )             0
      x=ϕ(x); ϕ(x)=x−λf(x); λ>0:                                                                                                                            0
 Подберем параметр λ так, чтобы на [a;b] выполнялось неравенство                                                 Тогда
                                                                                                                   (f′(x)(x −x )+f(x))(f(x)−f(x ))+f(x)(x−x )f′(x)
                 ′               ′                                                                   ′                           0                         0                  0
          0 ≤ ϕ (x) = 1−λf (x) ≤ q < 1:                                                             ϕ (x) = 1−                                              2                         ;
                                                                                                                                           (f(x) −f(x ))
      1                         m                                                                                                                                   0
 При λ = M получаем q = 1− M <1:                                                                                                                ′            f′(z)
                                                                                                                            ϕ(z)=1+               (z −x ) =
     Методхорд.Пустьf(a)f(b)<0.Идеяметода(егоещеназываютмето-                                                                                                f(x )         0
 дом ложного положения) состоит в замене кривой y = f(x) хордами, про-                                                                                           0
 ходящими через концы отрезков, в которых f(x) имеет противоположные                                                                      ′                f′′(η)          2     ′
                                                                                                              f(z)+f (z)(x −z)+                 (x −z) +f (z)(z−x )
 знаки. Метод хорд требует, чтобы один конец отрезка, на котором ищет-                                                                          0             2     0                        0
                                                                                                           =                      f(z)+f′(ξ)(x −z)                            =
 ся корень, был неподвижен. В качестве неподвижного конца x выбирают                                                                                                0
                                                             0
 конец отрезка, для которого знак f(x) совпадает со знаком второй произ-                                                                 2       ′′                       ′′
                                                                                                             (x −z)          f (η)                     f (η)
 водной f′′(x). Расчетная формула имеет вид                                                                                 = 0                            =(x −z)              ;   η;ξ ∈ [x ;z]:
                                                                                                                  2      f′(ξ)(x −z)           0       2f′(ξ)              0
                                                                                                                                 0
                             x −x
         x      =x −          n      0    f(x )                                                Для простого корня имеем f′(z) 6= 0, поэтому начальное приближение x
           n+1      n                         n                                                                                                                                           0
                         f(x )−f(x )
                             n         0                                                                                                                 ′

 и может быть получена из уравнения прямой y = (f(x ) − f(x ))=(x −                                              можновзятьвтакойокрестностикорня,что ϕ (z) ≤ q < 1.Согласнодока-
                                                     n          0      n                       занным ранее результатам отсюда следует, что метод хорд имеет линейную
 x )(x − x ) + f(x ), имеющей нужный угол наклона и проходящей через                                             скорость сходимости для произвольных x ;x из некоторой подокрестности
  0         n          n                                                                                                                                            0   1
 точку (x ;f(x )).                                                                                               Q (z).
    n      n                                                                                                δ
     Методсекущих.Пустьx                   иx последовательныеприближенияк
                    n−1     n                                                                  Утверждение 26.1 Пустьf(x)∈C3,z простойкорень. Тогда найдет-
 корню. Заменим функцию y = f(x) на линейную, проходящую через точки
                                                                                           ся такая окрестность Q (z), что для произвольных x ;x ∈ Q (z) метод
  x     ; f(x    ) и x ;f(x ) .Вкачествеследующегоприближенияккорню                                                                              δ                                    0  1      δ
   n−1       n−1         n      n                                                                                секущих сходится и верна оценка
 возьмемточкупересеченияэтойпрямойсосьюабсцисс.Расчетнаяформула
 принимает вид                                                                                                                                   |x     −z|≤A|x −z|m,
                                                                                                                √                n+1              n

                           x −x                                                                                                              ′′     1=m
       x      =x −          n      n−1     f(x ):                                                         (1 +    5)                     1 f (z)
         n+1      n    f(x )−f(x          )     n                                              где m =                ≈1:618, A ∼                        ; т.е. сходится сверхлиней-
                           n         n−1                                                       но.             2                         2 f′(z)
     Метод парабол. Пусть x               ; x     и x  три последовательных при-
                    n−2    n−1      n
 ближенияккорню.Заменимкривуюy =f(x)параболой,проходящейчерез
                                                                                             Метод Ньютона. В случае одномерного уравнения формула метода
 точки x        ; f(x    ) ;  x     ; f(x     )  и x ;f(x ) . В качестве следующе-
     n−2      n−2        n−1       n−1         n      n                                                   Ньютона имеет вид
 го приближения к корню возьмем ближайшую к x точку пересечения этой
                                            n                                                                                                    f(x )
 параболы с осью абсцисс. Этот подход исключительно эффективен для на-                                                                             x      =x −          n :
                                                                                                                                   n+1      n    f′(x )
 хождениякорнеймногочленакаксдействительными,такискомплексными                                                                                                          n
 коэффициентами.                                                                                                 Вданномслучаенакаждомшагедугакривойy =f(x)заменяетсянакаса-
                                                                                                                                                                          ′
                                                                                               тельную к ней, проведенную в точке x ;f(x ) : y−f(x ) = f (x )(x−x ):
 Теорема 26.6 Пусть f(x) ∈ C2, z  простой корень. Тогда найдется та-                                                                                            n      n             n          n        n
 кая окрестность Q (z), что для произвольных x ;x ∈ Q (z) метод хорд                                             Отсюда находим формулу итерационного процесса, положив y = 0 и x =
       δ                                    0   1      δ                                                                                                                     x     −x
                                                                                               x     . Метод Ньютона соответствует методу простой итерации n+1                         n +
 сходится с линейной скоростью.                                                                                    n+1                                                                              τ
Раздел 6.                                                                                                                                     155                                   156                                           Лекция 27. Решение систем нелинейных уравнений
                                                                                                                                                                                                                                                                      p
f(x ) = 0 с оптимальным в некотором смысле параметром τ. Действитель-                                                                                                                     Представим f(x) в виде f(x) = g(x)(x − z) , где g(z) = a 6= 0. Тогда,
       n
                                                                                                                                                                                               ′              ′′                                                                     ′
но, пусть z  изолированный простой корень и все x ∈ [a;b]. Тогда                                                                                                                   вычисляя f (x) и f (x), получаем представление для ϕ (x) в малой окрест-
                                                                                              n
                                                                                                                                                                         ности корня
                                            z = z −τf(z);                                                                                                                                                       ′′                             p                                p−2
                                            x         =x −τf(x );                                                                                                                                   f(x)f (x)                 a(x−z) ap(p−1)(x−z)
                                              n+1            n                n                                                                                                        ′
                                                                                                                                                                                    ϕ(x) =  ′                    2     =                    2 2                 2p−2                  +O(|x−z|):
следовательно, для некоторого ξ имеем                                                                                                                                                                              f (x)                              a p (x−z)
                                 z −x             =(1−τf′(ξ))(z −x ):                                                                                                                                                ′             p−1
                                           n+1                                           n                                                                               Отсюда следует, что ϕ (z) ≈                                   p       <1, и чем выше кратность корня, тем
Если τ = 1=f′(ξ), то z −x                                  =0, т.е. метод сойдется за один шаг. Но ξ не                                                                             медленнее сходимость. Теорема доказана.
                                        n+1
известно, поэтому выбираем τ = 1=f′(x ).                                                                                                                                            Пример 26.2. Пусть уравнение f(x) = 0 имеет на отрезке [a;b] корень z
                                                                   n                                                                                                                                                                3
                                                    3                                                                                                                    кратности p, причем f(x) ∈ C . Построим модификацию метода Ньютона,
Теорема 26.7 Пусть f(x) ∈ C , z  простой корень. Тогда найдется та-                                                                                                                имеющую квадратичную скорость сходимости. Требуемую модификацию
кая окрестность Q (z), что для произвольного x ∈ Q (z) метод Ньютона                                                                                                                будем искать в виде
                            δ                                                         0         δ
                                                                                                                                                                                                                                                           f(x )
сходится и верна оценка                                                                                                                                                                                                                  x         =x −α                     n
                                                                                   2                                                                                                                                            n+1            n           f′(x )
                                        |x          −z|≤C|x −z| ,                                                                                                                                                                                                 n
                                            n+1                         n
т.е. сходится квадратично.                                                                                                                                                                                                                                   ′                                                              ′
                                                                                                                                                                         и подберем параметр α так, чтобы ϕ (z) = 0. Вблизи корня имеем ϕ (x) =
       Доказательство. Рассмотрим метод Ньютона как частный случай ме-                                                                                                              1−α+αf(x)f′′(x) =1−α+αp−1+O(|x−z|)= p−α+O(|x−z|):Отсюда
                                                                                                                                                                                            ′         2                               p                                     p
тода простой итерации, для которого                                                                                                                                                                     f (x)
                                                                                                                                                                         находим α = p.
                         ′        2                  ′′                        ′′
   ′                      f (x)         −f(x)f (x)                    f(x)f (x)                                ′
ϕ(x) = 1−                            ′        2                =  ′             2 ;         т.е.        ϕ(z)=0:
                                      f (x)                               f (x)                                                                                             Лекция 27. Решение систем нелинейных урав-
Согласно доказанным ранее результатамотсюда следует, что метод Ньюто-                                                                                                                        нений
на в некоторой подокрестности Qδ(z) имеет квадратичную скорость сходи-
мости.                                                                                                                                                                              Будем считать, что исходная система имеет вид:
Теорема 26.8 Пусть f(x) ∈ C2, z  корень кратности p. Тогда найдется                                                                                                                                             1      2          m
                                                                                                                                                                                               f (x ;x ;:::;x ) = 0;
                                                                                                                                                                                          1
                                                                                                                                                                                         
такая окрестность Q (z), что для произвольного x ∈ Q (z) метод Нью-                                                                                                                                              1      2          m
                                  δ                                                          0          δ                                                                                      f2(x ;x ;:::;x ) = 0;
                                                                                                                                                                                                                                                                                       1           m T
тона сходится и верна оценка                                                                                                                                                                              : : :     : : :     : : :     : : :               ⇔F(x)=0; x=(x ;:::;x ) :
                                                                                                                                                                                         
                                                                                                                                                                                         
                            |x         −z|≤q|x −z|;q≈(p−1)=p,                                                                                                                                           1     2           m
                                n+1                        n                                                                                                                                   fm(x ;x ;:::;x ) = 0;
т.е. сходится линейно.
                                                                                                                                                                               Для решения задачи можно попытаться построить некоторое сжима-
       Доказательство. Поступая так же, как и в случае простого корня,                                                                                                              ющее отображение G(x) и применить метод простой итерации x                                                                                      =
                                                         1                                                                                                                                                                                                                                                      n+1
                                              ′                           2     ′′                                                                                       G(x ). В многомерном случае также возможна следующая модификация
получимx                    −z=(x −z)ϕ(z)+ (x −z) ϕ (ξ),гдеξ ∈[x ; z]:Однако,в                                                                                                              n
          n+1                   n                        2      n                                           n                                                            метода:
                                            ′            f(x)f′′(x)                                                                                                                                               1                          1     2           m
                                                                                                                                                                                                                       x         =g (x ;x ;:::;x );
случае p > 1 в выражении ϕ (x) =                                                        содержитсянеопределенность                                                                                                         n+1                  1     n     n           n
                                                                         2                                                                                                                                       
                                                             f′(x)                                                                                                                                                2                          1          2           m
                                                                                                                                                                                                                       x         =g2(x              ; x ;:::;x );
                                                                                                                       ′                                                                                                 n+1                  n+1        n           n
“ноль на ноль”, так как z является также корнем уравнения f (x) = 0.                                                                                                                                                              : : :     : : :     : : :     : : :     : : :
                                                                                                                                                                                                                 
                                                                                                                                                                                                                 
         ′                                                                                                                                                                                                        m                           1               m−1 m
Оценим ϕ (x).                                                                                                                                                                                                                     x         =gm(x                ; :::; x         ; x     ):
                                                                                                                                                                                                                         n+1                   n+1             n+1         n
    Раздел 6.                                                                                                          157                            158                                   Лекция 27. Решение систем нелинейных уравнений
    Если из функции F удается выделить главную линейную часть, т.е. полу-                                                                                  РассмотримслучайсистемыmнелинейныхуравненийF(x)=0;гдеx=
                                                                                                                                       1           m T                                   T
    чить представление F(x) = Bx+H(x), то можно использовать либо метод                                                                               (x ;:::;x ) ;             F = (f1;:::;fm) . Будем предполагать, что отображение
    Пикара Bx               +H(x )=0, либо его модификацию                                                                                            F : Rm → Rm непрерывно дифференцируемым в некоторой окрестности
    n+1             n
                                                                                                                                                                     ′         h∂f i
                                                                                                                                    решенияz,такчтоF(x)=                             i   : В предположенииобратимостиэтогоопе-
                             x        −x                                                                                                                                          ∂xj
                          B n+1            n +F(x )=0:
                                                        n                                                                                                                                                                            ′        −1
                                                                                                                                    ратораметодНьютонаможнозаписатьввидеx                                             =x −(F(x ))                 F(x ):
                                    τ                                                                                                                                                                           n+1         n            n              n
    Посути это соответствует некоторому обобщению метода Ньютона.                                                                                     Теорема 27.1 (О сходимости метода Ньютона). Обозначим Ωa = {x :
  ОбобщениемметодаГаусса–ЗейделяиметодаЯкобинанелинейныйслу-                                                                                   kx−zk<a}, где k·k  норма в Rm. Пусть при некоторых a;a1;a2 : 0 <
    чай являются методы покоординатного спуска, для которых компоненты                                                                                a; 0 ≤ a1;a2 < ∞, выполнены условия:
    очередного приближения x                           соответственно определяются при решении
                              n+1
    одномерных нелинейных уравнений одной из следующих систем:                                                                                                            ′      −1
                                                                                                                                              1) k(F (x))          yk ≤ a1kyk           при        x∈Ωa; ∀y;
                                                                                                                                                        ˜                     ′      ˜                    ˜         2              ˜
                1        2         m                                  1        2         m                                                             2) kF(x)−F(x)−F(x)(x−x)k≤a2kx−xk                                             при x;x∈Ωa:
          f (x        ; x ;:::;x ) = 0;                           f (x        ; x ;:::;x ) = 0;
      1 n+1 n                      n                         1 n+1 n                     n
                                                            
                1        2            m                               1     2            m                                                                                                                     −1
          f2(x        ; x      ; :::; x   ) = 0;                  f2(x ;x          ; :::; x   ) = 0;                                           Обозначим также c=a a ; b =min{a;c }.
      n+1      n+1          n                                n     n+1          n                                                                                           1 2
          : : :   : : :   : : :    : : :   : : :                  : : :   : : :   : : :   : : :   : : :
                                                                                                                                                  При условиях 1); 2) и x ∈ Ω итерационный процесс Ньютона сходит-
                                                                                                                                                                                        0       b
                 1        2            m                               1         m−1 m
          fm(x         ; x      ; :::; x      ) = 0;              fm(x ;:::;x            ; x      ) = 0:                                       ся с оценкой погрешности
       n+1      n+1          n+1                              n         n         n+1
                                                                                                                                                                                                                    n
  Нахождение корней системы уравнений бывает удобно свести к нахож-                                                                                                                                     −1                   2
                                                                                                                                                                         kx −zk≤c (ckx −zk) ;
    дению минимума некоторого функционала Φ(x), например, для Φ(x) =                                                                                                                           n                          0
    kF(x)k2. Напомним, что подобным образом строились методы решения ли-                                                                              т. е. имеет квадратичную скорость сходимости.
    нейныхсистем.ДлярешениязадачиминимизацииΦ(x)можнорассмотреть
    следующий нестационарный процесс, называемый методом установления:                                                                                     Доказательство.Пустьx ∈Ω .Докажемпоиндукции,чтоx                                                           ∈Ω.
                                                                                                                                                                                    n        b                                                n+1         b
                                                                                                                                    Так как b ≤ a, следовательно, точки z;x ∈ Ω и по условию 2) имеем
                                                                                                                                                                                                     n        a
                           d
                          dtx(t)+gradΦ x(t) =0:                                                                                                                                         ′                                           2
                                                                                                                                                          kF(z)−F(x )−F (x )(z−x )k≤a kz−x k :
                                                                                                                                                                              n             n            n           2          n
    Так как при gradΦ(x) 6= 0 имеем                                                                                                                   Далее F(z) = 0, а из расчетных формул находим
          d                                    dx                                                                                                                               F(x ) = −F′(x )(x                    −x ):
         dtΦ(x(t)) = gradΦ(x); dt                      =− gradΦ(x);gradΦ(x) <0;                                                                                                           n                 n      n+1        n
    то для произвольного x(0) вдоль траектории x(t) значение Φ(x(t)) не воз-                                                                          Отсюда следует, что
    растает, поэтому x(t) сходится к некоторой точке x вида gradΦ(x) = 0.                                                                                                              kF′(x )(z−x                )k ≤ a kz−x k2:
  Другой возможный нестационарный процесс, решение которого в точке                                                                                                                      n            n+1            2          n
    локального минимума также устанавливается, имеет вид:                                                                                             Таким образом,
                     2
                   d x          dx                                                                                                                                                   ′        −1 ′
                          +γ         +gradΦ(x)=0; γ >0:                                                                                                  kx        −zk=k(F (x )) F (x )(x                             −z)k≤
                    dt2         dt                                                                                                                           n+1                         n               n     n+1
                                                                                                                                                                   ′        −1        ′
                                                                                                                                                         ≤k(F (x ))             kkF (x )(x             −z)k≤
                                                                                                                                                                       n                  n      n+1
                                                                                                                                                         ≤(a a )kx −zk2 =ckx −zk2 <cb2 =(cb)b ≤b:
    Можно проверить, что в данном случае вдоль траектории не возрастает                                                                                                           1 2       n                     n
    значение функционала 1 dx; dx+Φ(x). При численной реализации ме-                                                                                Вложениеx ∈Ω ,n≥0доказано.Докажемсходимость.Пустьq =ckx −
                        2     dt     dt                                                                                                                n        b                                                                           n           n
    тодов установления операторы производных заменяют соответствующими                                                                                zk, тогда kx               −zk ≤ q kx − zk: Умножим данное неравенство на c,
                                                                                                                                                         n+1                   n    n
    разностными аналогами.                                                                                                                            получим q              ≤q2.Покажемпоиндукции, чтоотсюдаследует оценка q ≤
                                                                                                                                                    n+1         n                                                                                      n
         Раздел 6.                                                             159               160                    Лекция 27. Решение систем нелинейных уравнений
          2n                                                          2     2n 2
         q  . Имеем: n = 0, q ≤ q ; пусть верно для n; тогда q    ≤q ≤(q ) =                     Пример 27.1. Запишем формулы метода Чебышёва для функции f(x) =
          0                  0    0                           n+1     n     0
          2n+1                                                                                     p                                                    1=p
         q     . Таким образом, верна следующая оценка скорости сходимости:                      x −a. Обратная к f функция имеет вид F(y) = (a+y)         , а производные
          0                                                                                                                     p
                           2n                                       F выражаются (с учетом y = x −a) формулой
    ckx −zk≤(ckx −zk) :
       n            0                                                                               k−1               k−1
                                                                                (k)            1=p−k Y 1          1−kp Y 1
         Итаккакckx −zk<cb≤1,следовательно,x →z. Теорема доказана.                                          F (y)=(a+y)             (p −j) = x          p −j :
     0                               n                                                                         j=0               j=0
 Условия теоремы гарантируют, что корень z простой. Напомним, что в
         случае кратных корней метод Ньютона сходится с линейной скоростью, и                    Таким образом,
         скорость замедляется при повышении кратности.                                                                        m−1            k−1
                                                                                                               p  k
 Построение итераций высшего порядка. Как отмечалось, особый                                          ϕ (x) =x+xX 1 a−x              Y(1−jp):
                                                                                     m                       p
         интерес представляют методы со сверхлинейной оценкой сходимости, т.к. в                                               k=1 k!   px      j=0
         этомслучаескоростьсходимостиувеличиваетсяприприближенииккорню.                                                                p
                                                                    Вчастности, ϕ (x) = (x=p)(p−1+a=x ).
 Интерполяционный метод. Пусть имеется набор x ;:::;x             из m                               2
                                    n     n−m+1                         При p = 2 получаем формулу Ньютона–Херона x        =ϕ (x ) для при-
         приближений к корню z одномерной функции f(x). Тогда в качестве оче-                                                                       n+1     2  n
         редногоприближенияцелесообразновыбратьнульинтерполяционногомно-                         ближенного вычисления квадратных корней.
                                                                                                   m−1
                                                                                                   P          k
         гочлена L (x), построенного по узлам x ;:::;x       . Это требует нахож-                    Если p = −1, то ϕ (x) = x     (1 − ax) . В этом случае итерационный
 m                             n     n−m+1                                                           m
         дения корней многочлена Lm. Как следствие широкое применение имеют                                                     k=0
                                                                    процесс x     = ϕ (x ) при |1 − ax| < 1 сходится к решению уравнения
         только алгоритмы при m = 2;3  метод секущих и метод парабол.                                     n+1     m n
 Чтобыизбежатьпроблем, связанных с решением алгебраического урав-                     x−1=a=0.Данныйметодпозволяетнаходитьзначение1=aспроизвольной
         нения L (x) = 0, естественно интерполировать обратную к y = f(x) функ-                  точностью без использования операции деления.
      m                                                                                   δ2-процесс Эйткена. Вычислим по имеющемуся приближению x зна-
         циюx=F(y)поузламy          =f(x     ), i = 0;:::;m−1, и в качестве очередно-                                                                               n
    n−i      n−i                                                    чения x      = ϕ(x ) и x      = ϕ(x    ). Так как в малой окрестности z
         го приближения взять значение полученного интерполяционного многочле-                           n+1        n     n+2        n+1
         на в нуле. Линейная обратная интерполяция (m = 2) соответствует методу                  имеются представления
                                                                                                        ′
         секущих, но уже при m = 3 прямая и обратная интерполяция приводят к                                             x    −z≈ϕ(z)(x −z);
                                                                                             n+1             n
                                                                                                        ′
         различным алгоритмам.                                                                                           x    −z≈ϕ(z)(x       −z);
                                                                                             n+2             n+1
 Метод Чебышёва. Пусть z  корень уравнения f(x) = 0 и F(y)                                                                       x    −x
                                                                                                          ′       n+2    n+1
         обратная к f(x) функция. Тогда x ≡ F(f(x)) и z = F(0). Разложим F(0) в                  то из данных соотношений получаем ϕ (z) ≈ x        −x ,
         ряд Тейлора в окрестности некоторой точки y:                                                                                           n+1    n
                                                                                                ′                       2
                                                                                        x    −ϕ(z)x          x    x −x
                                                                                         n+2         n+1      n+2 n     n+1
            m−1             k                                                       z ≈                  ≈                   :
             X         (−y)                                                                      ′
                  (k)                                                                       1−ϕ(z)         x    −2x     +x
         F(0) = F(y)+      F (y)        +::: :                                                                          n+2     n+1    n
            k=1          k!                                         Таким образом, за следующее после x приближение правильно принять
                                                                                                         n
                                                                                              x ϕ(ϕ(x ))−ϕ(x )ϕ(x )
         Приблизим значение F(0) значением частичной суммы в точке y = f(x):                                       x    = n        n        n    n =
                                                                                        n+1    ϕ(ϕ(x ))−2ϕ(x )+x
                                                                                                    n         n     n
               m−1                      k                                                             (ϕ(ϕ(x ))−ϕ(x ))2
               X k (k)            (f(x))                                              =ϕ(ϕ(x ))−            n        n    :
   z = F(0) ≈ ϕ (x) = x+      (−1) F   (f(x))       ;                                                    n
    m                                                                                               ϕ(ϕ(x ))−2ϕ(x )+x
                                     k!                                                                  n         n     n
               k=1
                                                                    Известно, что если исходный процесс имел линейную скорость сходимости,
         что соответствует замене исходной функции F(y) на многочлен ϕ (y) сте-                  то данная модификация имеет скорость сходимости более высокого поряд-
                                            m
         пени m − 1, производные которого совпадают с соответствующими про-                      ка, но, возможно, только сверхлинейную. Применение рассмотренной моди-
         изводными F в точке y = f(x). Соответствующий итерационный процесс                      фикации, например, к квадратично сходящейся последовательности фор-
         x    =ϕ (x ) имеет порядок сходимости m.                                                мально не приводит к повышению порядка.
n+1    m n
        Раздел 6.                                                      161
Данное преобразование является частным случаем (при ϕ = ϕ = ϕ)               Литература
                                  1    2
        метода Стеффенсона–Хаусхолдера–Островского построения итерационной
        функции ϕ более высокого порядка по известным ϕ и ϕ :
3                                    1   2                              1. Бахвалов Н.С., Жидков Н.П., Кобельков Г.М. Численные методы.
     xϕ (ϕ (x))−ϕ (x)ϕ (x)                                 М.: БИНОМ. Лаборатория знаний, 2011.
      ϕ (x) =     1  2       1    2     :
       3     x−ϕ (x)−ϕ (x)+ϕ (ϕ (x))                                    2. Бахвалов Н.С., Корнев А.А., Чижонков Е.В. Численные методы. Ре-
       1      2      1  2
                                                           шения задач и упражнения.  М.: Лаборатория знаний, 2016.
        Вданном случае функции ϕ и ϕ выбираются так, чтобы обеспечить эф-
    1    2                                                   3. Деммель Дж. Вычислительная линейная алгебра.  М.: Мир, 2001.
        фективное подавление вектора ошибки z −x .
                  n                                          4. Лебедев В.И.Функциональныйанализивычислительнаяматематика.
                                                           М.: Физматлит, 2005.
                                                                                          162
         Раздел 6.                                                       163              164                   Лекция 27. Решение систем нелинейных уравнений
     Программа курса.                                        18. Обыкновенные дифференциальные уравнения второго порядка, аппрок-
                                                             симация, α-устойчивость. Аппроксимация краевых условий третьего ро-
        Вычислительная погрешность.                                     да.
         1. Вычислительная погрешность. Устойчивость задачи и численного ал-              19. Устойчивость краевой задачи для уравнения второго порядка: метод
         горитма.                                                                         собственных функций.
 Разностные уравнения.                                       20. Устойчивость краевой задачи для уравнения второго порядка: энерге-
                                                             тический метод.
         2. Линейные разностные уравнения n-го порядка. Теоремы о представле-             21. Метод прогонки.
         нии общего решения однородного уравнения и общего решения неоднородно-           22. Метод стрельбы и метод Фурье.
         го уравнения.                                                                                  Численные методы линейной алгебры.
         3. Линейные разностные уравнения n-го порядка с постоянными коэффи-
         циентами. Формулировка теорем о представлении общего решения одно-               23. Нормы векторов, линейных операторов, обусловленность матрицы.
         родного уравнения и частного решения неоднородного уравнения с квазим-           Оценка возмущения решения системы линейных алгебраических уравне-
         ногочленом в правой части. Форма записи действительного решения.                 ний при возмущении правой части.
         4. Фундаментальное решение разностного уравнения. Теорема о представ-            24. Метод Гаусса решения систем линейных алгебраических уравнений.
         лениичастногорешениянеоднородного уравнения первого порядка с посто-             Алгоритм ортогонализации Грама–Шмидта.
         янными коэффициентами.                                                           25. Метод отражений.
         5. Решение задач на собственные значения для разностных уравнений,               26. Невырожденная задача наименьших квадратов: метод нормального
         сравнение с дифференциальным случаем.                                            уравнения, метод QR-разложения.
         6. Построение многочленов Чебышёва первого и второго рода.                       27. Задача наименьшихквадратовнеполногоранга:методыQR-разложения
                                                             и QR-разложения с выбором главного столбца
         7. Свойства многочленов Чебышёва первого рода: симметричность, нули,             28. Сингулярное разложение. Теорема о наилучшем приближении матри-
         экстремумы. Теоремы о композиции.                                                цы малоранговыми матрицами в норме, подчиненной евклидовой.
         8. Экстремальные свойства многочленов Чебышёва первого рода на отрез-            29. Решение задачи наименьших квадратов полного и неполного рангов ме-
         ке [a;b].                                                                        тодом сингулярного разложения.
         9. Экстремальные свойства многочленов Чебышёва первого рода вне (a;b).           30. Задача наименьших квадратов с линейными ограничениями–равенст-
   Решение дифференциальных уравнений.                                  вами: методы исключения, обобщенного сингулярного разложения, взве-
         10. Конечно-разностныйметод.Аппроксимация,устойчивость,сходимость,               шиванием
         теорема Филиппова.                                                               31. Задача наименьшихквадратовсограничениямитипаквадратныхнера-
         11. Метод неопределенных коэффициентов построения разностных схем.               венств: метод обобщенного сингулярного разложения.
                                                                                          k+1     k
         Погрешность формул численного дифференцирования, оценка для опти-                32. Метод простой итерации x     =Bx +cдлярешения систем линей-
         мального шага.                                                                   ных алгебраических уравнений.
         12. Задача Коши, условия аппроксимации p-го порядка на решении, α-ус-            33. Линейный оптимальный одношаговый метод и линейный оптималь-
         тойчивость. Модельные схемы.                                                     ный N-шаговый метод.
                                                             34. Метод наискорейшегоградиентногоспускаиметодминимальныхневя-
         13. Численные методы решения задачи Коши: метод Тейлора, методы                  зок.
         Адамса.                                                                          35. Итерационные методы с предобусловливателем
         14. Методы Рунге–Кутта для решения задачи Коши.                                  36. Методы Гаусса–Зейделя, Якоби и верхней релаксации
         15. Вычисление главного члена погрешности для простейших схем для за-            37. Проекционныйалгоритмрешениясистемлинейныхалгебраическихурав-
         дачи Коши. Оценка глобальной погрешности явного одношагового метода.             нений. Проекционная теорема, экстремальное свойство. Одномерные ал-
         16. Устойчивые и неустойчивые задачи. Жесткие системы.                           горитмы
         17. Метод Лебедева решения жестких систем.                                       38. Метод сопряженных градиентов.
         Раздел 6.                                                         165               166                   Лекция 27. Решение систем нелинейных уравнений
         39. Степенной метод со сдвигом для задач на собственные значения.                   65. Метод Ньютона в R1.
         40. Метод обратной итерации со сдвигом для задач на собственные зна-                66. Методы типапростойитерациидлярешениясистемнелинейныхурав-
         чения. Отношение Рэлея.                                                             нений. Методы установления.
         41. Инвариантныеподпространства.Методитерированияподпространств.                    67. Метод Ньютона в Rm.
         QR-алгоритм.                                                                        68. Интерполяционные методы построения итераций высшего порядка:
   Приближение функций одной переменной.                                   метод Чебышёва, δ2-процесс Эйткена, метод Стефенсона–Хаусхолдера–
         42. Интерполяционный многочлен Лагранжа. Минимизация остаточного                    Островского.
         члена погрешности.
         43. Наилучшее приближение в линейном нормированном и гильбертовом
         пространствах.
         44. Многочлен наилучшего равномерного приближения. Теорема Валле–
         Пуссена. Теорема Чебышёва.
         45. Примеры построения многочлена наилучшего равномерного приближе-
         ния. Теорема единственности.
         46. Сплайн–интерполяция. Линейный интерполяционный сплайн.
         47. Кубический интерполяционный сплайн.
         48. Локальный (аппроксимационный) сплайн.
         49. Приближение по многочленам Чебышёва.
         50. Дискретное преобразование Фурье. Свойства, примеры.
         51. Быстрое преобразование Фурье для N = n1n2, N = 2k (рекурсивная
         форма).
         52. Интерполяция Паде–Якоби. Многоточечная интерполяция Паде.
Численное интегрирование.
         53. Метод неопределенных коэффициентов построения квадратур
         54. Интерполяционные квадратуры.
         55. Составные квадратуры.
         56. Ортогональные многочлены.
         57. Квадратурные формулы Гаусса.
         58. Задачи оптимизации квадратур.
         59. Правило Рунге оценки погрешности. Построение программ с автома-
         тическим выбором шага.
         60. Метод Монте–Карло вычисления интегралов.
         61. Вычисление интегралов в нерегулярном случае.
        Решение нелинейных уравнений.
         62. Метод простой итерации: сжимающие и слабо сжимающие отобра-
         жения.
         63. Конструктивные теоремы о сходимости метода простой итерации и
         существовании корней уравнения.
         64. Метод хорд, метод секущих: расчетные формулы и теоремы сходимо-
         сти. Метод парабол.
Раздел 6.                                                                            167                    168                         Лекция 27. Решение систем нелинейных уравнений
        Список дополнительных задач.                                                      Задача 27.13. Построить квадратуру Гаусса с тремя узлами для вы-
                                                                                                                            R1    f(x)
                                                                                          числения интеграла I(f) = −1 √              2dx: Указать алгебраический порядок
Задача 27.1. Найти общее решение в действительной форме для следу-                                                                                  1−x
                       π                                                                  точности построенной квадратуры.
ющего уравнения: yk+2 +yk = cos 2k:                                                                         Задача 27.14.        Предложить способ вычисления интеграла R1 lnx dx по
Задача 27.2. Найти ограниченное фундаментальное решение уравнения                                                                                                                      0 1+x2
         0                                                                                составной квадратурной формуле с постоянным шагом h и погрешностью
yk+1 −yk −12yk−1 = δk:                                                                                          2
                                                                                          O h :
Задача 27.3. Найти все решения задачи на собственные значения                                               Задача 27.15.         Пусть A  матрица простой структуры, т.е. подоб-
yk+1 −2yk +yk−1 = −λyk;            1 ≤ k ≤ N −1;                                          на диагональной, и все λ(A) ∈ [m;M]; m > 0. Доказать, что метод
          2                                                                                 k+1      k
         h                                                                                x     −x           k                                  2
              2                                    1                                           τ       +Ax =bсходится при 0<τ < M.
          y0 = 0;     −h2(yN −yN−1)=−λyN; h= N :                                                     Задача 27.16. Пусть у задачи Ax = b с матрицей простой структуры
                 ′                                                                        имеется одно отрицательное собственное значение λ ∈ [−2:01;−1:99], а
Задача 27.4. Для задачи y +y = exp 2x; y(0) = 1 построить двухто-                                                                                                             1
                                                                                          остальные  положительны: λ ∈ [1;3], i = 2;:::;n. Построить сходя-
чечную разностную схему второго порядка сходимости.                                                                                                i
                     ′                                                                    щийся итерационный метод для решения такой системы.
Задача 27.5. Для уравнения y (x) = f(x) построить схему Адамса вто-                                                                                          α β 0 
рого порядка аппроксимации yk −yk−1 = c1fk−1 +c2fk−2 : Найти главный
                      h                  2                                                Задача 27.17. Для решения системы  β α β x=b применяется
член погрешности и исследовать устойчивость.                                                                                                                    0   β α
Задача 27.6. Для задачи −u′′ + p(x)u = f(x); u′(0) = 1; u(1) = 0; где                                       методГаусса–Зейделя. Найти все значения параметров α, β, для которых
p(x) ≥ 0, построить разностную схему второго порядка аппроксимации                                          метод сходится с произвольного начального приближения.
на сетке x = (i−1=2)h, i = 0;:::;N, h = 1=(N−1=2). Исследовать устой-                                       Задача 27.18. Уравнение x = 2x−1, имеющее два корня z1 = 1 и z2 = 2,
      i
чивость и сходимость.                                                                                       решают методом простой итерации x                     = 2xn−1. Исследовать сходи-
                                                                                                                                          n+1
                    ′′                      ′                                             мость метода в зависимости от выбора начального приближения x .
Задача 27.7. Для задачи −u + p(x)u = f(x); u (0) = 1; u(1) = 0; где                                                                                                                            0
                                                                                                                                           3            2
p(x) ≥ 0, построить разностную схему второго порядка аппроксимации                                          Задача 27.19. Для решения системы                   x3 − y          =4; применяет-
на сетке x = ih, i = 0;:::;N, h = 1=N. Исследовать устойчивость и                                                                                              xy     − y =14
       i
сходимость.                                                                                                 ся метод Ньютона. Указать ненулевую окрестность Qδ корня z = (2;2)
Задача 27.8. Функция f(x) = ex приближается на [−1;1] многочленом                                           и оценить число итераций n, необходимое для достижения точности
                                                                                          kz−x k ≤10−3 для произвольного x ∈Q .
Лагранжа по четырем равноотстоящим узлам. Найти наибольшее целое                                                   n 2                                   0      δ
p в оценке погрешности следующего вида: kf −Lnk                       ≤10−p.                                Задача 27.20. Для вычисления a1=p применяется следующий алгоритм:
                                            C[−1;1]                                                                                               p
Задача 27.9. Функция f(x) = cosx приближается многочленом Лагран-                                                              x      =ϕ(x ); ϕ(x) = x(p−1)x +(p+1)a:
                                                                                                               n+1        n                       p
жа на [−1;1] по n чебышёвским узлам. При каком значении n величина                                          Найти порядок сходимости метода.               (p +1)x +(p−1)a
погрешности приближения в непрерывной норме не превосходит 10−5.
                                         3       2
Задача 27.10. Среди всех многочленов вида a3x + 5x +a1x+a0 найти
наименее уклоняющийся от нуля на отрезке [1;2].
Задача 27.11. Построить многочлен наилучшего равномерного прибли-
                                         2           2
жения степени n = 3 для функции f(x) = 3sin 10x + |x − 7x + 10| на
отрезке [3;4].
Задача 27.12. Оценить число разбиений отрезка N для вычисления ин-
    R1       2
теграла 0 sin(x )dx по составной квадратурной формуле трапеций, обес-
печивающее точность 10−4.
      Учебное издание
 Корнев Андрей Алексеевич
      Лекции по курсу
    "Численные методы"
 Учебное пособие для вузов
      M., Издательство попечительского совета
механико-математического факультета МГУ, 167 стр.
 Подписано в печать 29.08.2011 г.
 Формат 60×90 1/16.  Объем 10,5 п.л.
 Заказ 5           Доп. тираж.
         Издательство попечительского совета механико-математического факуль-
         тета МГУ
         г. Москва, Ленинские горы.
         Отпечатанона типографскомоборудованиимеханико-математическогофа-
         культета
