\section{Метод неопределенных коэффициентов построения
  разностных схем. Погрешность формул
  численного дифференцирования, оценка для оптимального шага.}

\subsection*{Метод неопределенных коэффициентов построения разностных схем}
Дали задачу $Ly=f,\ L\equiv\frac{d^m}{dx^m}$. Надо перейти к разностной схеме
$L_hy_h=f_h$ в точках $\{x_i\}$, $f_h=(f)_{F_h}$.

Коэффициенты будем искать из условия аппроксимации на задаче
$|(Ly)_{F_h}-L_h(y)_{Y_h}|+\underset{=0}{|f_h-(f)_{F_h}|}\leq ch^p$ с желанием
получить наивысший $p$, то есть
\[\left|y^{(m)}(x_i)-\frac{1}{h^m}\sum_{i=0}^{N}y(x_i)\right|\leq ch^p\]
Представим $x_i=x_k+\alpha_ih$ и разложим каждое $y(x_i)$
в ряд Тейлора в узле сетки $x_k$ в виде $y(x_k+\alpha_ih)=y(x_k)+y'(x_k)\alpha_ih+\ldots+\bigO(h^{p+m})$.
Подставив данные разложения в условия аппроксимации получим систему линейных уравнений на $c_i$.

\begin{example}
  Найти коэффициенты разностного оператора при наибольшем $p$
  \[y'(x_k)=\frac{1}{h}(c_1y(x_k-h)+c_2y(x_k)+c_3y(x_k+h))+\bigO(h^p)\]
  Разложим в ряд Тейлора с остаточным членом в форме Лагранжа в точке $x_k$:
  \[y(x_k\pm h)=y(x_k)\pm y'(x_k)h+y''(x_k)\frac{h^2}{2}\pm y'''(\xi_{\pm})\frac{h^3}{6}\]
  Подставим в исходное уравнение и сопоставим коэффициенты при соответствующих слагаемых слева и справа
  \[\begin{cases}
      y(x_k):    & c_1+c_2+c_3=0     \\
      y'(x_k):   & c_3-c_1=1         \\
      y''(x_k):  & c_1+c_3=0         \\
      y'''(x_k): & c_3-c_1=0\ \times
    \end{cases}\Rightarrow (\star)\]
  Обращаем внимание, что последнее уравнение противоречит второму, то есть
  мы сможем наиграть с помощью коэффициентов только второй порядок.
  \[(\star)\Rightarrow\begin{cases}
      c_1=-\frac{1}{2} \\
      c_2=0            \\
      c_3=\frac{1}{2}
    \end{cases}\]
  Итоговая разностная схема с порядком аппроксимации $p=2$ имеет вид
  \[L_hy_h=\frac{y_{k+1}-y_{k-1}}{2h}\]

  Получим оценку для константы:
  \[\left|\frac{1}{h}(c_3y'''(\xi_{+})\frac{h^3}{6}-c_1y'''(\xi_{-})\frac{h^3}{6})\right|=\frac{h^2}{12}\left|y'''(\xi_{+})+y'''(\xi_{-})\right|\leq ch^2\Rightarrow c\geq\frac{|y'''(\xi_{+})+y'''(\xi_{-})|}{12}\]
\end{example}

Отсюда в том числе следует, что найденная схема точна для произвольного
многочлена второй степени. Таким образом, систему уравнений на
коэффициенты можно найти из условия точности формулы разностного
дифференцирования для многочленов наиболее высокой степени. Для этого
подставляем последовательно $y(x)=1,x,x^2,\ldots$ в разностную формулу
и приравниваем к точному значению производной $y^{(m)}(x)$.
Решение полученной линейной системы определяет те же коэффициенты схемы.
\begin{example}
  Найти коэффициенты разностного оператора при наибольшем $p$
  \[y'(x_k)=\frac{1}{h}(c_1y(x_k-h)+c_2y(x_k)+c_3y(x_k+h))+\bigO(h^p)\]
  \[\begin{cases}
      1:   & c_1+c_2+c_3=0                                \\
      x:   & c_1(x_k-h)+c_2(x_k)+c_3(x_k+h)=h             \\
      x^2: & c_1(x_k-h)^2+c_2(x_k)^2 + c_3(x_k+h)^2=2x_kh \\
      x^3: & c_3-c_1=0\ \times
    \end{cases}\Rightarrow (\star)\]
  Решая данную систему должны получить те же самые коэффициенты.
\end{example}

\subsection*{Погрешность формул
  численного дифференцирования, оценка для оптимального шага.}

Решаем задачу $y^{(m)}=f(x)$.
Взяли в качестве аппроксимации следующее выражение
\[y^{(m)}(x_k)=\underbrace{\frac{1}{h^m}\sum_{i=0}^Nc_iy(x_k+\alpha_ih)}_{D}+\underbrace{ch^p}_{E_1(h)}\]
Вносим значения в компьютер, в котором имеем погрешность $\varepsilon_i$: $y(x_k)\rightarrow y(x_k)+\varepsilon_i$.

Получаем следующую величину:
\[y^{(m)}(x_k)=\frac{1}{h^m}\sum_{i=0}^Nc_i(y(x_k+\alpha_ih)+\varepsilon_i)+E_1=D+\underbrace{\frac{1}{h^m}\sum_{i=0}^Nc_i\varepsilon_i}_{E_2(h)}+E_1(h)\]
Таким образом итоговая погрешность на компьютере равна $E_2+E_1$. Так как $\varepsilon_i$ - машинная точность - по своей сути случайна,
то точно оценить мы не можем, сделаем это грубо
\[|E_1(h)+E_2(h)|\leq\frac{\max_{i}|\varepsilon_i|}{h^m}\sum_{i=0}^{N}|c_i|+ch^p\leq\frac{A\varepsilon}{h^m}+ch^p=:E(h),\ \varepsilon=\max_{i}|\varepsilon_i|,\ \sum_{i=0}^{N}|c_i|\leq A\]
Обратим внимание, что при достаточно больших $h$ второе слагаемое будет вносить большой вклад в погрешность,
а при малых $h$ - первое. Хотим найти оптимальное значение $h_0$:
\[E'(h_0)=0=\frac{-mA\varepsilon}{h_0^{m+1}}+cph_0^{p-1}\Leftrightarrow\frac{mA\varepsilon}{h_0^{m+1}}=cph^{p-1}\Rightarrow h_0=\left(\frac{mA\varepsilon}{cp}\right)^{\frac{1}{p+m}}\sim\varepsilon^{\frac{1}{p+m}}\]
\[E(h_0)\sim \varepsilon^{1-\frac{m}{p+m}}+\varepsilon^{\frac{p}{p+m}}\sim\varepsilon^{\frac{p}{p+m}}\]
\begin{example}
  Известно, что
  \[y''(x_k)=\frac{y(x_k+h)-2y(x_k)+y(x_k-h)}{h^2}+ch^2\]
  Пусть погрешность вычислений $\epsilon$ не превышает $10^{-4}$.
  В наших терминах $p=2$, $m=2$. Оптимальный шаг $h_0=(10^{-4})^{1/4}=10^{-1}$ будет влечь погрешность $E=10^{-2}$.
\end{example}
